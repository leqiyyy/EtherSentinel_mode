<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>控制台 - EtherSentinel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --dark-bg: #0a0e1a;
            --card-bg: rgba(16, 20, 31, 0.8);
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --neon-cyan: #00ffcc;
            --neon-blue: #00d4ff;
            --neon-orange: #ff6b35;
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --danger-red: #ff004d;
            --shadow-glow: 0 8px 32px rgba(0, 255, 204, 0.1);
            --blockchain-green: #39ff14;
            --safe-green: #00d4aa;
            --safe-green-light: #4dd0e1;
            --cyber-purple: #8a2be2;
            --matrix-green: #00ff41;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            overflow-x: hidden;
            position: relative;
            font-weight: 400;
            line-height: 1.6;
            letter-spacing: 0.5px;
        }

        /* 优化字体排版 */
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            line-height: 1.3;
            letter-spacing: 1px;
            margin-bottom: 1rem;
        }

        p, span, div {
            font-family: 'Rajdhani', sans-serif;
            font-weight: 400;
            line-height: 1.7;
            letter-spacing: 0.3px;
        }

        .text-enhanced {
            font-weight: 500;
            letter-spacing: 0.8px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .subtitle-enhanced {
            font-family: 'Rajdhani', sans-serif;
            font-weight: 500;
            font-size: 1.1rem;
            line-height: 1.6;
            letter-spacing: 0.5px;
            opacity: 0.9;
        }

        .content-text {
            font-size: 1.05rem;
            line-height: 1.8;
            letter-spacing: 0.4px;
            font-weight: 400;
        }

        /* 增强的区块链科技背景 */
        .cyber-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -5;
            background: 
                radial-gradient(circle at 20% 50%, rgba(0, 255, 204, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0, 212, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(138, 43, 226, 0.08) 0%, transparent 50%),
                linear-gradient(125deg, #0a0e1a 0%, #1a1f35 50%, #0a0e1a 100%);
        }

        /* 风险节点样式 */
        .address-node.risk-node circle {
            fill: var(--danger-red) !important;
            stroke: #fff !important;
            stroke-width: 3 !important;
            filter: drop-shadow(0 0 8px rgba(255, 0, 77, 0.6));
        }

        .address-node.risk-node text {
            fill: white !important;
            font-weight: bold;
        }

        /* 图形控制按钮样式 */
        .graph-controls button {
            transition: all 0.3s ease;
            font-size: 0.8rem;
            min-width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .graph-controls button:hover {
            background: rgba(0, 255, 204, 0.4) !important;
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(0, 255, 204, 0.3);
        }

        /* SVG变换优化 */
        #address-graph-edges, #address-graph-nodes {
            transform-origin: center center;
            transition: transform 0.2s ease;
        }

        /* 动态网格背景 */
        .grid-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(0, 255, 204, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 204, 0.1) 1px, transparent 1px),
                linear-gradient(rgba(0, 255, 204, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 204, 0.05) 1px, transparent 1px);
            background-size: 100px 100px, 100px 100px, 20px 20px, 20px 20px;
            z-index: -4;
            opacity: 0.4;
            animation: gridMove 20s linear infinite;
        }

        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(100px, 100px); }
        }

        /* 粒子效果背景 */
        .particles-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -3;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            background: var(--neon-cyan);
            border-radius: 50%;
            pointer-events: none;
            opacity: 0.6;
            animation: float 15s linear infinite;
        }

        .particle:nth-child(odd) {
            background: var(--neon-blue);
            animation-duration: 20s;
        }

        .particle:nth-child(3n) {
            background: var(--blockchain-green);
            animation-duration: 25s;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 0.6;
            }
            90% {
                opacity: 0.6;
            }
            100% {
                transform: translateY(-100px) scale(1);
                opacity: 0;
            }
        }

        /* 区块链数据流 */
        .blockchain-streams {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            opacity: 0.1;
        }

        .data-stream {
            position: absolute;
            width: 2px;
            height: 100px;
            background: linear-gradient(to bottom, 
                transparent, 
                var(--matrix-green), 
                transparent);
            animation: dataFlow 8s linear infinite;
        }

        @keyframes dataFlow {
            0% {
                transform: translateY(-100px);
                opacity: 0;
            }
            10%, 90% {
                opacity: 1;
            }
            100% {
                transform: translateY(100vh);
                opacity: 0;
            }
        }

        /* 统一导航栏样式（引入组件） */
        .main-content {
            margin-top: 80px;
            padding: 1.5rem 0;
            position: relative;
            z-index: 1;
        }

        /* 页面标题区域 */
        .page-header {
            background: linear-gradient(135deg, 
                rgba(0, 255, 204, 0.1) 0%, 
                rgba(0, 212, 255, 0.05) 50%,
                rgba(138, 43, 226, 0.1) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 255, 204, 0.2);
            border-radius: 20px;
            padding: 2rem 1.5rem;
            margin-bottom: 2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 8px 32px rgba(0, 255, 204, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .page-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, 
                transparent, 
                rgba(0, 255, 204, 0.1), 
                transparent);
            animation: rotate 20s linear infinite;
            z-index: -1;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .page-title {
            font-family: 'Orbitron', monospace;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--neon-cyan);
            margin-bottom: 0.8rem;
            position: relative;
            z-index: 1;
        }

        .page-subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
            position: relative;
            z-index: 1;
            font-family: 'Rajdhani', sans-serif;
            font-weight: 500;
            line-height: 1.4;
            letter-spacing: 0.8px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        /* 系统状态指示器 */
        .system-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .status-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(0, 255, 204, 0.2);
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .status-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, 
                var(--neon-cyan), 
                var(--neon-blue), 
                var(--blockchain-green));
            border-radius: 15px 15px 0 0;
        }

        .status-card:hover {
            transform: translateY(-5px);
            border-color: var(--neon-cyan);
            box-shadow: 0 10px 30px rgba(0, 255, 204, 0.2);
        }

        .status-value {
            font-family: 'Orbitron', monospace;
            font-size: 2rem;
            font-weight: 700;
            color: var(--neon-cyan);
            margin-bottom: 0.5rem;
        }

        .status-label {
            color: var(--text-secondary);
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            font-weight: 500;
            font-family: 'Rajdhani', sans-serif;
        }

        /* 主内容区域布局 */
        .main-content-wrapper {
            display: flex;
            gap: 2rem;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1rem;
            min-height: calc(100vh - 120px);
        }

        /* 左侧功能导航栏 */
        .sidebar-nav {
            width: 280px;
            min-width: 280px;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.08) 0%, 
                rgba(255, 255, 255, 0.03) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 255, 204, 0.2);
            border-radius: 20px;
            padding: 1.5rem;
            height: fit-content;
            position: sticky;
            top: 100px;
            box-shadow: 
                0 6px 24px rgba(0, 255, 204, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .sidebar-nav::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, 
                var(--neon-cyan), 
                var(--neon-blue), 
                var(--blockchain-green));
            border-radius: 25px 25px 0 0;
        }

        .sidebar-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--neon-cyan);
            margin-bottom: 1.5rem;
            text-align: center;
            text-shadow: 0 0 10px rgba(0, 255, 204, 0.3);
        }

        /* 功能导航按钮列表 */
        .function-nav-list {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .function-nav-item {
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.05) 0%, 
                rgba(255, 255, 255, 0.02) 100%);
            border: 1px solid rgba(0, 255, 204, 0.15);
            border-radius: 10px;
            padding: 1rem;
            text-decoration: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: block;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            backdrop-filter: blur(15px);
            color: var(--text-primary);
        }

        .function-nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(0, 255, 204, 0.1) 0%, 
                rgba(0, 212, 255, 0.05) 50%,
                rgba(138, 43, 226, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1;
        }

        .function-nav-item:hover::before {
            opacity: 1;
        }

        .function-nav-item:hover {
            transform: translateX(5px);
            border-color: var(--neon-cyan);
            box-shadow: 
                0 8px 25px rgba(0, 255, 204, 0.2),
                0 0 20px rgba(0, 255, 204, 0.1);
        }

        .function-nav-item.active {
            background: linear-gradient(135deg, 
                rgba(0, 255, 204, 0.15) 0%, 
                rgba(0, 212, 255, 0.1) 100%);
            border-color: var(--neon-cyan);
            box-shadow: 
                0 8px 25px rgba(0, 255, 204, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .nav-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.3rem;
            transition: all 0.3s ease;
            font-family: 'Orbitron', monospace;
            position: relative;
            z-index: 2;
        }

        .function-nav-item:hover .nav-title,
        .function-nav-item.active .nav-title {
            color: var(--neon-cyan);
            text-shadow: 0 0 8px rgba(0, 255, 204, 0.5);
        }

        .nav-description {
            font-size: 0.85rem;
            color: var(--text-secondary);
            opacity: 0.8;
            line-height: 1.2;
            transition: all 0.3s ease;
            position: relative;
            z-index: 2;
        }

        .function-nav-item:hover .nav-description,
        .function-nav-item.active .nav-description {
            color: rgba(0, 255, 204, 0.8);
            opacity: 1;
        }

        /* 右侧主内容区域 */
        .main-content-area {
            flex: 1;
            min-width: 0;
        }



        /* 内容卡片区域 */
        .content-section {
            display: none;
            animation: fadeInUp 0.6s ease-out;
            width: 100%;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 内容卡片 */
        .content-card {
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.08) 0%, 
                rgba(255, 255, 255, 0.03) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 255, 204, 0.2);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 6px 24px rgba(0, 255, 204, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .content-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, 
                var(--neon-cyan), 
                var(--neon-blue), 
                var(--blockchain-green),
                var(--cyber-purple));
            border-radius: 25px 25px 0 0;
        }

        .content-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.6rem;
            color: var(--neon-cyan);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            text-shadow: 0 0 15px rgba(0, 255, 204, 0.3);
        }

        .content-title i {
            font-size: 1.8rem;
            background: linear-gradient(45deg, 
                var(--neon-cyan), 
                var(--neon-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .content-description {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            line-height: 1.5;
            font-size: 1rem;
        }

        /* 增强的表单样式 */
        .form-group {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .form-label {
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 0.6rem;
            display: block;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .input-container {
            position: relative;
        }

        /* 输入框和选择器样式优化 */
        .form-control, .form-select {
            background: rgba(0, 20, 40, 0.8);
            border: 2px solid rgba(0, 255, 204, 0.3);
            color: var(--text-primary);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .form-control:focus, .form-select:focus {
            background: rgba(0, 20, 40, 0.9);
            border-color: var(--neon-cyan);
            box-shadow: 
                0 0 0 0.2rem rgba(0, 255, 204, 0.25),
                0 0 20px rgba(0, 255, 204, 0.3);
            color: var(--text-primary);
            outline: none;
        }

        .form-control::placeholder {
            color: rgba(255, 255, 255, 0.5);
            opacity: 1;
        }

        .form-select option {
            background: var(--dark-bg);
            color: var(--text-primary);
            padding: 0.5rem;
        }

        .form-select option:hover,
        .form-select option:focus,
        .form-select option:selected {
            background: rgba(0, 255, 204, 0.2);
            color: var(--neon-cyan);
        }

        /* 输入容器样式 */
        .input-container {
            display: flex;
            gap: 0.8rem;
            align-items: center;
        }

        .input-container .form-control {
            flex: 1;
        }

        /* 统一的区块链网络选择框样式 */
        .blockchain-network-select {
            min-width: 130px;
            max-width: 130px;
            flex-shrink: 0;
            font-weight: 500;
            text-align: center;
            background: rgba(0, 20, 40, 0.9);
            border: 2px solid rgba(0, 255, 204, 0.4);
            color: var(--neon-cyan);
            border-radius: 8px;
            padding: 0.75rem 0.5rem;
            font-size: 0.95rem;
            font-family: 'Orbitron', monospace;
        }

        .blockchain-network-select:focus {
            background: rgba(0, 20, 40, 1);
            border-color: var(--neon-cyan);
            box-shadow: 
                0 0 0 0.2rem rgba(0, 255, 204, 0.25),
                0 0 20px rgba(0, 255, 204, 0.4);
            color: var(--neon-cyan);
        }

        .blockchain-network-select option {
            background: var(--dark-bg);
            color: var(--neon-cyan);
            padding: 0.5rem;
            font-weight: 500;
        }

        .blockchain-network-select option:hover,
        .blockchain-network-select option:focus,
        .blockchain-network-select option:selected {
            background: rgba(0, 255, 204, 0.2);
            color: var(--neon-cyan);
        }

        /* 增强的按钮样式 */
        .btn-primary {
            background: linear-gradient(45deg, 
                var(--neon-cyan), 
                var(--neon-blue));
            border: none;
            color: #000;
            font-weight: 700;
            padding: 1rem 2.5rem;
            border-radius: 50px;
            transition: all 0.3s ease;
            cursor: pointer;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 255, 204, 0.3);
            margin-top: 0.5rem;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent);
            transition: left 0.5s ease;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 255, 204, 0.4);
            color: #000;
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* 结果展示卡片 - 确保与内容卡片对齐 */
        .result-card {
            background: linear-gradient(135deg, 
                rgba(0, 255, 204, 0.05) 0%, 
                rgba(0, 212, 255, 0.03) 100%);
            border: 1px solid rgba(0, 255, 204, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            backdrop-filter: blur(15px);
            position: relative;
            overflow: hidden;
        }

        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, 
                var(--neon-cyan), 
                var(--neon-blue));
            border-radius: 20px 20px 0 0;
        }

        .risk-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .risk-item:hover {
            border-color: rgba(0, 255, 204, 0.3);
            box-shadow: 0 5px 15px rgba(0, 255, 204, 0.1);
        }

        .risk-level {
            font-weight: 600;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .risk-level.high {
            background: rgba(255, 0, 77, 0.2);
            color: var(--danger-red);
            border: 1px solid var(--danger-red);
        }

        .risk-level.medium {
            background: rgba(255, 107, 53, 0.2);
            color: var(--neon-orange);
            border: 1px solid var(--neon-orange);
        }

        .risk-level.low {
            background: rgba(0, 255, 204, 0.2);
            color: var(--neon-cyan);
            border: 1px solid var(--neon-cyan);
        }

        /* 响应式优化 */
        @media (max-width: 992px) {
            .main-content-wrapper {
                flex-direction: column;
                gap: 1.5rem;
            }
            
            .sidebar-nav {
            width: 100%;
                position: static;
                order: -1;
            }
            
            .function-nav-list {
                flex-direction: row;
                overflow-x: auto;
                gap: 1rem;
                padding-bottom: 0.5rem;
            }
            
            .function-nav-item {
                min-width: 180px;
                flex-shrink: 0;
            }
        }

        @media (max-width: 768px) {
            .system-status {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.8rem;
            }

            .page-title {
                font-size: 1.8rem;
            }

            .content-card {
                padding: 1.5rem 1rem;
            }
            
            .main-content-wrapper {
                padding: 0 0.5rem;
            }
        }

        @media (max-width: 576px) {
            .system-status {
                grid-template-columns: 1fr;
            }

            .page-header {
                padding: 1.5rem 1rem;
            }

            .main-content {
                padding: 1rem 0.5rem;
            }
            
            .function-nav-list {
                flex-direction: column;
            }
            
            .function-nav-item {
                min-width: auto;
            }
        }

        /* 加载动画 */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 255, 204, 0.3);
            border-radius: 50%;
            border-top-color: var(--neon-cyan);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* 网络图样式 */
        .graph-container {
            border: 1px solid rgba(0, 255, 204, 0.2);
            box-shadow: 0 4px 15px rgba(0, 255, 204, 0.1);
            transition: all 0.3s ease;
        }

        .graph-container:hover {
            border-color: rgba(0, 255, 204, 0.4);
            box-shadow: 0 6px 20px rgba(0, 255, 204, 0.2);
        }

        /* SVG 边线样式 */
        .graph-edge, .address-edge {
            transition: all 0.3s ease;
        }

        .graph-node circle, .address-node circle {
            transition: all 0.3s ease;
        }

        .graph-node:hover circle, .address-node:hover circle {
            filter: drop-shadow(0 0 8px rgba(52, 152, 219, 0.8));
            transform: scale(1.05);
        }

        /* 时间戳样式 */
        .timestamp {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-family: 'Orbitron', monospace;
            margin-top: 1rem;
            padding: 0.5rem 1rem;
            background: rgba(0, 255, 204, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(0, 255, 204, 0.1);
        }

        /* 交易甄别页面特殊样式 */
        .transaction-content {
            margin-bottom: 1rem;
        }

        .transaction-details-row {
            margin-bottom: 1rem;
        }

        .transaction-risk-section {
            margin-top: 1rem;
        }

        /* 风险节点样式 */
        .risk-node circle {
            fill: #ff004d !important;
            stroke: #ffffff !important;
            filter: drop-shadow(0 0 8px rgba(255, 0, 77, 0.6)) !important;
        }

        .risk-node text {
            fill: #ffffff !important;
            font-weight: bold !important;
        }

        /* 数据表格容器优化 */
        .data-table-container {
            max-width: 100%;
            overflow-x: auto;
        }

        /* 严格对齐的行布局 */
        .row.align-items-stretch > .col-md-6,
        .row.align-items-stretch > .col-md-12 {
            display: flex;
            flex-direction: column;
        }

        .row.align-items-stretch .graph-container,
        .row.align-items-stretch > div > div {
            flex: 1;
            height: 100%;
        }

        /* 确保内容区域高度一致 */
        .equal-height {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .equal-height > div {
            flex: 1;
        }

        /* 交易详细信息网格对齐 */
        .transaction-details-section .row {
            margin: 0;
        }

        .transaction-details-section .col-md-6 {
            padding: 0.5rem;
        }

        /* 地址信息对齐 */
        .address-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            align-items: start;
        }

        /* 实时数据表格对齐 */
        .data-table-responsive {
            border-radius: 10px;
            overflow: hidden;
        }

        .data-table-responsive table {
            margin-bottom: 0;
        }

        .data-table-responsive thead th {
            background: rgba(0, 255, 204, 0.1);
            border-bottom: 2px solid rgba(0, 255, 204, 0.3);
            font-weight: 600;
            text-align: center;
            vertical-align: middle;
        }

        .data-table-responsive tbody td {
            vertical-align: middle;
            text-align: center;
        }

        /* 风险项列表对齐 */
        .risk-items-list {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            height: 100%;
        }

        .risk-item-row {
            display: flex;
            align-items: flex-start;
            gap: 0.8rem;
            padding: 0.8rem;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        .risk-icon-container {
            flex-shrink: 0;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .risk-content {
            flex: 1;
            min-width: 0;
        }

        .risk-title {
            font-weight: 500;
            margin-bottom: 0.2rem;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .risk-description {
            font-size: 0.85rem;
            opacity: 0.8;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        /* 交易甄别模块风险分析结果优化 */
        #txResult .col-md-6 {
            height: 100%;
        }

        #txResult .transaction-content .row {
            height: auto;
        }

        #txResult .transaction-content .col-md-6 {
            display: flex;
            flex-direction: column;
        }

        #txResult .col-md-6 > h5 {
            background: linear-gradient(90deg, rgba(0, 255, 204, 0.1) 0%, rgba(0, 150, 150, 0.1) 100%);
            margin: 0 0 0.8rem 0 !important;
            padding: 0.8rem 1.2rem;
            border-radius: 12px 12px 0 0;
            border: 1px solid rgba(0, 255, 204, 0.2);
            border-bottom: none;
            font-weight: 600;
            font-family: 'Orbitron', monospace;
            position: relative;
        }

        #txResult .col-md-6 > h5::before {
            content: '';
            position: absolute;
            left: 1.2rem;
            bottom: -1px;
            width: 40px;
            height: 2px;
            background: var(--neon-cyan);
            border-radius: 2px;
        }

        #txResult #txRisks {
            display: flex;
            flex-direction: column;
            background: linear-gradient(135deg, rgba(0, 30, 60, 0.3) 0%, rgba(0, 50, 100, 0.2) 100%) !important;
            border: 1px solid rgba(0, 255, 204, 0.2) !important;
            border-radius: 12px !important;
            backdrop-filter: blur(10px);
            height: 480px;
            padding: 1.2rem;
            overflow: hidden;
        }

        #txResult #txRisks .risk-content-wrapper {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
        }

        #txResult #txRisks .risk-content-wrapper::-webkit-scrollbar {
            width: 4px;
        }

        #txResult #txRisks .risk-content-wrapper::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 2px;
        }

        #txResult #txRisks .risk-content-wrapper::-webkit-scrollbar-thumb {
            background: rgba(100, 150, 200, 0.3);
            border-radius: 2px;
        }

        #txResult #txRisks .risk-content-wrapper::-webkit-scrollbar-thumb:hover {
            background: rgba(100, 150, 200, 0.5);
        }

        /* 确保图表容器高度适配 */
        #txResult .graph-container {
            display: flex;
            flex-direction: column;
            height: 320px;
            background: linear-gradient(135deg, rgba(0, 30, 60, 0.3) 0%, rgba(0, 50, 100, 0.2) 100%);
            padding: 1.2rem;
            border-radius: 12px;
            border: 1px solid rgba(0, 255, 204, 0.2);
            backdrop-filter: blur(10px);
        }

        #txResult .graph-container h6 {
            background: linear-gradient(90deg, rgba(100, 150, 200, 0.1) 0%, rgba(80, 120, 180, 0.1) 100%);
            margin: -1.2rem -1.2rem 0.8rem -1.2rem !important;
            padding: 0.8rem 1.2rem;
            border-radius: 12px 12px 0 0;
            border-bottom: 1px solid rgba(100, 150, 200, 0.25);
            font-weight: 600;
            font-family: 'Orbitron', monospace;
            position: relative;
        }

        #txResult .graph-container h6::before {
            content: '';
            position: absolute;
            left: 1.2rem;
            bottom: -1px;
            width: 40px;
            height: 2px;
            background: #94a3b8;
            border-radius: 2px;
        }

        /* 确保交易甄别模块左右高度严格一致 */
        #txResult .transaction-content .row.align-items-stretch {
            align-items: stretch !important;
        }

        #txResult .transaction-content .col-md-6 {
            display: flex;
                flex-direction: column;
            }
            
        #txResult .col-md-6:nth-child(2) h6 {
            flex-shrink: 0;
            height: auto;
            margin-bottom: 0.8rem;
            background: linear-gradient(90deg, rgba(100, 150, 200, 0.1) 0%, rgba(80, 120, 180, 0.1) 100%);
            margin: -1.2rem -1.2rem 0.8rem -1.2rem !important;
            padding: 0.8rem 1.2rem;
            border-radius: 12px 12px 0 0;
            border-bottom: 1px solid rgba(100, 150, 200, 0.25);
            font-weight: 600;
            font-family: 'Orbitron', monospace;
            position: relative;
        }

        #txResult .col-md-6:nth-child(2) h6::before {
            content: '';
            position: absolute;
            left: 1.2rem;
            bottom: -1px;
            width: 40px;
            height: 2px;
            background: #94a3b8;
            border-radius: 2px;
        }

        /* 交易详细信息宽度一致 */
        #txResult .transaction-details-section {
            margin-top: 2rem;
            width: 100%;
        }

        /* 新风险分析界面样式 */
        #txResult .risk-overview-panel {
            background: linear-gradient(135deg, rgba(30, 60, 90, 0.2) 0%, rgba(20, 40, 70, 0.15) 100%);
            border: 1px solid rgba(100, 150, 200, 0.25);
            border-radius: 10px;
                padding: 1rem;
            margin-bottom: 0.8rem;
            backdrop-filter: blur(8px);
        }

        #txResult .risk-score-display {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        #txResult .score-circle {
            position: relative;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, #22c55e 0deg, #22c55e 306deg, rgba(255, 255, 255, 0.08) 306deg, rgba(255, 255, 255, 0.08) 360deg);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 15px rgba(34, 197, 94, 0.15);
        }

        #txResult .score-circle::before {
            content: '';
            position: absolute;
            width: 52px;
            height: 52px;
            border-radius: 50%;
            background: rgba(15, 23, 42, 0.95);
            border: 1px solid rgba(100, 150, 200, 0.15);
            backdrop-filter: blur(8px);
        }

        #txResult .score-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #ffffff;
            font-family: 'Orbitron', monospace;
            z-index: 2;
            line-height: 1;
            text-shadow: 0 0 8px rgba(34, 197, 94, 0.6), 0 2px 4px rgba(0, 0, 0, 0.8);
        }

        #txResult .score-label {
            font-size: 0.55rem;
            color: #ffffff;
            font-family: 'Orbitron', monospace;
            z-index: 2;
            margin-top: -1px;
            text-shadow: 0 0 6px rgba(148, 163, 184, 0.8), 0 1px 2px rgba(0, 0, 0, 0.8);
            opacity: 0.9;
        }

        #txResult .score-description {
            flex: 1;
        }

        #txResult .score-status {
            font-size: 1rem;
            font-weight: 600;
            color: #22c55e;
            margin-bottom: 0.2rem;
            font-family: 'Orbitron', monospace;
        }

        #txResult .score-subtitle {
            font-size: 0.75rem;
            color: #94a3b8;
            opacity: 0.9;
        }

        #txResult .risk-details-section {
            margin-bottom: 1rem;
        }

        #txResult .section-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #94a3b8;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 0.8rem;
            font-family: 'Orbitron', monospace;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        #txResult .risk-item-grid {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
        }

        #txResult .risk-check-item {
            display: flex;
            align-items: flex-start;
            gap: 0.7rem;
            padding: 0.7rem;
            background: rgba(255, 255, 255, 0.015);
            border: 1px solid rgba(255, 255, 255, 0.03);
            border-radius: 6px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        #txResult .risk-check-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #22c55e;
            opacity: 0.5;
        }

        #txResult .risk-check-item.danger::before {
            background: #ef4444;
            opacity: 0.7;
        }

        #txResult .risk-check-item:hover {
            background: rgba(255, 255, 255, 0.025);
            border-color: rgba(100, 150, 200, 0.15);
            transform: translateX(1px);
        }

        #txResult .risk-icon-container {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid rgba(255, 255, 255, 0.2);
            flex-shrink: 0;
            margin-top: 2px;
        }

        #txResult .risk-icon {
            font-size: 0.7rem;
        }

        #txResult .risk-icon.safe {
            color: #22c55e;
        }

        #txResult .risk-icon.danger {
            color: #ef4444;
        }

        #txResult .risk-content {
            flex: 1;
            min-width: 0;
        }

        #txResult .risk-title {
            font-size: 0.8rem;
            font-weight: 600;
            color: #e2e8f0;
            margin-bottom: 0.15rem;
            line-height: 1.3;
        }

        #txResult .risk-status {
            font-size: 0.7rem;
            color: #22c55e;
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        #txResult .risk-check-item.danger .risk-status {
            color: #ef4444;
        }

        #txResult .risk-description {
            font-size: 0.65rem;
            color: #94a3b8;
            opacity: 0.85;
            line-height: 1.4;
        }

        #txResult .risk-recommendation {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(37, 99, 235, 0.08) 100%);
            border: 1px solid rgba(59, 130, 246, 0.15);
            border-radius: 6px;
            padding: 0.8rem;
            height: 140px;
            display: flex;
            flex-direction: column;
        }

        #txResult .recommendation-header {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            color: #60a5fa;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 0.4rem;
            font-family: 'Orbitron', monospace;
        }

        #txResult .recommendation-content {
            font-size: 0.75rem;
            line-height: 1.6;
            color: #94a3b8;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        #txResult .recommendation-content p {
            margin: 0 0 0.4rem 0;
        }

        #txResult .recommendation-content p:last-child {
            margin-bottom: 0;
        }

        /* 危险状态样式 */
        #txResult .score-circle.danger {
            background: conic-gradient(from 0deg, #ef4444 0deg, #ef4444 180deg, rgba(255, 255, 255, 0.08) 180deg, rgba(255, 255, 255, 0.08) 360deg);
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.2);
        }

        #txResult .score-circle.danger .score-value {
            color: #ef4444;
        }

        #txResult .score-status.danger {
            color: #ef4444;
        }

        /* 响应式调整 */
        @media (max-width: 768px) {
            #txResult .transaction-content .col-md-6 {
                margin-bottom: 2rem;
            }

            #txResult #txRisks,
            #txResult .graph-container {
                min-height: auto;
                height: auto;
            }

            #txResult .risk-score-display {
                flex-direction: column;
                text-align: center;
                gap: 0.8rem;
            }

            #txResult .score-description {
                text-align: center;
            }
        }

        /* 风险项容器样式 */
        .risk-item-container {
            transition: all 0.3s ease;
        }

        .risk-item-container:hover {
            background: rgba(255, 0, 77, 0.08) !important;
            border-color: rgba(255, 0, 77, 0.25) !important;
            transform: translateX(2px);
        }

        .risk-expand-btn:hover {
            opacity: 1 !important;
            transform: scale(1.1);
        }

        .risk-details {
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
    </style>
</head>
<body>
    <!-- 增强的背景系统 -->
    <div class="cyber-background"></div>
    <div class="grid-overlay"></div>
    <div class="particles-bg" id="particlesBg"></div>
    <div class="blockchain-streams" id="blockchainStreams"></div>

    <!-- 引入统一导航栏 -->
    <div id="navbar-placeholder"></div>

    <!-- 主要内容 -->
    <div class="main-content">
        <div class="container">
            <!-- 页面标题 -->
            <div class="page-header">
                <h1 class="page-title">
                    <i class="bi bi-speedometer2"></i>
                    安全控制台
                </h1>
                                    <p class="page-subtitle subtitle-enhanced">区块链安全监控与威胁检测中心</p>
                
                <!-- 系统状态 -->
                <div class="system-status">
                    <div class="status-card">
                        <div class="status-value" id="totalScans">0</div>
                        <div class="status-label">总扫描次数</div>
                        <div class="status-trend" style="font-size: 0.7rem; color: var(--blockchain-green); margin-top: 0.3rem;">
                            <i class="bi bi-arrow-up"></i> <span id="scansTrend">+0%</span>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-value" id="threatsBlocked">0</div>
                        <div class="status-label">已阻止威胁</div>
                        <div class="status-trend" style="font-size: 0.7rem; color: #f59e0b; margin-top: 0.3rem;">
                            <i class="bi bi-shield-check"></i> <span id="threatsTrend">+0%</span>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-value" id="activeMonitors">0</div>
                        <div class="status-label">活跃监控</div>
                        <div class="status-trend" style="font-size: 0.7rem; color: var(--neon-cyan); margin-top: 0.3rem;">
                            <i class="bi bi-check-circle"></i> <span id="monitorStatus">稳定运行</span>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-value" id="systemUptime">0%</div>
                        <div class="status-label">系统运行时间</div>
                        <div class="status-trend" style="font-size: 0.7rem; color: var(--blockchain-green); margin-top: 0.3rem;">
                            <i class="bi bi-clock"></i> <span id="uptimeDays">0天</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 主内容包装器 -->
            <div class="main-content-wrapper">
                <!-- 左侧功能导航栏 -->
                <div class="sidebar-nav">
                    <h3 class="sidebar-title">功能模块</h3>
                    <div class="function-nav-list">
                        <a href="#" class="function-nav-item active" onclick="showSection('transaction')" id="nav-transaction" data-section="transaction">
                            <div class="nav-title">交易甄别</div>
                            <div class="nav-description">检测异常交易保障安全</div>
                        </a>

                        <a href="#" class="function-nav-item" onclick="showSection('address')" id="nav-address" data-section="address">
                            <div class="nav-title">地址检测</div>
                            <div class="nav-description">分析区块链地址风险等级</div>
                        </a>

                        <a href="#" class="function-nav-item" onclick="showSection('code')" id="nav-generate" data-section="code">
                            <div class="nav-title">代码生成</div>
                            <div class="nav-description">智能合约代码解析重构</div>
                        </a>

                        <a href="#" class="function-nav-item" onclick="showSection('data')" id="nav-realtime" data-section="data">
                            <div class="nav-title">实时数据</div>
                            <div class="nav-description">区块链交易统计分析</div>
                        </a>
                    </div>
                </div>

                <!-- 右侧主内容区域 -->
                <div class="main-content-area">

                        <!-- 交易甄别模块 -->
            <div id="transaction-section" class="content-section active">
                <div class="content-card">
                    <h3 class="content-title">
                        <i class="bi bi-shield-check"></i>
                        交易甄别 (Transaction Screening)
                    </h3>
                    <p class="content-description">
                        该系统旨在识别和检测区块链交易中的多种潜在风险，确保区块链生态系统的安全性。它能够检测以下几种风险场景：钓鱼活动，识别可能的钓鱼攻击；恶意合约，检测与已知恶意合约的交易；黑名单地址，检测与已知黑名单地址的交互；可疑转账活动，识别洗钱交易行为；智能合约漏洞，检测涉及用户资金的漏洞地址。此外，系统还可标识无风险的安全交易，帮助用户能够安心使用区块链平台。
                    </p>
                    
                    <div class="form-group">
                        <label for="txHash" class="form-label">交易哈希</label>
                        <div class="input-container">
                            <input 
                                type="text" 
                                class="form-control" 
                                id="txHash" 
                                placeholder="请输入标准以太坊交易哈希 (0x + 64位十六进制字符)"
                                maxlength="66"
                            >
                        </div>
                        <div class="form-help-text mt-2">
                            <small style="color: var(--text-secondary);">
                                <i class="bi bi-info-circle me-1"></i>
                                输入格式：0x 开头，后跟64个十六进制字符 (0-9, a-f)，总长度66字符
                            </small>
                        </div>
                        
                    </div>

                    <button type="button" class="btn-primary" id="analyzeTx">
                        <i class="bi bi-search me-2"></i>
                        预测交易甄别
                </button>
                    
                    <!-- 分析结果 -->
                    <div id="txResult" class="result-card" style="display: none;">
                                                <!-- 交易网络图和风险分析结果 -->
                        <div class="transaction-content">
                            <div class="row g-3 align-items-stretch">
                                <!-- 左侧网络图和安全建议 -->
                                <div class="col-md-6">
                                    <!-- 交易网络图 -->
                                    <div class="graph-container" style="margin-bottom: 1rem;">
                                        <h6 style="color: #94a3b8; margin-bottom: 0.8rem; text-align: center; font-weight: 600; font-family: 'Orbitron', monospace;">交易网络关系图</h6>
                                    <svg id="transaction-graph" width="100%" height="280" viewBox="0 0 500 280">
                                        <!-- 图形背景 -->
                                        <rect width="100%" height="100%" fill="transparent" />
                                        
                                        <!-- 连接线组 -->
                                        <g id="graph-edges">
                                                                                    <!-- 第一层连线 (核心连接) -->
                                        <path id="edge-0" class="graph-edge level-0" d="M230,110 L250,145" stroke="#3498db" stroke-width="2.5" opacity="0.8" />
                                        <path id="edge-1" class="graph-edge level-0" d="M250,145 L270,180" stroke="#3498db" stroke-width="2.5" opacity="0.8" />
                                        
                                        <!-- 第二层连线 -->
                                        <path id="edge-2" class="graph-edge level-1" d="M230,110 L130,80" stroke="#5dade2" stroke-width="2" opacity="0.6" />
                                        <path id="edge-3" class="graph-edge level-1" d="M230,110 L170,50" stroke="#5dade2" stroke-width="2" opacity="0.6" />
                                        <path id="edge-4" class="graph-edge level-1" d="M230,110 L320,40" stroke="#5dade2" stroke-width="2" opacity="0.6" />
                                        <path id="edge-5" class="graph-edge level-1" d="M230,110 L370,90" stroke="#5dade2" stroke-width="2" opacity="0.6" />
                                        
                                        <!-- 第三层连线 -->
                                        <path id="edge-6" class="graph-edge level-2" d="M270,180 L135,230" stroke="#85c1e9" stroke-width="1.5" opacity="0.5" />
                                        <path id="edge-7" class="graph-edge level-2" d="M270,180 L205,260" stroke="#85c1e9" stroke-width="1.5" opacity="0.5" />
                                        <path id="edge-8" class="graph-edge level-2" d="M270,180 L330,250" stroke="#85c1e9" stroke-width="1.5" opacity="0.5" />
                                        <path id="edge-9" class="graph-edge level-2" d="M270,180 L375,220" stroke="#85c1e9" stroke-width="1.5" opacity="0.5" />
                                        </g>
                                        
                                        <!-- 节点组 -->
                                        <g id="graph-nodes">
                                                                                    <!-- 核心节点 (交易双方) -->
                                        <g id="node-0" class="graph-node level-0" opacity="1">
                                            <circle cx="230" cy="110" r="18" fill="#3498db" stroke="white" stroke-width="2" filter="drop-shadow(0 0 6px rgba(52, 152, 219, 0.6))" />
                                            <text x="230" y="110" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9" font-weight="bold">发送方</text>
                                        </g>
                                        
                                        <g id="node-1" class="graph-node level-0" opacity="1">
                                            <circle cx="270" cy="180" r="16" fill="#3498db" stroke="white" stroke-width="2" filter="drop-shadow(0 0 6px rgba(52, 152, 219, 0.6))" />
                                            <text x="270" y="180" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9" font-weight="bold">接收方</text>
                                        </g>
                                        
                                        <g id="node-2" class="graph-node level-0" opacity="1">
                                            <circle cx="250" cy="145" r="10" fill="#f39c12" stroke="white" stroke-width="2" filter="drop-shadow(0 0 4px rgba(243, 156, 18, 0.6))" />
                                            <text x="250" y="145" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="8" font-weight="bold">TX</text>
                                        </g>
                                        
                                        <!-- 第二层节点 (发送方相关) -->
                                        <g id="node-3" class="graph-node level-1" opacity="1">
                                            <circle cx="130" cy="80" r="10" fill="#5dade2" stroke="white" stroke-width="2" />
                                            <text x="130" y="80" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">A</text>
                                        </g>
                                        
                                        <g id="node-4" class="graph-node level-1" opacity="1">
                                            <circle cx="170" cy="50" r="8" fill="#5dade2" stroke="white" stroke-width="2" />
                                            <text x="170" y="50" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">B</text>
                                        </g>
                                        
                                        <g id="node-5" class="graph-node level-1" opacity="1">
                                            <circle cx="320" cy="40" r="9" fill="#5dade2" stroke="white" stroke-width="2" />
                                            <text x="320" y="40" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">C</text>
                                        </g>
                                        
                                        <g id="node-6" class="graph-node level-1" opacity="1">
                                            <circle cx="370" cy="90" r="11" fill="#5dade2" stroke="white" stroke-width="2" />
                                            <text x="370" y="90" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">D</text>
                                        </g>
                                        
                                        <!-- 第三层节点 (接收方相关) -->
                                        <g id="node-7" class="graph-node level-2" opacity="1">
                                            <circle cx="135" cy="230" r="10" fill="#85c1e9" stroke="white" stroke-width="2" />
                                            <text x="135" y="230" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">E</text>
                                        </g>
                                        
                                        <g id="node-8" class="graph-node level-2" opacity="1">
                                            <circle cx="205" cy="260" r="8" fill="#85c1e9" stroke="white" stroke-width="2" />
                                            <text x="205" y="260" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">F</text>
                                        </g>
                                        
                                        <g id="node-9" class="graph-node level-2" opacity="1">
                                            <circle cx="330" cy="250" r="9" fill="#85c1e9" stroke="white" stroke-width="2" />
                                            <text x="330" y="250" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">G</text>
                                        </g>
                                        
                                        <g id="node-10" class="graph-node level-2" opacity="1">
                                            <circle cx="375" cy="220" r="7" fill="#85c1e9" stroke="white" stroke-width="2" />
                                            <text x="375" y="220" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="8">H</text>
                                        </g>
                                        </g>
                                    </svg>
                </div>
                                    
                                    <!-- 安全建议 -->
                                    <div class="risk-recommendation">
                                        <div class="recommendation-header">
                                            <i class="bi bi-lightbulb-fill"></i>
                                            <span>安全建议</span>
            </div>
                                        <div class="recommendation-content" id="risk-recommendation">
                                            <p>✅ 该交易通过所有安全检测，可以放心执行</p>
                                            <p>💡 建议持续关注交易对手的历史行为</p>
        </div>
                                    </div>
                </div>
                            
                                <!-- 右侧风险分析结果 -->
                                <div class="col-md-6">
                                    <div id="txRisks">
                                        <h6 style="color: #94a3b8; margin-bottom: 0.8rem; text-align: center; font-weight: 600; font-family: 'Orbitron', monospace;">智能风险分析</h6>
                                        <div class="risk-content-wrapper">
                                            <!-- 风险评估概览 -->
                                            <div class="risk-overview-panel">
                                            <div class="risk-score-display">
                                                <div class="score-circle">
                                                    <span class="score-value" id="risk-score">85</span>
                                                    <span class="score-label">安全分</span>
                                                </div>
                                                <div class="score-description">
                                                    <div class="score-status" id="overall-status">低风险交易</div>
                                                    <div class="score-subtitle">基于5项安全指标分析</div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 风险检测详情 -->
                                        <div class="risk-details-section">
                                            <div class="section-header">
                                                <i class="bi bi-shield-check-fill"></i>
                                                <span>安全检测项目</span>
                                            </div>
                                            
                                            <div class="risk-item-grid">
                                                <!-- 钓鱼活动检测 -->
                                                <div class="risk-check-item" data-risk-type="phishing">
                                                    <div class="risk-icon-container">
                                                        <i class="bi bi-shield-check risk-icon safe"></i>
                                                    </div>
                                                    <div class="risk-content">
                                                        <div class="risk-title">钓鱼活动检测</div>
                                                        <div class="risk-status">✓ 通过检测</div>
                                                        <div class="risk-description">交易流向正常，未发现欺诈行为</div>
                                                    </div>
                                                </div>

                                                <!-- 恶意合约检测 -->
                                                <div class="risk-check-item" data-risk-type="malicious">
                                                    <div class="risk-icon-container">
                                                        <i class="bi bi-shield-check risk-icon safe"></i>
                                                    </div>
                                                    <div class="risk-content">
                                                        <div class="risk-title">恶意合约检测</div>
                                                        <div class="risk-status">✓ 通过检测</div>
                                                        <div class="risk-description">合约代码安全，无恶意逻辑</div>
                                                    </div>
                                                </div>

                                                <!-- 黑名单地址检测 -->
                                                <div class="risk-check-item" data-risk-type="blacklist">
                                                    <div class="risk-icon-container">
                                                        <i class="bi bi-shield-check risk-icon safe"></i>
                                                    </div>
                                                    <div class="risk-content">
                                                        <div class="risk-title">黑名单地址检测</div>
                                                        <div class="risk-status">✓ 通过检测</div>
                                                        <div class="risk-description">地址清洁，无风险记录</div>
                                                    </div>
                                                </div>

                                                <!-- 资金安全检测 -->
                                                <div class="risk-check-item" data-risk-type="theft">
                                                    <div class="risk-icon-container">
                                                        <i class="bi bi-shield-check risk-icon safe"></i>
                                                    </div>
                                                    <div class="risk-content">
                                                        <div class="risk-title">资金安全检测</div>
                                                        <div class="risk-status">✓ 通过检测</div>
                                                        <div class="risk-description">资金来源合法，无盗窃迹象</div>
                                                    </div>
                                                </div>

                                                <!-- 智能合约漏洞检测 -->
                                                <div class="risk-check-item" data-risk-type="vulnerability">
                                                    <div class="risk-icon-container">
                                                        <i class="bi bi-shield-check risk-icon safe"></i>
                                                    </div>
                                                    <div class="risk-content">
                                                        <div class="risk-title">合约漏洞检测</div>
                                                        <div class="risk-status">✓ 通过检测</div>
                                                        <div class="risk-description">代码结构稳定，无已知漏洞</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
            </div>

                        <!-- 交易详细信息 -->
                        <div class="transaction-details-section">
                            <h5 style="color: var(--neon-cyan); margin-bottom: 1rem; text-align: center;">交易详细信息</h5>
                            <div style="background: rgba(0, 20, 40, 0.6); padding: 1.5rem; border-radius: 15px; border: 1px solid rgba(0, 255, 204, 0.2);">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <div class="mb-2" style="font-size: 0.9rem;">
                                            <strong style="color: var(--neon-cyan);">Transaction Hash:</strong><br>
                                            <span class="text-truncate d-block" id="tx-hash-display" style="font-family: 'Orbitron', monospace; font-size: 0.8rem;">0x742d356c6c7c3a3c5a8f5b5d94ec8a20bf4a8c2</span>
                </div>
                                        <div class="mb-2">
                                            <strong style="color: var(--neon-cyan);">Status:</strong>
                                            <span id="tx-status-badge" class="badge bg-success ms-2" style="font-size: 0.8rem;">Success</span>
                    </div>
                                        <div class="mb-2" style="font-size: 0.9rem;">
                                            <strong style="color: var(--neon-cyan);">Block:</strong>
                                            <span class="ms-1" style="color: #4a90e2;">22409812</span>
                                            <span class="ms-1" style="color: rgba(255, 255, 255, 0.6);">(11 Confirmations)</span>
                </div>
                                        <div class="mb-2" style="font-size: 0.9rem;">
                                            <strong style="color: var(--neon-cyan);">Timestamp:</strong><br>
                                            <span id="tx-timestamp" style="font-size: 0.85rem;">2 mins ago (Jun 26, 2025, 12:02:36 PM UTC)</span>
                                        </div>
                                        <div style="font-size: 0.9rem;">
                                            <strong style="color: var(--neon-cyan);">Method:</strong>
                                            <span class="ms-1 badge bg-info" style="font-size: 0.75rem;">Transfer</span>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <div class="mb-2" style="font-size: 0.9rem;">
                                            <strong style="color: var(--neon-cyan);">From:</strong><br>
                                            <span style="font-family: 'Orbitron', monospace; font-size: 0.8rem; color: #4a90e2;">titanbuilder.eth (Titan Builder)</span>
                                        </div>
                                        <div class="mb-2" style="font-size: 0.9rem;">
                                            <strong style="color: var(--neon-cyan);">To:</strong><br>
                                            <span style="font-family: 'Orbitron', monospace; font-size: 0.8rem; color: #4a90e2;">0x503bc6453eee236a31639e31021d503d14c6a...</span>
                                        </div>
                                        <div class="mb-2" style="font-size: 0.9rem;">
                                            <strong style="color: var(--neon-cyan);">Value:</strong>
                                            <span class="ms-1" style="color: #f39c12;">0.02533912567354679 ETH ($48.38)</span>
                                        </div>
                                        <div class="mb-2" style="font-size: 0.9rem;">
                                            <strong style="color: var(--neon-cyan);">Transaction Fee:</strong>
                                            <span class="ms-1" style="color: #f39c12;">0.000087114510735 ETH ($0.17)</span>
                                        </div>
                                        <div class="mb-2" style="font-size: 0.9rem;">
                                            <strong style="color: var(--neon-cyan);">Gas Price:</strong>
                                            <span class="ms-1" style="color: #f39c12;">4.148310035 Gwei</span>
                                        </div>
                                        <div style="font-size: 0.9rem;">
                                            <strong style="color: var(--neon-cyan);">Network:</strong>
                                            <span class="ms-1" style="color: #4a90e2;">Ethereum Mainnet</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

                        <!-- 地址检测模块 -->
            <div id="address-section" class="content-section">
                <div class="content-card">
                    <h3 class="content-title">
                        <i class="bi bi-search-heart"></i>
                        地址检测 (Address Detection)
                    </h3>
                    <p class="content-description">
                        该系统旨在识别和检测区块链地址的各种潜在风险，确保区块链生态系统的安全性。与交易检测同时，地址检测侧重于个体地址的行为和历史活动。系统能够检测以下几种风险：钓鱼活动，识别经常参与钓鱼攻击的地址；恶意合约地址，检测与已知恶意合约交互的地址；黑名单地址，识别参与金融欺诈的地址；盗窃活动，检测用于盗窃用户资金的薄弱地址。此外，系统还能标识无风险的安全地址，帮助用户识别和避免所有风险地址。
                    </p>
                    
                    <div class="form-group">
                        <label for="addressInput" class="form-label">区块链地址</label>
                        <div class="input-container">
                            <input 
                                type="text" 
                                class="form-control" 
                                id="addressInput" 
                                placeholder="请输入标准以太坊地址 (0x + 40位十六进制字符)"
                                maxlength="42"
                            >
                        </div>
                        <div class="form-help-text mt-2">
                            <small style="color: var(--text-secondary);">
                                <i class="bi bi-info-circle me-1"></i>
                                输入格式：0x 开头，后跟40个十六进制字符 (0-9, a-f)，总长度42字符
                            </small>
                        </div>
                        
                    </div>

                    <button type="button" class="btn-primary" id="analyzeAddress">
                        <i class="bi bi-search me-2"></i>
                        评估地址风险
                </button>
                    
                    <!-- 检测结果 -->
                    <div id="addressResult" class="result-card" style="display: none;">
                        <!-- 地址信息栏 -->
                        <div style="background: rgba(0, 20, 40, 0.6); padding: 1rem; border-radius: 10px; border: 1px solid rgba(0, 255, 204, 0.2); margin-bottom: 1rem;">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div class="text-truncate me-3" style="flex-grow: 1;">
                                    <strong style="color: var(--neon-cyan);">检测地址：</strong><br>
                                    <span id="result-address-display" style="font-family: 'Orbitron', monospace; font-size: 0.9rem; color: #4a90e2;">0x85BC81fc84892cf1b391510f8e3784fTc9d1f9297</span>
            </div>
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <span style="color: var(--neon-cyan); font-weight: 500;">检测结果：</span>
                                <span id="address-risk-badge" class="badge bg-success rounded-pill d-flex align-items-center" style="font-size: 0.85rem; padding: 0.5rem 1rem;">
                                    <i class="bi bi-shield-check me-1"></i> 风险项 0
                                </span>
            </div>
        </div>

                        <!-- 地址网络图和风险评估 -->
                        <div class="row g-3 align-items-stretch mb-3">
                            <!-- 左侧网络图 -->
                            <div class="col-md-6">
                                <div class="graph-container" style="background: rgba(0, 0, 0, 0.2); padding: 1.5rem; border-radius: 15px; height: 350px; border: 1px solid rgba(0, 255, 204, 0.2); position: relative;">
                                    <h6 style="color: var(--neon-cyan); margin-bottom: 1rem; text-align: center;">地址关联网络图</h6>
                                    <!-- 缩放控制按钮 (已隐藏，保持美观) -->
                                    <div class="graph-controls" style="position: absolute; top: 45px; right: 15px; z-index: 10; display: none;">
                                        <button onclick="zoomGraph(1.2)" class="btn btn-sm" style="background: rgba(0, 255, 204, 0.2); border: 1px solid var(--neon-cyan); color: var(--neon-cyan); margin-bottom: 5px; padding: 4px 8px;">
                                            <i class="bi bi-zoom-in"></i>
                                        </button>
                                        <br>
                                        <button onclick="zoomGraph(0.8)" class="btn btn-sm" style="background: rgba(0, 255, 204, 0.2); border: 1px solid var(--neon-cyan); color: var(--neon-cyan); margin-bottom: 5px; padding: 4px 8px;">
                                            <i class="bi bi-zoom-out"></i>
                                        </button>
                                        <br>
                                        <button onclick="resetGraphZoom()" class="btn btn-sm" style="background: rgba(0, 255, 204, 0.2); border: 1px solid var(--neon-cyan); color: var(--neon-cyan); padding: 4px 8px;">
                                            <i class="bi bi-arrow-clockwise"></i>
                                        </button>
                                    </div>
                                    <svg id="address-graph" width="100%" height="270" viewBox="0 0 500 270" style="cursor: grab;"
                                         onmousedown="startPan(event)" onmousemove="doPan(event)" onmouseup="endPan()" onmouseleave="endPan()"
                                         onwheel="handleWheel(event)">
                                        <!-- 图形背景 -->
                                        <rect width="100%" height="100%" fill="transparent" />
                                        
                                                                <!-- 连接线组 -->
                        <g id="address-graph-edges">
                            <!-- 第一层连线 (直接连接) -->
                            <path id="address-edge-0" class="address-edge level-0" d="M250,135 L135,85" stroke="#3498db" stroke-width="2" opacity="0.8" />
                            <path id="address-edge-1" class="address-edge level-0" d="M250,135 L185,205" stroke="#3498db" stroke-width="2" opacity="0.8" />
                            <path id="address-edge-2" class="address-edge level-0" d="M250,135 L350,115" stroke="#3498db" stroke-width="2" opacity="0.8" />
                            <path id="address-edge-3" class="address-edge level-0" d="M250,135 L320,200" stroke="#3498db" stroke-width="2" opacity="0.8" />
                            <path id="address-edge-4" class="address-edge level-0" d="M250,135 L80,160" stroke="#3498db" stroke-width="2" opacity="0.8" />
                            
                            <!-- 第二层连线 (间接连接) -->
                            <path id="address-edge-5" class="address-edge level-1" d="M135,85 L60,110" stroke="#5dade2" stroke-width="1.5" opacity="0.6" />
                            <path id="address-edge-6" class="address-edge level-1" d="M135,85 L165,25" stroke="#5dade2" stroke-width="1.5" opacity="0.6" />
                            <path id="address-edge-7" class="address-edge level-1" d="M185,205 L110,250" stroke="#5dade2" stroke-width="1.5" opacity="0.6" />
                            <path id="address-edge-8" class="address-edge level-1" d="M350,115 L420,85" stroke="#5dade2" stroke-width="1.5" opacity="0.6" />
                            <path id="address-edge-9" class="address-edge level-1" d="M350,115 L400,180" stroke="#5dade2" stroke-width="1.5" opacity="0.6" />
                            <path id="address-edge-10" class="address-edge level-1" d="M320,200 L380,240" stroke="#5dade2" stroke-width="1.5" opacity="0.6" />
                            <path id="address-edge-11" class="address-edge level-1" d="M80,160 L40,200" stroke="#5dade2" stroke-width="1.5" opacity="0.6" />
                            <path id="address-edge-12" class="address-edge level-1" d="M80,160 L20,120" stroke="#5dade2" stroke-width="1.5" opacity="0.6" />
                            <path id="address-edge-13" class="address-edge level-1" d="M165,25 L200,15" stroke="#5dade2" stroke-width="1.5" opacity="0.6" />
                            <path id="address-edge-14" class="address-edge level-1" d="M420,85 L460,60" stroke="#5dade2" stroke-width="1.5" opacity="0.6" />
                            <path id="address-edge-15" class="address-edge level-1" d="M400,180 L450,210" stroke="#5dade2" stroke-width="1.5" opacity="0.6" />
                            
                            <!-- 第三层连线 (三度关联) -->
                            <path id="address-edge-16" class="address-edge level-2" d="M60,110 L30,80" stroke="#85c1e9" stroke-width="1" opacity="0.4" />
                            <path id="address-edge-17" class="address-edge level-2" d="M200,15 L180,50" stroke="#85c1e9" stroke-width="1" opacity="0.4" />
                            <path id="address-edge-18" class="address-edge level-2" d="M460,60 L480,30" stroke="#85c1e9" stroke-width="1" opacity="0.4" />
                        </g>
                                        
                                                                <!-- 节点组 -->
                        <g id="address-graph-nodes">
                            <!-- 核心节点 (目标地址) -->
                            <g id="address-node-0" class="address-node level-0" opacity="1">
                                <circle cx="250" cy="135" r="22" fill="#3498db" stroke="white" stroke-width="2" filter="drop-shadow(0 0 8px rgba(52, 152, 219, 0.6))" />
                                <text x="250" y="135" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="10" font-weight="bold">核心</text>
                            </g>
                            
                            <!-- 第一层节点 (直接关联) -->
                            <g id="address-node-1" class="address-node level-0" opacity="1">
                                <circle cx="135" cy="85" r="15" fill="#5dade2" stroke="white" stroke-width="2" filter="drop-shadow(0 0 4px rgba(93, 173, 226, 0.4))" />
                                <text x="135" y="85" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="10">A</text>
                            </g>
                            
                            <g id="address-node-2" class="address-node level-0" opacity="1">
                                <circle cx="185" cy="205" r="15" fill="#5dade2" stroke="white" stroke-width="2" filter="drop-shadow(0 0 4px rgba(93, 173, 226, 0.4))" />
                                <text x="185" y="205" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="10">B</text>
                            </g>
                            
                            <g id="address-node-3" class="address-node level-0" opacity="1">
                                <circle cx="350" cy="115" r="15" fill="#5dade2" stroke="white" stroke-width="2" filter="drop-shadow(0 0 4px rgba(93, 173, 226, 0.4))" />
                                <text x="350" y="115" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="10">C</text>
                            </g>
                            
                            <g id="address-node-4" class="address-node level-0" opacity="1">
                                <circle cx="320" cy="200" r="15" fill="#5dade2" stroke="white" stroke-width="2" filter="drop-shadow(0 0 4px rgba(93, 173, 226, 0.4))" />
                                <text x="320" y="200" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="10">D</text>
                            </g>
                            
                            <g id="address-node-5" class="address-node level-0" opacity="1">
                                <circle cx="80" cy="160" r="15" fill="#5dade2" stroke="white" stroke-width="2" filter="drop-shadow(0 0 4px rgba(93, 173, 226, 0.4))" />
                                <text x="80" y="160" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="10">E</text>
                            </g>
                            
                            <!-- 第二层节点 (间接关联) -->
                            <g id="address-node-6" class="address-node level-1" opacity="1">
                                <circle cx="60" cy="110" r="12" fill="#85c1e9" stroke="white" stroke-width="2" />
                                <text x="60" y="110" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">F</text>
                            </g>
                            
                            <g id="address-node-7" class="address-node level-1" opacity="1">
                                <circle cx="165" cy="25" r="12" fill="#85c1e9" stroke="white" stroke-width="2" />
                                <text x="165" y="25" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">G</text>
                            </g>
                            
                            <g id="address-node-8" class="address-node level-1" opacity="1">
                                <circle cx="110" cy="250" r="12" fill="#85c1e9" stroke="white" stroke-width="2" />
                                <text x="110" y="250" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">H</text>
                            </g>
                            
                            <g id="address-node-9" class="address-node level-1" opacity="1">
                                <circle cx="420" cy="85" r="12" fill="#85c1e9" stroke="white" stroke-width="2" />
                                <text x="420" y="85" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">I</text>
                            </g>
                            
                            <g id="address-node-10" class="address-node level-1" opacity="1">
                                <circle cx="400" cy="180" r="12" fill="#85c1e9" stroke="white" stroke-width="2" />
                                <text x="400" y="180" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">J</text>
                            </g>
                            
                            <g id="address-node-11" class="address-node level-1" opacity="1">
                                <circle cx="380" cy="240" r="12" fill="#85c1e9" stroke="white" stroke-width="2" />
                                <text x="380" y="240" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">K</text>
                            </g>
                            
                            <g id="address-node-12" class="address-node level-1" opacity="1">
                                <circle cx="40" cy="200" r="12" fill="#85c1e9" stroke="white" stroke-width="2" />
                                <text x="40" y="200" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">L</text>
                            </g>
                            
                            <g id="address-node-13" class="address-node level-1" opacity="1">
                                <circle cx="20" cy="120" r="12" fill="#85c1e9" stroke="white" stroke-width="2" />
                                <text x="20" y="120" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">M</text>
                            </g>
                            
                            <g id="address-node-14" class="address-node level-1" opacity="1">
                                <circle cx="200" cy="15" r="12" fill="#85c1e9" stroke="white" stroke-width="2" />
                                <text x="200" y="15" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="9">N</text>
                            </g>
                            
                            <!-- 第三层节点 (三度关联) -->
                            <g id="address-node-15" class="address-node level-2" opacity="1">
                                <circle cx="460" cy="60" r="10" fill="#a9d3f0" stroke="white" stroke-width="1" />
                                <text x="460" y="60" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="8">O</text>
                            </g>
                            
                            <g id="address-node-16" class="address-node level-2" opacity="1">
                                <circle cx="450" cy="210" r="10" fill="#a9d3f0" stroke="white" stroke-width="1" />
                                <text x="450" y="210" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="8">P</text>
                            </g>
                            
                            <g id="address-node-17" class="address-node level-2" opacity="1">
                                <circle cx="30" cy="80" r="10" fill="#a9d3f0" stroke="white" stroke-width="1" />
                                <text x="30" y="80" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="8">Q</text>
                            </g>
                            
                            <g id="address-node-18" class="address-node level-2" opacity="1">
                                <circle cx="180" cy="50" r="10" fill="#a9d3f0" stroke="white" stroke-width="1" />
                                <text x="180" y="50" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="8">R</text>
                            </g>
                            
                            <g id="address-node-19" class="address-node level-2" opacity="1">
                                <circle cx="480" cy="30" r="10" fill="#a9d3f0" stroke="white" stroke-width="1" />
                                <text x="480" y="30" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="8">S</text>
                            </g>
                        </g>
                                    </svg>
                </div>
            </div>

                            <!-- 右侧风险评估 -->
                            <div class="col-md-6">
                                <h5 style="color: var(--neon-cyan); margin-bottom: 1rem; text-align: center;">风险评估结果</h5>
                                <div id="addressRisks" style="background: rgba(0, 20, 40, 0.6); padding: 1rem; border-radius: 15px; border: 1px solid rgba(0, 255, 204, 0.2); height: 350px; overflow-y: auto; font-size: 0.9rem;">
                                    <div class="text-center py-3">
                                        <i class="bi bi-shield-check text-success" style="font-size: 2.5rem;"></i>
                                        <h5 class="mt-3" style="color: var(--blockchain-green);">未检测到风险</h5>
                                        <p class="text-muted">该地址未被发现存在已知风险</p>
                </div>
                    </div>
                    </div>
                    </div>

                        <!-- 地址信息 -->
                        <div class="mt-3">
                            <h5 style="color: var(--neon-cyan); text-align: center; margin-bottom: 1rem;">地址信息</h5>
                            <div style="background: rgba(0, 20, 40, 0.6); padding: 1rem; border-radius: 10px; border: 1px solid rgba(0, 255, 204, 0.2);">
                                <div class="row">
                                    <div class="col-md-6 mb-2">
                                        <strong style="color: var(--neon-cyan);">ETH BALANCE:</strong><br>
                                        <span id="eth-balance" style="color: #f39c12; font-family: 'Orbitron', monospace;">0.0001 ETH</span>
                </div>
                                    <div class="col-md-6 mb-2">
                                        <strong style="color: var(--neon-cyan);">ETH VALUE:</strong><br>
                                        <span id="eth-value" style="color: #f39c12; font-family: 'Orbitron', monospace;">$0.39 (@ $3,892.64/ETH)</span>
                                    </div>
                                    <div class="col-12 mb-2">
                                        <strong style="color: var(--neon-cyan);">PRIVATE NAME TAGS:</strong>
                                        <span data-field="private-tag" class="ms-2" style="color: rgba(255, 255, 255, 0.6);">Not Available</span>
                                    </div>
                                    <div class="col-12 mb-2">
                                        <strong style="color: var(--neon-cyan);">LAST_TXN_SENT:</strong><br>
                                        <span class="small text-truncate d-block" id="last-txn" style="color: #4a90e2; font-family: 'Orbitron', monospace; font-size: 0.8rem;">0x3c9246141ca600c1e5637fb95Bb395c3e30fva06eeac30ax7a3fc3ae216as<br><span style="color: rgba(255, 255, 255, 0.6);">(from 2403 days ago)</span></span>
                                    </div>
                                    <div class="col-12">
                                        <strong style="color: var(--neon-cyan);">FIRST_TXN_SENT:</strong><br>
                                        <span class="small text-truncate d-block" id="first-txn" style="color: #4a90e2; font-family: 'Orbitron', monospace; font-size: 0.8rem;">0xb7e34d32fa2e0c0f21fea908335a4a0d0406dc31c4cc9dd04a9982ba3dde9<br><span style="color: rgba(255, 255, 255, 0.6);">(from 2447 days ago)</span></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 代码生成模块 -->
            <div id="code-section" class="content-section">
                <div class="content-card">
                    <h3 class="content-title">
                        <i class="bi bi-braces-asterisk"></i>
                        代码生成 (Code Generate)
                    </h3>
                    <p class="content-description">
                        在构建交易函数的过程中，合约编写者常采用代码中难以辨读并理解的问题，这可能提供了合约的攻击面。EtherSentinel开发了区域分析的技术来识别这类风险。恶意的函数如通常被定义为0x5b1e3b51的十六进制字符串代替，这为进一步分析合约瘦户方面的安全风险带来了困难。本系统利用训练模型理解，实现函数名称量能力，从而克服这一难点。通过低复杂度的函数名，系统能够更准确的检测合约代码，识别潜在风险，确保区块链生态系统的安全。
                    </p>
                    
                    <div class="form-group">
                        <label for="codeInput" class="form-label">合约地址</label>
                        <div class="input-container">
                            <select class="form-select blockchain-network-select">
                                <option>Ethereum</option>
                                <option>BSC</option>
                                <option>Polygon</option>
                            </select>
                            <input 
                                type="text" 
                                class="form-control" 
                                id="codeInput" 
                                placeholder="请输入待检测的地址"
                            >
                </div>
            </div>

                    <button type="button" class="btn-primary" id="generateCode">
                        <i class="bi bi-gear me-2"></i>
                        生成函数名
                    </button>
                    
                    <!-- 生成结果 -->
                    <div id="codeResult" class="result-card" style="display: none;">
                        <!-- 输入信息展示 -->
                        <div style="background: rgba(0, 20, 40, 0.6); padding: 1rem; border-radius: 10px; border: 1px solid rgba(0, 255, 204, 0.2); margin-bottom: 1rem;">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div class="text-truncate me-3" style="flex-grow: 1;">
                                    <strong style="color: var(--neon-cyan);">输入合约地址：</strong><br>
                                    <span id="contract-address-display" style="font-family: 'Orbitron', monospace; font-size: 0.9rem; color: #4a90e2;">0x85BC81fc84892cf1b391510f8e3784fTc9d1f9297</span>
                </div>
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <span style="color: var(--neon-cyan); font-weight: 500;">处理状态：</span>
                                <span class="badge bg-success rounded-pill d-flex align-items-center" style="font-size: 0.85rem; padding: 0.5rem 1rem;">
                                    <i class="bi bi-check-circle me-1"></i> 函数名恢复完成
                                </span>
                            </div>
            </div>

                        <h5 style="color: var(--neon-cyan); margin-bottom: 1rem; text-align: center;">代码生成结果</h5>
                        <div class="row g-3 align-items-stretch">
                            <div class="col-md-6">
                                <h6 style="color: var(--neon-cyan); text-align: center; margin-bottom: 1rem;">原始合约扫描结果</h6>
                                <div id="originalData" style="background: rgba(0, 20, 40, 0.6); padding: 1rem; border-radius: 10px; border: 1px solid rgba(255, 0, 77, 0.3); font-size: 0.85rem; overflow-x: auto; min-height: 320px;">
                                    <pre style="color: var(--text-secondary); margin: 0; white-space: pre-wrap; font-family: 'Orbitron', monospace; line-height: 1.4;">{
  "is_contract": true,
  "goplus": "stealing attack",
  "code": {
     "_dispatcher": "function _dispatcher",
     "_fallback": "function _fallback payable view pure",
     "withdraw()": "function withdraw()",
     "<span style="color: #ff6b6b; font-weight: bold; background: rgba(255, 107, 107, 0.1); padding: 2px 4px; border-radius: 3px;">0x5b1e3b51</span>": "function <span style="color: #ff6b6b; font-weight: bold; background: rgba(255, 107, 107, 0.1); padding: 2px 4px; border-radius: 3px;">0x5b1e3b51</span> payable view",
     "<span style="color: #ff6b6b; font-weight: bold; background: rgba(255, 107, 107, 0.1); padding: 2px 4px; border-radius: 3px;">0x5fe2e4d1</span>": "function <span style="color: #ff6b6b; font-weight: bold; background: rgba(255, 107, 107, 0.1); padding: 2px 4px; border-radius: 3px;">0x5fe2e4d1</span> payable view",
     "withdraw(address,uint256)": "function withdraw(address,uint256) view"
   }
}</pre>
                </div>
                    </div>
                            <div class="col-md-6">
                                <h6 style="color: var(--neon-cyan); text-align: center; margin-bottom: 1rem;">生成结果</h6>
                                <div id="generatedData" style="background: rgba(0, 20, 40, 0.6); padding: 1rem; border-radius: 10px; border: 1px solid rgba(0, 255, 204, 0.3); font-size: 0.85rem; overflow-x: auto; min-height: 320px;">
                                    <pre style="color: var(--text-secondary); margin: 0; white-space: pre-wrap; font-family: 'Orbitron', monospace; line-height: 1.4;">{
  "is_contract": true,
  "goplus": "stealing attack",
  "code": {
     "_dispatcher": "function _dispatcher",
     "_fallback": "function _fallback payable view pure",
     "withdraw()": "function withdraw()",
     "<span style="color: #00ffcc; font-weight: bold; background: rgba(0, 255, 204, 0.1); padding: 2px 4px; border-radius: 3px; text-shadow: 0 0 8px rgba(0, 255, 204, 0.3);">approveTransaction()</span>": "function <span style="color: #00ffcc; font-weight: bold; background: rgba(0, 255, 204, 0.1); padding: 2px 4px; border-radius: 3px; text-shadow: 0 0 8px rgba(0, 255, 204, 0.3);">approveTransaction()</span> payable view",
     "<span style="color: #00ffcc; font-weight: bold; background: rgba(0, 255, 204, 0.1); padding: 2px 4px; border-radius: 3px; text-shadow: 0 0 8px rgba(0, 255, 204, 0.3);">finalizePayment()</span>": "function <span style="color: #00ffcc; font-weight: bold; background: rgba(0, 255, 204, 0.1); padding: 2px 4px; border-radius: 3px; text-shadow: 0 0 8px rgba(0, 255, 204, 0.3);">finalizePayment()</span> payable view",
     "withdraw(address,uint256)": "function withdraw(address,uint256) view"
   }
}</pre>
                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 实时数据模块 -->
            <div id="data-section" class="content-section">
                <div class="content-card">
                    <h3 class="content-title">
                        <i class="bi bi-activity"></i>
                        实时数据 (Real-time Data)
                    </h3>
                    <p class="content-description">
                        该系统旨在实时监控和分析区块链交易，以识别和检测多种潜在风险，确保区块链生态系统的安全。系统能够检测以下几种风险场景：钓鱼活动，识别可疑进行的钓鱼攻击；恶意合约交易，与已知恶意合约的智能交互；黑名单地址，检测与已知恶意地址的交互；可疑转账活动，识别洗钱行为的资金流动；智能合约漏洞，检测用户资金的潜在威胁。此外，系统还可提供实时风险评估安全交易，帮助用户安心使用区块链平台。
                    </p>
                    
                    <button type="button" class="btn-primary" id="getRealTimeData">
                        <i class="bi bi-download me-2"></i>
                        获取实时数据
                    </button>
                    
                    <button type="button" class="btn-primary ms-2" id="updateData" style="display: none;">
                        <i class="bi bi-arrow-clockwise me-2"></i>
                        手动更新
                    </button>
                    
                    <button type="button" class="btn-outline-secondary ms-2 btn-sm" id="stopAutoUpdate" style="display: none; padding: 0.25rem 0.5rem;">
                        <i class="bi bi-pause-circle"></i>
                    </button>
                    
                    <!-- 数据展示 -->
                    <div id="dataResult" class="result-card" style="display: none;">
                        <!-- 状态信息栏 -->
                        <div style="background: rgba(0, 20, 40, 0.6); padding: 1rem; border-radius: 10px; border: 1px solid rgba(0, 255, 204, 0.2); margin-bottom: 1rem;">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div class="d-flex align-items-center">
                                    <div class="me-4">
                                        <strong style="color: var(--neon-cyan);">链名：</strong>
                                        <span style="color: #4a90e2; font-family: 'Orbitron', monospace;">ethereum</span>
                </div>

                                    <div>
                                        <strong style="color: var(--neon-cyan);">交易子图构建：</strong>
                                        <span class="badge bg-success rounded-pill" style="font-size: 0.75rem;">
                                            <i class="bi bi-check-circle me-1"></i>成功构建
                                        </span>
                                    </div>
                                </div>
                                <div class="d-flex align-items-center">
                                    <span id="data-loading-indicator" class="me-3 d-none" style="color: rgba(255, 255, 255, 0.6);">
                                        <span class="spinner-border spinner-border-sm" aria-hidden="true"></span>
                                        获取中...
                                    </span>
                                </div>
            </div>
        </div>

                        <h5 style="color: var(--neon-cyan); margin-bottom: 1rem; text-align: center;">实时交易数据</h5>
                        
                        <!-- 数据统计信息 -->
                        <div id="dataStats" class="mb-3" style="display: none;">
                            <!-- 区块信息显示 -->
                            <div class="row g-3 mb-3">
                                <div class="col-md-6">
                                    <div style="background: rgba(0, 40, 80, 0.4); padding: 1rem; border-radius: 8px; border: 1px solid rgba(0, 255, 204, 0.3);">
                                        <div style="color: var(--neon-cyan); font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem;">
                                            <i class="bi bi-layers me-2"></i>当前区块
                                        </div>
                                        <div style="color: var(--neon-cyan); font-size: 1.4rem; font-weight: bold; font-family: 'Orbitron', monospace;" id="currentBlock">22409812</div>
                                        <div style="color: #94a3b8; font-size: 0.75rem; margin-top: 0.3rem;">
                                            <span id="blockTimestamp">2024-01-15 14:23:45</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div style="background: rgba(0, 40, 80, 0.4); padding: 1rem; border-radius: 8px; border: 1px solid rgba(0, 255, 204, 0.3);">
                                        <div style="color: var(--neon-cyan); font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem;">
                                            <i class="bi bi-clock me-2"></i>自动更新状态
                                        </div>
                                        <div style="color: #22c55e; font-size: 1rem; font-weight: bold;" id="updateStatus">
                                            <i class="bi bi-play-circle me-1"></i>启动中...
                                        </div>
                                        <div style="color: #94a3b8; font-size: 0.75rem; margin-top: 0.3rem;">
                                            下次更新: <span id="nextUpdateTime">60秒后</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 交易统计 -->
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <div style="background: rgba(0, 40, 80, 0.4); padding: 0.8rem; border-radius: 8px; border: 1px solid rgba(34, 197, 94, 0.3); text-align: center;">
                                        <div style="color: #22c55e; font-size: 1.2rem; font-weight: bold;" id="safeCount">0</div>
                                        <div style="color: #94a3b8; font-size: 0.8rem;">安全交易</div>
            </div>
                                </div>
                                <div class="col-md-4">
                                    <div style="background: rgba(80, 20, 20, 0.4); padding: 0.8rem; border-radius: 8px; border: 1px solid rgba(239, 68, 68, 0.3); text-align: center;">
                                        <div style="color: #ef4444; font-size: 1.2rem; font-weight: bold;" id="riskCount">0</div>
                                        <div style="color: #94a3b8; font-size: 0.8rem;">风险交易</div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div style="background: rgba(0, 40, 80, 0.4); padding: 0.8rem; border-radius: 8px; border: 1px solid rgba(0, 255, 204, 0.3); text-align: center;">
                                        <div style="color: var(--neon-cyan); font-size: 1.2rem; font-weight: bold;" id="totalCount">0</div>
                                        <div style="color: #94a3b8; font-size: 0.8rem;">本区块交易数</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: rgba(0, 20, 40, 0.6); padding: 1rem; border-radius: 10px; border: 1px solid rgba(0, 255, 204, 0.2);">
                            <div class="data-table-container">
                                <div class="table-responsive">
                                    <table class="table table-dark table-hover table-borderless mb-0" style="background: transparent;">
                <thead>
                                            <tr style="border-bottom: 2px solid rgba(0, 255, 204, 0.3);">
                                                <th style="color: var(--neon-cyan); font-family: 'Orbitron', monospace; font-size: 0.9rem; padding: 0.8rem;">Transaction Hash</th>
                                                <th style="color: var(--neon-cyan); font-family: 'Orbitron', monospace; font-size: 0.9rem; padding: 0.8rem;">From</th>
                                                <th style="color: var(--neon-cyan); font-family: 'Orbitron', monospace; font-size: 0.9rem; padding: 0.8rem;">To</th>
                                                <th style="color: var(--neon-cyan); font-family: 'Orbitron', monospace; font-size: 0.9rem; padding: 0.8rem;">Detect</th>
                    </tr>
                </thead>
                                        <tbody id="dataTableBody" style="font-family: 'Orbitron', monospace; font-size: 0.8rem;">
                                            <!-- 数据将通过JavaScript动态填充 -->
                </tbody>
            </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                </div> <!-- 关闭 main-content-area -->
            </div> <!-- 关闭 main-content-wrapper -->
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- 加载导航栏组件 -->
    <script>
        fetch('navbar-component.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('navbar-placeholder').innerHTML = html;
                // 设置当前页面导航栏高亮
                setTimeout(() => {
                    const currentNavLink = document.querySelector('a[href="dashboard.html"]');
                    if (currentNavLink) {
                        // 移除所有其他页面的激活状态
                        document.querySelectorAll('.unified-nav-link').forEach(link => {
                            link.classList.remove('active');
                        });
                        // 设置当前页面为激活状态
                        currentNavLink.classList.add('active');
                    }
                }, 100);
            })
            .catch(error => console.error('导航栏加载失败:', error));
    </script>
    
    <script>
        // 页面加载时检查登录状态
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            initializeEventListeners();
            
            // 诊断和初始化导航状态（延迟执行确保DOM完全加载）
            setTimeout(() => {
                testNavigationElements();
                initializeNavigationState();
            }, 1000);
            
            // 初始化增强粒子系统
            initAdvancedParticleSystem();
            initMouseInteraction();
            
            // 启动动态数据更新
            initDynamicDataUpdate();
        });
        
        // 页面卸载时清理定时器
        window.addEventListener('beforeunload', function() {
            if (isRealTimeActive) {
                stopBlockAutoUpdate();
            }
        });
        
        // 页面隐藏时暂停，恢复时继续
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                if (isRealTimeActive) {
                    // 暂停定时器，但保持状态
                    if (blockUpdateInterval) clearInterval(blockUpdateInterval);
                    if (updateCountdownInterval) clearInterval(updateCountdownInterval);
                }
            } else {
                if (isRealTimeActive) {
                    // 恢复定时器
                    startBlockAutoUpdate();
                }
            }
        });

        // 检查登录状态
        function checkAuthStatus() {
            const isLoggedIn = localStorage.getItem('ethersent_logged_in') || 
                              sessionStorage.getItem('ethersent_logged_in');
            
            if (isLoggedIn !== 'true') {
                window.location.href = 'auth.html';
                return;
            }
        }

        // 用户菜单切换
        function toggleUserMenu() {
            // 简单的登出功能
            if (confirm('确定要退出登录吗？')) {
                localStorage.removeItem('ethersent_logged_in');
                localStorage.removeItem('ethersent_username');
                sessionStorage.removeItem('ethersent_logged_in');
                sessionStorage.removeItem('ethersent_username');
                window.location.href = 'auth.html';
            }
        }

        // 功能模块切换
        function showSection(sectionName) {
            console.log('=== showSection 被调用 ===');
            console.log('参数 sectionName:', sectionName);
            
            // 定义导航ID映射
            const navIdMap = {
                'address': 'nav-address',
                'transaction': 'nav-transaction', 
                'code': 'nav-generate',
                'data': 'nav-realtime'
            };
            
            // 移除所有活跃状态
            document.querySelectorAll('.function-nav-item').forEach(item => {
                item.classList.remove('active');
                console.log('移除激活状态:', item.id);
            });
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
                console.log('隐藏内容区域:', section.id);
            });
            
            // 添加当前活跃状态
            const navId = navIdMap[sectionName];
            const contentId = sectionName + '-section';
            
            console.log('映射的导航ID:', navId);
            console.log('内容区域ID:', contentId);
            
            const navElement = document.getElementById(navId);
            const contentElement = document.getElementById(contentId);
            
            if (navElement) {
                navElement.classList.add('active');
                console.log('激活导航项:', navId);
            } else {
                console.error('未找到导航元素:', navId);
            }
            
            if (contentElement) {
                contentElement.classList.add('active');
                console.log('显示内容区域:', contentId);
            } else {
                console.error('未找到内容元素:', contentId);
            }
        }

        // 测试导航元素是否存在
        function testNavigationElements() {
            console.log('=== 导航元素诊断 ===');
            
            const expectedNavElements = ['nav-address', 'nav-transaction', 'nav-generate', 'nav-realtime'];
            const expectedContentElements = ['address-section', 'transaction-section', 'code-section', 'data-section'];
            
            console.log('检查导航元素:');
            expectedNavElements.forEach(id => {
                const element = document.getElementById(id);
                console.log(`- ${id}:`, element ? '✓ 存在' : '✗ 不存在');
            });
            
            console.log('检查内容元素:');
            expectedContentElements.forEach(id => {
                const element = document.getElementById(id);
                console.log(`- ${id}:`, element ? '✓ 存在' : '✗ 不存在');
            });
            
            // 检查当前激活状态
            const activeNav = document.querySelector('.function-nav-item.active');
            const activeContent = document.querySelector('.content-section.active');
            console.log('当前激活的导航:', activeNav ? activeNav.id : '无');
            console.log('当前激活的内容:', activeContent ? activeContent.id : '无');
        }

        // 初始化导航状态
        function initializeNavigationState() {
            console.log('=== 初始化导航状态 ===');
            
            // 确保默认显示交易甄别页面
            const defaultNav = document.getElementById('nav-transaction');
            const defaultContent = document.getElementById('transaction-section');
            
            if (defaultNav && defaultContent) {
                // 清除所有激活状态
                document.querySelectorAll('.function-nav-item').forEach(item => item.classList.remove('active'));
                document.querySelectorAll('.content-section').forEach(section => section.classList.remove('active'));
                
                // 设置默认激活状态
                defaultNav.classList.add('active');
                defaultContent.classList.add('active');
                
                console.log('设置默认状态: 交易甄别');
            } else {
                console.error('无法找到默认元素');
            }
        }

        // 动态数据更新系统
        function initDynamicDataUpdate() {
            // 初始数据
            const baseData = {
                totalScans: 48527,
                threatsBlocked: 1847,
                activeMonitors: 12,
                systemUptime: 99.8
            };
            
            // 每15秒更新一次数据
            setInterval(() => {
                updateDashboardData(baseData);
            }, 15000);
            
            // 页面加载2秒后开始第一次更新
            setTimeout(() => {
                updateDashboardData(baseData);
            }, 2000);
        }
        
        // 更新控制台数据
        function updateDashboardData(baseData) {
            // 生成小幅度的随机变化
            const totalScansVariation = Math.floor(Math.random() * 15) + 1; // 1-15
            const threatsVariation = Math.floor(Math.random() * 3) + 1; // 1-3
            const monitorsVariation = Math.random() > 0.8 ? (Math.random() > 0.5 ? 1 : -1) : 0; // 20%几率变化±1
            const uptimeVariation = (Math.random() * 0.2 - 0.1); // ±0.1%
            
            // 计算新数值
            const newTotalScans = baseData.totalScans + totalScansVariation;
            const newThreatsBlocked = baseData.threatsBlocked + threatsVariation;
            const newActiveMonitors = Math.max(10, Math.min(15, baseData.activeMonitors + monitorsVariation));
            const newSystemUptime = Math.max(99.5, Math.min(99.9, baseData.systemUptime + uptimeVariation));
            
            // 更新DOM
            animateValueChange('totalScans', newTotalScans.toLocaleString());
            animateValueChange('threatsBlocked', newThreatsBlocked.toLocaleString());
            animateValueChange('activeMonitors', newActiveMonitors.toString());
            animateValueChange('systemUptime', newSystemUptime.toFixed(1) + '%');
            
            // 更新趋势百分比
            updateTrendPercentages();
            
            // 更新基础数据
            baseData.totalScans = newTotalScans;
            baseData.threatsBlocked = newThreatsBlocked;
            baseData.activeMonitors = newActiveMonitors;
            baseData.systemUptime = newSystemUptime;
        }
        
        // 数值变化动画
        function animateValueChange(elementId, newValue) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            // 添加更新动画效果
            element.style.transform = 'scale(1.05)';
            element.style.color = 'var(--neon-cyan)';
            element.style.transition = 'all 0.3s ease';
            
            setTimeout(() => {
                element.textContent = newValue;
                element.style.transform = 'scale(1)';
                element.style.color = '';
            }, 150);
        }
        
        // 更新趋势百分比
        function updateTrendPercentages() {
            const trends = [
                { selector: '.status-card:nth-child(1) .status-trend', values: ['+2.8%', '+3.1%', '+3.4%', '+3.6%'], colors: ['var(--blockchain-green)'] },
                { selector: '.status-card:nth-child(2) .status-trend', values: ['+1.8%', '+2.1%', '+2.3%', '+2.5%'], colors: ['#f59e0b'] },
                { selector: '.status-card:nth-child(4) .status-trend', values: ['29天', '30天', '31天'], colors: ['var(--blockchain-green)'] }
            ];
            
            trends.forEach(trend => {
                const element = document.querySelector(trend.selector);
                if (element && trend.values.length > 0) {
                    const randomValue = trend.values[Math.floor(Math.random() * trend.values.length)];
                    const textContent = element.textContent;
                    
                    // 只更新数值部分，保留图标
                    if (textContent.includes('+') || textContent.includes('天')) {
                        const icon = element.querySelector('i');
                        const iconClass = icon ? icon.className : '';
                        const newContent = textContent.replace(/[\d.]+[%天]?/, randomValue.replace(/[+-]/, ''));
                        element.innerHTML = `<i class="${iconClass}"></i> ${randomValue}`;
                    }
                }
            });
        }

        // 初始化事件监听器
        function initializeEventListeners() {
            // 功能模块切换（备用方案）
            document.querySelectorAll('.function-nav-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('备用事件监听器被触发:', this.id);
                    
                    const sectionName = this.getAttribute('data-section');
                    if (sectionName) {
                        showSection(sectionName);
                    }
                });
            });

            // 交易分析
            document.getElementById('analyzeTx').addEventListener('click', analyzeTransaction);
            
            // 地址检测
            document.getElementById('analyzeAddress').addEventListener('click', analyzeAddress);
            
            // 代码生成
            document.getElementById('generateCode').addEventListener('click', generateCode);
            
            // 实时数据
            document.getElementById('getRealTimeData').addEventListener('click', getRealTimeData);
            document.getElementById('updateData').addEventListener('click', updateRealTimeData);
            document.getElementById('stopAutoUpdate').addEventListener('click', function() {
                stopBlockAutoUpdate();
                
                // 更新按钮显示状态
                document.getElementById('getRealTimeData').style.display = 'inline-block';
                document.getElementById('updateData').style.display = 'none';
                document.getElementById('stopAutoUpdate').style.display = 'none';
            });
        }



        // 验证以太坊交易哈希格式
        function isValidEthereumTxHash(hash) {
            // 检查是否以0x开头且总长度为66字符
            if (!hash || hash.length !== 66) {
                return false;
            }
            
            // 检查是否以0x开头
            if (!hash.startsWith('0x')) {
                return false;
            }
            
            // 检查后64位是否为十六进制字符
            const hexPart = hash.slice(2);
            return /^[0-9a-fA-F]{64}$/.test(hexPart);
        }

        // 交易分析功能
        function analyzeTransaction() {
            const txHash = document.getElementById('txHash').value.trim();
            const button = document.getElementById('analyzeTx');
            const resultDiv = document.getElementById('txResult');
            
            // 检查是否输入了交易哈希
            if (!txHash) {
                alert('请输入有效的以太坊交易哈希');
                return;
            }

            // 严格验证交易哈希格式
            if (!isValidEthereumTxHash(txHash)) {
                alert('输入交易哈希格式有误！\n\n正确格式要求：\n• 以 0x 开头\n• 后跟64个十六进制字符 (0-9, a-f)\n• 总长度为66个字符\n\n请检查输入并重试。');
                return;
            }
            
            // 重置和清理之前的分析结果
            resetTransactionAnalysisState();
            
            // 更新按钮状态并显示进度条
            button.disabled = true;
            showTransactionProgress(button);
            
            // 显示结果卡片
            resultDiv.style.display = 'block';
            
            // 设置当前交易信息
            setTimeout(() => {
                // 显示到结果页面
                document.getElementById('tx-hash-display').textContent = txHash;
            
            // 更新时间戳
            const now = new Date();
            const timeString = now.toLocaleString('en-US', {
                month: 'short',
                day: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true,
                timeZone: 'UTC'
            }) + ' UTC';
            document.getElementById('tx-timestamp').textContent = `2 mins ago (${timeString})`;
            }, 50);
            
            // 分阶段显示分析过程
            setTimeout(() => {
                // 第一阶段：显示网络图动画
                resetTransactionGraph();
                updateProgressButton(button, '构建交易网络图...', 25);
                animateTransactionGraph();
            }, 300);
            
            setTimeout(() => {
                // 第二阶段：模拟风险检测
                updateProgressButton(button, '执行风险检测...', 50);
            }, 800);
            
            setTimeout(() => {
                // 第三阶段：分析交易模式
                updateProgressButton(button, '分析交易模式...', 75);
            }, 1200);
            
            setTimeout(() => {
                // 第四阶段：生成分析报告
                updateProgressButton(button, '生成分析报告...', 90);
                
                    setTimeout(() => {
                    updateProgressButton(button, '分析完成', 100);
                    // 更新交易状态为成功
                    document.getElementById('tx-status-badge').className = 'badge bg-success';
                    document.getElementById('tx-status-badge').textContent = 'Success (安全)';
                    // 显示预设结果并重置按钮
                        showPresetTransactionAnalysisResults(txHash);
                    resetButton(button, '<i class="bi bi-search me-2"></i>预测交易甄别');
                }, 400);
            }, 1600);
        }

        // 显示交易分析进度
        function showTransactionProgress(button) {
            const progressHtml = `
                <div class="d-flex align-items-center">
                    <div class="progress me-3" style="width: 120px; height: 6px;">
                        <div class="progress-bar bg-info" role="progressbar" style="width: 0%" id="tx-progress-bar"></div>
                    </div>
                    <span id="tx-progress-text">初始化检测...</span>
                </div>
            `;
            button.innerHTML = progressHtml;
        }

        // 更新进度按钮
        function updateProgressButton(button, text, progress) {
            const progressBar = document.getElementById('tx-progress-bar');
            const progressText = document.getElementById('tx-progress-text');
            
            if (progressBar && progressText) {
                progressBar.style.width = progress + '%';
                progressText.textContent = text;
                
                // 进度条颜色变化
                if (progress < 30) {
                    progressBar.className = 'progress-bar bg-info';
                } else if (progress < 70) {
                    progressBar.className = 'progress-bar bg-warning';
                } else if (progress < 100) {
                    progressBar.className = 'progress-bar bg-primary';
                } else {
                    progressBar.className = 'progress-bar bg-success';
                }
            }
        }

        // 重置按钮状态
        function resetButton(button, originalContent) {
            setTimeout(() => {
                button.disabled = false;
                button.innerHTML = originalContent;
            }, 500);
        }

        // 重置交易分析状态
        function resetTransactionAnalysisState() {
            // 重置交易状态徽章
            const statusBadge = document.getElementById('tx-status-badge');
            if (statusBadge) {
                statusBadge.className = 'badge bg-secondary';
                statusBadge.textContent = '等待分析';
            }
            
            // 重置网络图中的风险节点标记
            document.querySelectorAll('.risk-node').forEach(node => {
                node.classList.remove('risk-node');
                const circle = node.querySelector('circle');
                if (circle) {
                    // 重置为默认颜色
                    if (node.id === 'node-0' || node.id === 'node-1') {
                        circle.setAttribute('fill', '#2c3e50');
                        circle.setAttribute('filter', '');
                    } else if (node.id === 'node-2') {
                        circle.setAttribute('fill', '#00ffcc');
                        circle.setAttribute('filter', 'drop-shadow(0 0 8px rgba(0, 255, 204, 0.6))');
                    } else {
                        circle.setAttribute('fill', '#2c3e50');
                        circle.setAttribute('filter', '');
                    }
                }
            });
            
            // 清空风险分析面板并显示加载状态
            const riskPanel = document.querySelector('#txRisks');
            if (riskPanel) {
                riskPanel.style.opacity = '0.3';
                riskPanel.innerHTML = `
                    <h6 style="color: #94a3b8; margin-bottom: 0.8rem; text-align: center; font-weight: 600; font-family: 'Orbitron', monospace;">智能风险分析</h6>
                    <div class="text-center py-5">
                        <div class="spinner-border text-info mb-3" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <div style="color: #94a3b8; font-size: 0.85rem;">正在分析交易风险...</div>
                    </div>
                `;
            }
            
            // 重置安全建议面板
            const recommendationPanel = document.querySelector('#txResult .risk-recommendation');
            if (recommendationPanel) {
                const content = recommendationPanel.querySelector('.recommendation-content');
                if (content) {
                    content.innerHTML = `
                        <div class="text-center">
                            <div class="spinner-border spinner-border-sm text-primary mb-2" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <div style="font-size: 0.7rem; color: #94a3b8;">生成安全建议中...</div>
                        </div>
                    `;
                }
            }
        }

        // 隐藏交易分析结果
        function hideTransactionAnalysisResults() {
            const riskPanel = document.querySelector('#txRisks');
            if (riskPanel) {
                riskPanel.style.opacity = '0.3';
                riskPanel.innerHTML = `
                    <h6 style="color: #94a3b8; margin-bottom: 0.8rem; text-align: center; font-weight: 600; font-family: 'Orbitron', monospace;">智能风险分析</h6>
                    <div class="text-center py-5">
                        <div class="spinner-border text-info mb-3" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p style="color: #94a3b8;">正在分析交易风险...</p>
                        <p style="color: #64748b; font-size: 0.85rem;">请稍候...</p>
                    </div>
                `;
            }
            
            // 清空安全建议内容
            const recommendationPanel = document.getElementById('risk-recommendation');
            if (recommendationPanel) {
                recommendationPanel.innerHTML = '';
                recommendationPanel.style.opacity = '0';
            }
        }

        // 生成随机地址格式
        function generateRandomAddress() {
            const chars = '0123456789ABCDEF';
            let address = '0x';
            for (let i = 0; i < 8; i++) {
                address += chars[Math.floor(Math.random() * chars.length)];
            }
            address += '...';
            for (let i = 0; i < 8; i++) {
                address += chars[Math.floor(Math.random() * chars.length)];
            }
            return address;
        }

        // 生成交易风险数据
        function generateTransactionRiskData(txHash) {
            const hashUpper = txHash.toUpperCase();
            const prefix = hashUpper.substring(0, 4); // 获取前两位16进制数字
            
            // 0x28开头 - 钓鱼活动风险
            if (prefix === '0X28') {
                return {
                    risks: ['钓鱼活动'],
                    riskLevel: '中风险',
                    riskColor: 'warning',
                    riskNodes: ['node-7'],
                    nodeCount: 15,
                    graphStructure: 'phishing',
                    transactionInfo: {
                        blockNumber: '19819192',
                        timestamp: 'May 07 2024 03:50:23 PM +UTC',
                        status: 'Success',
                        statusClass: 'bg-success',
                        from: generateRandomAddress(),
                        fromLabel: generateRandomAddress(),
                        to: generateRandomAddress(),
                        toLabel: generateRandomAddress(),
                        value: '0',
                        transactionFee: '4800000',
                        gasPrice: '23778934265',
                        method: 'Transfer',
                        network: 'Ethereum Mainnet'
                    }
                };
            }
            
            // 0xAC开头 - 无风险
            if (prefix === '0XAC') {
                return {
                    risks: [],
                    riskLevel: '安全',
                    riskColor: 'success',
                    riskNodes: [],
                    nodeCount: 9,
                    graphStructure: 'safe',
                    transactionInfo: {
                        blockNumber: '19856432',
                        timestamp: 'Jun 15 2024 14:23:18 PM +UTC',
                        status: 'Success',
                        statusClass: 'bg-success',
                        from: generateRandomAddress(),
                        fromLabel: generateRandomAddress(),
                        to: generateRandomAddress(),
                        toLabel: generateRandomAddress(),
                        value: '1.25 ETH',
                        transactionFee: '0.002145 ETH',
                        gasPrice: '15.234567890 Gwei',
                        method: 'Transfer',
                        network: 'Ethereum Mainnet'
                    }
                };
            }
            
            // 0x16开头 - 黑名单地址相关、盗窃活动风险
            if (prefix === '0X16') {
                return {
                    risks: ['黑名单地址相关', '资金盗窃活动'],
                    riskLevel: '高风险',
                    riskColor: 'danger',
                    riskNodes: ['node-1', 'node-5', 'node-8', 'node-11'],
                    nodeCount: 12,
                    graphStructure: 'blacklist',
                    transactionInfo: {
                        blockNumber: '19847329',
                        timestamp: 'Jun 23 2024 10:42:18 AM UTC',
                        status: 'Failed (高风险交易)',
                        statusClass: 'bg-danger',
                        from: generateRandomAddress(),
                        fromLabel: '黑名单地址 (BLACKLISTED)',
                        to: generateRandomAddress(),
                        toLabel: '受害者地址',
                        value: '5.67 ETH (被盗资金)',
                        transactionFee: '0.000234567 ETH',
                        gasPrice: '12.345678901 Gwei',
                        method: 'stolenTransfer',
                        network: 'Ethereum Mainnet'
                    }
                };
            }

            // 0x3F开头 - 恶意合约交互
            if (prefix === '0X3F') {
                return {
                    risks: ['恶意合约交互'],
                    riskLevel: '高风险',
                    riskColor: 'danger',
                    riskNodes: ['node-3', 'node-6'],
                    nodeCount: 8,
                    graphStructure: 'malicious',
                    transactionInfo: {
                        blockNumber: '19823456',
                        timestamp: 'May 12 2024 08:30:15 AM +UTC',
                        status: 'Failed (恶意合约)',
                        statusClass: 'bg-danger',
                        from: generateRandomAddress(),
                        fromLabel: generateRandomAddress(),
                        to: generateRandomAddress(),
                        toLabel: '恶意合约地址',
                        value: '2.34 ETH',
                        transactionFee: '0.003456 ETH',
                        gasPrice: '20.123456789 Gwei',
                        method: 'maliciousCall',
                        network: 'Ethereum Mainnet'
                    }
                };
            }

            // 0x7B开头 - 智能合约漏洞
            if (prefix === '0X7B') {
                return {
                    risks: ['智能合约漏洞'],
                    riskLevel: '中风险',
                    riskColor: 'warning',
                    riskNodes: ['node-4'],
                    nodeCount: 10,
                    graphStructure: 'vulnerability',
                    transactionInfo: {
                        blockNumber: '19834567',
                        timestamp: 'May 18 2024 15:45:30 PM +UTC',
                        status: 'Success (存在漏洞)',
                        statusClass: 'bg-warning',
                        from: generateRandomAddress(),
                        fromLabel: generateRandomAddress(),
                        to: generateRandomAddress(),
                        toLabel: '漏洞合约地址',
                        value: '0.88 ETH',
                        transactionFee: '0.001876 ETH',
                        gasPrice: '16.789012345 Gwei',
                        method: 'vulnerableCall',
                        network: 'Ethereum Mainnet'
                    }
                };
            }

            // 0xE2开头 - 钓鱼活动 + 恶意合约交互 (复合风险)
            if (prefix === '0XE2') {
                return {
                    risks: ['钓鱼活动', '恶意合约交互'],
                    riskLevel: '高风险',
                    riskColor: 'danger',
                    riskNodes: ['node-2', 'node-5', 'node-7'],
                    nodeCount: 11,
                    graphStructure: 'compound',
                    transactionInfo: {
                        blockNumber: '19845678',
                        timestamp: 'Jun 25 2024 12:20:45 PM +UTC',
                        status: 'Failed (复合攻击)',
                        statusClass: 'bg-danger',
                        from: generateRandomAddress(),
                        fromLabel: '钓鱼者地址 (PHISHING)',
                        to: generateRandomAddress(),
                        toLabel: '恶意合约地址',
                        value: '3.21 ETH (被骗资金)',
                        transactionFee: '0.004567 ETH',
                        gasPrice: '25.456789012 Gwei',
                        method: 'phishingContract',
                        network: 'Ethereum Mainnet'
                    }
                };
            }

            // 0xB9开头 - 黑名单地址相关 + 智能合约漏洞
            if (prefix === '0XB9') {
                return {
                    risks: ['黑名单地址相关', '智能合约漏洞'],
                    riskLevel: '高风险',
                    riskColor: 'danger',
                    riskNodes: ['node-1', 'node-3', 'node-6'],
                    nodeCount: 13,
                    graphStructure: 'blacklist_vulnerable',
                    transactionInfo: {
                        blockNumber: '19851234',
                        timestamp: 'Jun 28 2024 18:10:20 PM +UTC',
                        status: 'Failed (黑名单+漏洞)',
                        statusClass: 'bg-danger',
                        from: generateRandomAddress(),
                        fromLabel: '黑名单地址 (BLACKLISTED)',
                        to: generateRandomAddress(),
                        toLabel: '漏洞合约地址',
                        value: '4.56 ETH',
                        transactionFee: '0.002345 ETH',
                        gasPrice: '18.345678901 Gwei',
                        method: 'exploitContract',
                        network: 'Ethereum Mainnet'
                    }
                };
            }
            
            // 大额代币转移: 0x246cf33c697a38ac41ffee4f35e9dc24266151c0944e47a92350125791242e47
            if (hashUpper === '0X246CF33C697A38AC41FFEE4F35E9DC24266151C0944E47A92350125791242E47') {
                return {
                    risks: [],
                    riskLevel: '安全',
                    riskColor: 'success',
                    riskNodes: [],
                    graphStructure: 'normal',
                    transactionInfo: {
                        blockNumber: '19847892',
                        timestamp: '1天前 (Jun 25, 2025, 02:15:44 PM UTC)',
                        status: 'Success (安全)',
                        statusClass: 'bg-success',
                        from: '0x514910771af9ca656af840dff83e8264ecf986ca',
                        fromLabel: 'Chainlink Token (LINK)',
                        to: '0x47ac0fb4f2d84898e4d9e7b4dab3c24507a6d503',
                        toLabel: '机构投资者地址',
                        value: '125,000 LINK ($2,375,000)',
                        transactionFee: '0.00156789 ETH ($6.10)',
                        gasPrice: '8.234567890 Gwei',
                        method: 'transfer',
                        network: 'Ethereum Mainnet'
                    }
                };
            }
            
            // DeFi协议交互: 0xac2b944238e83b4b6211379b326d36e761922312384a631628d09a25b7a08b5e
            if (hashUpper === '0XAC2B944238E83B4B6211379B326D36E761922312384A631628D09A25B7A08B5E') {
                return {
                    risks: [],
                    riskLevel: '安全',
                    riskColor: 'success',
                    riskNodes: [],
                    graphStructure: 'defi',
                    transactionInfo: {
                        blockNumber: '19848156',
                        timestamp: '6小时前 (Jun 26, 2025, 09:33:21 AM UTC)',
                        status: 'Success (安全)',
                        statusClass: 'bg-success',
                        from: '0x7a250d5630b4cf539739df2c5dacb4c659f2488d',
                        fromLabel: 'Uniswap V2: Router 2',
                        to: '0xa0b86a33e6776d4b5b2bcf5c0bc15b0a6537b2c3',
                        toLabel: '0x150bCF49Ee8E2Bd9f59e991821DE5B74C6D876aA',
                        value: '2.5 ETH → 4,892.35 USDC',
                        transactionFee: '0.00298765 ETH ($11.63)',
                        gasPrice: '15.678901234 Gwei',
                        method: 'swapExactETHForTokens',
                        network: 'Ethereum Mainnet'
                    }
                };
            }
            
            // 默认情况：其他交易显示为安全，节点数在5-10之间随机
            const randomNodeCount = Math.floor(Math.random() * 6) + 5; // 5-10个节点
            return {
                risks: [],
                riskLevel: '安全',
                riskColor: 'success',
                riskNodes: [],
                nodeCount: randomNodeCount,
                graphStructure: 'default',
                transactionInfo: {
                    blockNumber: '19856789',
                    timestamp: 'Jun 20 2024 16:15:42 PM +UTC',
                    status: 'Success',
                    statusClass: 'bg-success',
                    from: '0xA1B2C3...D4E5F6',
                    fromLabel: '0xA1B2C3...D4E5F6',
                    to: '0x789ABC...DEF012',
                    toLabel: '0x789ABC...DEF012',
                    value: '0.5 ETH',
                    transactionFee: '0.001234 ETH',
                    gasPrice: '18.567890123 Gwei',
                    method: 'Transfer',
                    network: 'Ethereum Mainnet'
                }
            };
        }

        // 显示交易分析结果
        function showPresetTransactionAnalysisResults(txHash) {
            const riskPanel = document.querySelector('#txRisks');
            if (!riskPanel) return;
            
            // 获取交易数据
            const transactionData = generateTransactionRiskData(txHash);
            const isRisky = transactionData.risks && transactionData.risks.length > 0;
            const riskScore = transactionData.riskLevel === '高风险' ? 25 : 
                             transactionData.riskLevel === '中风险' ? 55 : 85;
            
            // 更新交易详细信息
            updateTransactionDetails(transactionData.transactionInfo);
            
            // 动态生成交易图
            updateTransactionGraph(transactionData);
            
            // 风险节点已在动态图生成时处理，这里不需要额外标记
            
            riskPanel.style.opacity = '1';
            
            // 显示风险分析结果
            riskPanel.innerHTML = `
                    <h6 style="color: #94a3b8; margin-bottom: 0.8rem; text-align: center; font-weight: 600; font-family: 'Orbitron', monospace;">智能风险分析</h6>
                    <div class="risk-content-wrapper">
                        <!-- 风险评估概览 -->
                        <div class="risk-overview-panel">
                            <div class="risk-score-display">
                                <div class="score-circle ${isRisky ? 'danger' : ''}">
                                    <span class="score-value">${riskScore}</span>
                                    <span class="score-label">${isRisky ? '风险分' : '安全分'}</span>
                                </div>
                                <div class="score-description">
                                    <div class="score-status ${isRisky ? 'danger' : ''}">${transactionData.riskLevel}交易</div>
                                    <div class="score-subtitle">基于5项安全指标分析</div>
                                </div>
                            </div>
                        </div>

                        <!-- 风险检测详情 -->
                        <div class="risk-details-section">
                            <div class="section-header">
                                <i class="bi bi-shield-${isRisky ? 'exclamation' : 'check'}-fill"></i>
                                <span>安全检测项目</span>
                            </div>
                            
                            <div class="risk-item-grid">
                                ${generateRiskCheckItems(transactionData.risks)}
                            </div>
                        </div>
                    </div>
                `;
                
                // 延时显示安全建议
                setTimeout(() => {
                    const recommendationPanel = document.getElementById('risk-recommendation');
                    if (recommendationPanel) {
                        recommendationPanel.style.opacity = '0';
                        recommendationPanel.style.transition = 'opacity 0.5s ease-in-out';
                        
                                                if (transactionData.riskLevel === '高风险') {
                            let riskDescription = '';
                            if (transactionData.risks.includes('黑名单地址相关') && transactionData.risks.includes('资金盗窃活动')) {
                                riskDescription = `
                                <p>⚠️ 检测到高风险交易，建议立即停止执行</p>
                                    <p>🚨 该交易涉及黑名单地址和资金盗窃活动</p>
                                    <p>📞 请立即联系安全团队进行紧急处理</p>
                                `;
                            } else if (transactionData.risks.includes('钓鱼活动') && transactionData.risks.includes('恶意合约交互')) {
                                riskDescription = `
                                    <p>⚠️ 检测到高风险交易，建议立即停止执行</p>
                                    <p>🚨 该交易涉及钓鱼活动和恶意合约复合攻击</p>
                                    <p>📞 请立即联系安全团队进行处理</p>
                                `;
                            } else if (transactionData.risks.includes('黑名单地址相关') && transactionData.risks.includes('智能合约漏洞')) {
                                riskDescription = `
                                    <p>⚠️ 检测到高风险交易，建议立即停止执行</p>
                                    <p>🚨 该交易涉及黑名单地址和合约漏洞利用</p>
                                    <p>📞 请立即联系安全团队进行处理</p>
                                `;
                            } else if (transactionData.risks.includes('恶意合约交互')) {
                                riskDescription = `
                                    <p>⚠️ 检测到高风险交易，建议立即停止执行</p>
                                    <p>🚨 该交易涉及恶意合约交互</p>
                                    <p>📞 请联系安全团队进行审核</p>
                                `;
                            } else {
                                riskDescription = `
                                    <p>⚠️ 检测到高风险交易，建议立即停止执行</p>
                                    <p>🚨 该交易存在多项安全风险</p>
                                <p>📞 如有疑问，请联系安全团队进行人工审核</p>
                            `;
                            }
                            recommendationPanel.innerHTML = riskDescription;
                        } else if (transactionData.riskLevel === '中风险') {
                            let riskDescription = '';
                            if (transactionData.risks.includes('钓鱼活动')) {
                                riskDescription = `
                                    <p>⚠️ 检测到中等风险，建议谨慎处理</p>
                                    <p>🔍 该交易存在钓鱼活动风险点</p>
                                    <p>💡 建议进一步验证交易对手身份后再执行</p>
                                `;
                            } else if (transactionData.risks.includes('智能合约漏洞')) {
                                riskDescription = `
                                    <p>⚠️ 检测到中等风险，建议谨慎处理</p>
                                    <p>🔍 该交易涉及的合约存在已知漏洞</p>
                                    <p>💡 建议使用更安全的合约版本或等待修复</p>
                                `;
                            } else {
                                riskDescription = `
                                    <p>⚠️ 检测到中等风险，建议谨慎处理</p>
                                    <p>🔍 该交易存在一定的安全风险</p>
                                    <p>💡 建议进一步验证后再执行</p>
                                `;
                            }
                            recommendationPanel.innerHTML = riskDescription;
                        } else {
                            recommendationPanel.innerHTML = `
                                <p>✅ 该交易通过所有安全检测，可以放心执行</p>
                                <p>💡 建议持续关注交易对手的历史行为</p>
                            `;
                        }
                        
                        setTimeout(() => {
                            recommendationPanel.style.opacity = '1';
                        }, 50);
                    }
                }, 800);
        }

        // 动态更新交易图
        function updateTransactionGraph(transactionData) {
            const svg = document.getElementById('transaction-graph');
            if (!svg) return;

            const nodeCount = transactionData.nodeCount || 11; // 默认11个节点
            const graphType = transactionData.graphStructure || 'default';
            
            // 清空现有的图
            const edgesGroup = svg.querySelector('#graph-edges');
            const nodesGroup = svg.querySelector('#graph-nodes');
            
            if (edgesGroup) edgesGroup.innerHTML = '';
            if (nodesGroup) nodesGroup.innerHTML = '';
            
            // 根据不同类型生成图形
            if (graphType === 'phishing') {
                generatePhishingGraph(nodeCount, edgesGroup, nodesGroup);
            } else if (graphType === 'safe') {
                generateSafeGraph(nodeCount, edgesGroup, nodesGroup);
            } else if (graphType === 'blacklist') {
                generateBlacklistGraph(nodeCount, edgesGroup, nodesGroup);
            } else if (graphType === 'malicious') {
                generateMaliciousGraph(nodeCount, edgesGroup, nodesGroup);
            } else if (graphType === 'vulnerability') {
                generateVulnerabilityGraph(nodeCount, edgesGroup, nodesGroup);
            } else if (graphType === 'compound') {
                generateCompoundGraph(nodeCount, edgesGroup, nodesGroup);
            } else if (graphType === 'blacklist_vulnerable') {
                generateBlacklistVulnerableGraph(nodeCount, edgesGroup, nodesGroup);
            } else {
                generateDefaultGraph(nodeCount, edgesGroup, nodesGroup);
            }
        }

        // 生成钓鱼活动图形 (15个节点，避免线条交叉)
        function generatePhishingGraph(nodeCount, edgesGroup, nodesGroup) {
            const positions = [
                {x: 250, y: 140, label: 'TX', type: 'center'},     // 0: 中心交易节点
                {x: 120, y: 80, label: '发送方', type: 'sender'},   // 1: 发送方
                {x: 380, y: 200, label: '接收方', type: 'receiver'}, // 2: 接收方
                {x: 60, y: 50, label: 'A', type: 'normal'},        // 3: 左上分支
                {x: 80, y: 120, label: 'B', type: 'normal'},       // 4: 左侧分支
                {x: 50, y: 180, label: 'C', type: 'normal'},       // 5: 左下分支
                {x: 170, y: 40, label: 'D', type: 'normal'},       // 6: 上部分支
                {x: 320, y: 60, label: 'E', type: 'phishing'},     // 7: 钓鱼节点 - 右上
                {x: 450, y: 120, label: 'F', type: 'normal'},      // 8: 右侧分支
                {x: 420, y: 260, label: 'G', type: 'normal'},      // 9: 右下分支
                {x: 300, y: 270, label: 'H', type: 'normal'},      // 10: 下部分支
                {x: 200, y: 260, label: 'I', type: 'normal'},      // 11: 下部分支
                {x: 150, y: 200, label: 'J', type: 'normal'},      // 12: 左下分支
                {x: 350, y: 30, label: 'K', type: 'normal'},       // 13: 右上分支
                {x: 480, y: 180, label: 'L', type: 'normal'}       // 14: 最右分支
            ];

            // 生成连接线 (放射状结构，避免交叉)
            const edges = [
                {from: 0, to: 1}, {from: 0, to: 2},               // 中心连接
                {from: 1, to: 3}, {from: 1, to: 4}, {from: 1, to: 5}, {from: 1, to: 6}, // 发送方分支
                {from: 2, to: 7}, {from: 2, to: 8}, {from: 2, to: 9},                   // 接收方分支
                {from: 7, to: 13},                                 // 钓鱼节点分支
                {from: 2, to: 10}, {from: 10, to: 11}, {from: 1, to: 12},              // 下部分支
                {from: 8, to: 14}                                  // 右侧扩展
            ];

            // 绘制边
            edges.forEach((edge, index) => {
                const fromPos = positions[edge.from];
                const toPos = positions[edge.to];
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('id', `edge-${index}`);
                path.setAttribute('class', 'graph-edge');
                path.setAttribute('d', `M${fromPos.x},${fromPos.y} L${toPos.x},${toPos.y}`);
                path.setAttribute('stroke', '#3498db');
                path.setAttribute('stroke-width', '2');
                path.setAttribute('opacity', '0.6');
                edgesGroup.appendChild(path);
            });

            // 绘制节点
            positions.forEach((pos, index) => {
                const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                g.setAttribute('id', `node-${index}`);
                g.setAttribute('class', 'graph-node');

                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', pos.x);
                circle.setAttribute('cy', pos.y);
                circle.setAttribute('r', pos.type === 'center' ? 12 : (pos.type === 'sender' || pos.type === 'receiver' ? 16 : 10));
                circle.setAttribute('fill', pos.type === 'phishing' ? '#e74c3c' : (pos.type === 'center' ? '#f39c12' : '#3498db'));
                circle.setAttribute('stroke', 'white');
                circle.setAttribute('stroke-width', '2');
                if (pos.type === 'phishing') {
                    circle.setAttribute('filter', 'drop-shadow(0 0 8px rgba(231, 76, 60, 0.8))');
                }

                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', pos.x);
                text.setAttribute('y', pos.y);
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('dominant-baseline', 'middle');
                text.setAttribute('fill', 'white');
                text.setAttribute('font-size', '8');
                text.setAttribute('font-weight', 'bold');
                text.textContent = pos.label;

                g.appendChild(circle);
                g.appendChild(text);
                nodesGroup.appendChild(g);
            });
        }

        // 生成安全图形 (9个节点)
        function generateSafeGraph(nodeCount, edgesGroup, nodesGroup) {
            const positions = [
                {x: 250, y: 140, label: 'TX', type: 'center'},
                {x: 150, y: 80, label: '发送方', type: 'sender'},
                {x: 350, y: 200, label: '接收方', type: 'receiver'},
                {x: 100, y: 120, label: 'A', type: 'normal'},
                {x: 200, y: 60, label: 'B', type: 'normal'},
                {x: 300, y: 80, label: 'C', type: 'normal'},
                {x: 400, y: 160, label: 'D', type: 'normal'},
                {x: 320, y: 240, label: 'E', type: 'normal'},
                {x: 180, y: 220, label: 'F', type: 'normal'}
            ];

            const edges = [
                {from: 0, to: 1}, {from: 0, to: 2},
                {from: 1, to: 3}, {from: 1, to: 4},
                {from: 2, to: 5}, {from: 2, to: 6},
                {from: 2, to: 7}, {from: 1, to: 8}
            ];

            // 绘制边
            edges.forEach((edge, index) => {
                const fromPos = positions[edge.from];
                const toPos = positions[edge.to];
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('id', `edge-${index}`);
                path.setAttribute('class', 'graph-edge');
                path.setAttribute('d', `M${fromPos.x},${fromPos.y} L${toPos.x},${toPos.y}`);
                path.setAttribute('stroke', '#27ae60');
                path.setAttribute('stroke-width', '2');
                path.setAttribute('opacity', '0.7');
                edgesGroup.appendChild(path);
            });

            // 绘制节点
            positions.forEach((pos, index) => {
                const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                g.setAttribute('id', `node-${index}`);
                g.setAttribute('class', 'graph-node');

                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', pos.x);
                circle.setAttribute('cy', pos.y);
                circle.setAttribute('r', pos.type === 'center' ? 12 : (pos.type === 'sender' || pos.type === 'receiver' ? 16 : 10));
                circle.setAttribute('fill', pos.type === 'center' ? '#f39c12' : '#27ae60');
                circle.setAttribute('stroke', 'white');
                circle.setAttribute('stroke-width', '2');

                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', pos.x);
                text.setAttribute('y', pos.y);
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('dominant-baseline', 'middle');
                text.setAttribute('fill', 'white');
                text.setAttribute('font-size', '8');
                text.setAttribute('font-weight', 'bold');
                text.textContent = pos.label;

                g.appendChild(circle);
                g.appendChild(text);
                nodesGroup.appendChild(g);
            });
        }

        // 生成黑名单图形 (12个节点)
        function generateBlacklistGraph(nodeCount, edgesGroup, nodesGroup) {
            const positions = [
                {x: 250, y: 140, label: 'TX', type: 'center'},
                {x: 150, y: 80, label: '黑名单', type: 'blacklist'},
                {x: 350, y: 200, label: '受害者', type: 'victim'},
                {x: 80, y: 60, label: 'A', type: 'normal'},
                {x: 120, y: 120, label: 'B', type: 'normal'},
                {x: 200, y: 50, label: 'C', type: 'stolen'},
                {x: 300, y: 60, label: 'D', type: 'normal'},
                {x: 420, y: 160, label: 'E', type: 'normal'},
                {x: 380, y: 240, label: 'F', type: 'stolen'},
                {x: 300, y: 250, label: 'G', type: 'normal'},
                {x: 200, y: 230, label: 'H', type: 'normal'},
                {x: 100, y: 180, label: 'I', type: 'stolen'}
            ];

            const edges = [
                {from: 0, to: 1}, {from: 0, to: 2},
                {from: 1, to: 3}, {from: 1, to: 4}, {from: 1, to: 5},
                {from: 2, to: 6}, {from: 2, to: 7}, {from: 2, to: 8},
                {from: 5, to: 9}, {from: 8, to: 10}, {from: 1, to: 11}
            ];

            // 绘制边
            edges.forEach((edge, index) => {
                const fromPos = positions[edge.from];
                const toPos = positions[edge.to];
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('id', `edge-${index}`);
                path.setAttribute('class', 'graph-edge');
                path.setAttribute('d', `M${fromPos.x},${fromPos.y} L${toPos.x},${toPos.y}`);
                path.setAttribute('stroke', '#e74c3c');
                path.setAttribute('stroke-width', '2');
                path.setAttribute('opacity', '0.6');
                edgesGroup.appendChild(path);
            });

            // 绘制节点
            positions.forEach((pos, index) => {
                const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                g.setAttribute('id', `node-${index}`);
                g.setAttribute('class', 'graph-node');

                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', pos.x);
                circle.setAttribute('cy', pos.y);
                circle.setAttribute('r', pos.type === 'center' ? 12 : (pos.type === 'blacklist' || pos.type === 'victim' ? 16 : 10));
                
                let fillColor = '#3498db';
                if (pos.type === 'center') fillColor = '#f39c12';
                else if (pos.type === 'blacklist' || pos.type === 'stolen') fillColor = '#e74c3c';
                else if (pos.type === 'victim') fillColor = '#9b59b6';
                
                circle.setAttribute('fill', fillColor);
                circle.setAttribute('stroke', 'white');
                circle.setAttribute('stroke-width', '2');
                
                if (pos.type === 'blacklist' || pos.type === 'stolen') {
                    circle.setAttribute('filter', 'drop-shadow(0 0 8px rgba(231, 76, 60, 0.8))');
                }

                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', pos.x);
                text.setAttribute('y', pos.y);
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('dominant-baseline', 'middle');
                text.setAttribute('fill', 'white');
                text.setAttribute('font-size', pos.type === 'blacklist' || pos.type === 'victim' ? '7' : '8');
                text.setAttribute('font-weight', 'bold');
                text.textContent = pos.label;

                g.appendChild(circle);
                g.appendChild(text);
                nodesGroup.appendChild(g);
            });
        }

        // 生成默认图形 (5-10个节点随机)
        function generateDefaultGraph(nodeCount, edgesGroup, nodesGroup) {
            const positions = [];
            const labels = ['TX', '发送方', '接收方', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J'];
            
            // 生成随机位置
            for (let i = 0; i < nodeCount; i++) {
                let x, y, type, label;
                
                if (i === 0) {
                    x = 250; y = 140; type = 'center'; label = 'TX';
                } else if (i === 1) {
                    x = 150; y = 80; type = 'sender'; label = '发送方';
                } else if (i === 2) {
                    x = 350; y = 200; type = 'receiver'; label = '接收方';
                } else {
                    // 随机生成其他节点位置
                    x = Math.random() * 400 + 50;
                    y = Math.random() * 200 + 50;
                    type = 'normal';
                    label = labels[Math.min(i, labels.length - 1)];
                }
                
                positions.push({x, y, label, type});
            }

            // 生成树状连接
            const edges = [];
            for (let i = 1; i < nodeCount; i++) {
                const parentIndex = Math.floor(Math.random() * i);
                edges.push({from: parentIndex, to: i});
            }

            // 绘制边
            edges.forEach((edge, index) => {
                const fromPos = positions[edge.from];
                const toPos = positions[edge.to];
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('id', `edge-${index}`);
                path.setAttribute('class', 'graph-edge');
                path.setAttribute('d', `M${fromPos.x},${fromPos.y} L${toPos.x},${toPos.y}`);
                path.setAttribute('stroke', '#3498db');
                path.setAttribute('stroke-width', '2');
                path.setAttribute('opacity', '0.6');
                edgesGroup.appendChild(path);
            });

            // 绘制节点
            positions.forEach((pos, index) => {
                const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                g.setAttribute('id', `node-${index}`);
                g.setAttribute('class', 'graph-node');

                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', pos.x);
                circle.setAttribute('cy', pos.y);
                circle.setAttribute('r', pos.type === 'center' ? 12 : (pos.type === 'sender' || pos.type === 'receiver' ? 16 : 10));
                circle.setAttribute('fill', pos.type === 'center' ? '#f39c12' : '#3498db');
                circle.setAttribute('stroke', 'white');
                circle.setAttribute('stroke-width', '2');

                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', pos.x);
                text.setAttribute('y', pos.y);
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('dominant-baseline', 'middle');
                text.setAttribute('fill', 'white');
                text.setAttribute('font-size', '8');
                text.setAttribute('font-weight', 'bold');
                text.textContent = pos.label;

                g.appendChild(circle);
                g.appendChild(text);
                nodesGroup.appendChild(g);
            });
        }

        // 生成恶意合约图形 (8个节点)
        function generateMaliciousGraph(nodeCount, edgesGroup, nodesGroup) {
            const positions = [
                {x: 250, y: 140, label: 'TX', type: 'center'},
                {x: 150, y: 80, label: '发送方', type: 'sender'},
                {x: 350, y: 200, label: '接收方', type: 'receiver'},
                {x: 80, y: 120, label: 'A', type: 'malicious'},    // 恶意节点
                {x: 200, y: 60, label: 'B', type: 'normal'},
                {x: 300, y: 80, label: 'C', type: 'normal'},
                {x: 420, y: 160, label: 'D', type: 'malicious'},   // 恶意节点
                {x: 300, y: 250, label: 'E', type: 'normal'}
            ];

            const edges = [
                {from: 0, to: 1}, {from: 0, to: 2},
                {from: 1, to: 3}, {from: 1, to: 4},
                {from: 2, to: 5}, {from: 2, to: 6},
                {from: 2, to: 7}
            ];

            generateGraphElements(positions, edges, edgesGroup, nodesGroup, '#e74c3c');
        }

        // 生成漏洞合约图形 (10个节点)
        function generateVulnerabilityGraph(nodeCount, edgesGroup, nodesGroup) {
            const positions = [
                {x: 250, y: 140, label: 'TX', type: 'center'},
                {x: 150, y: 80, label: '发送方', type: 'sender'},
                {x: 350, y: 200, label: '接收方', type: 'receiver'},
                {x: 100, y: 50, label: 'A', type: 'normal'},
                {x: 80, y: 140, label: 'B', type: 'vulnerable'},    // 漏洞节点
                {x: 120, y: 200, label: 'C', type: 'normal'},
                {x: 200, y: 40, label: 'D', type: 'normal'},
                {x: 400, y: 120, label: 'E', type: 'normal'},
                {x: 420, y: 240, label: 'F', type: 'normal'},
                {x: 280, y: 250, label: 'G', type: 'normal'}
            ];

            const edges = [
                {from: 0, to: 1}, {from: 0, to: 2},
                {from: 1, to: 3}, {from: 1, to: 4}, {from: 1, to: 5}, {from: 1, to: 6},
                {from: 2, to: 7}, {from: 2, to: 8}, {from: 2, to: 9}
            ];

            generateGraphElements(positions, edges, edgesGroup, nodesGroup, '#f39c12');
        }

        // 生成复合风险图形 (11个节点)
        function generateCompoundGraph(nodeCount, edgesGroup, nodesGroup) {
            const positions = [
                {x: 250, y: 140, label: 'TX', type: 'center'},
                {x: 150, y: 80, label: '发送方', type: 'sender'},
                {x: 350, y: 200, label: '接收方', type: 'receiver'},
                {x: 80, y: 100, label: 'A', type: 'normal'},
                {x: 120, y: 180, label: 'B', type: 'normal'},
                {x: 200, y: 50, label: 'C', type: 'phishing'},      // 钓鱼节点
                {x: 300, y: 80, label: 'D', type: 'normal'},
                {x: 420, y: 140, label: 'E', type: 'malicious'},    // 恶意节点
                {x: 380, y: 250, label: 'F', type: 'normal'},
                {x: 280, y: 260, label: 'G', type: 'normal'},
                {x: 180, y: 220, label: 'H', type: 'normal'}
            ];

            const edges = [
                {from: 0, to: 1}, {from: 0, to: 2},
                {from: 1, to: 3}, {from: 1, to: 4}, {from: 1, to: 5},
                {from: 2, to: 6}, {from: 2, to: 7}, {from: 2, to: 8},
                {from: 2, to: 9}, {from: 1, to: 10}
            ];

            generateGraphElements(positions, edges, edgesGroup, nodesGroup, '#e74c3c');
        }

        // 生成黑名单+漏洞图形 (13个节点)
        function generateBlacklistVulnerableGraph(nodeCount, edgesGroup, nodesGroup) {
            const positions = [
                {x: 250, y: 140, label: 'TX', type: 'center'},
                {x: 120, y: 80, label: '黑名单', type: 'blacklist'},
                {x: 380, y: 200, label: '受害者', type: 'victim'},
                {x: 60, y: 60, label: 'A', type: 'vulnerable'},     // 漏洞节点
                {x: 80, y: 140, label: 'B', type: 'normal'},
                {x: 50, y: 200, label: 'C', type: 'normal'},
                {x: 180, y: 40, label: 'D', type: 'blacklist'},     // 黑名单节点
                {x: 300, y: 60, label: 'E', type: 'normal'},
                {x: 450, y: 140, label: 'F', type: 'normal'},
                {x: 420, y: 260, label: 'G', type: 'normal'},
                {x: 320, y: 270, label: 'H', type: 'vulnerable'},   // 漏洞节点
                {x: 200, y: 250, label: 'I', type: 'normal'},
                {x: 150, y: 180, label: 'J', type: 'normal'}
            ];

            const edges = [
                {from: 0, to: 1}, {from: 0, to: 2},
                {from: 1, to: 3}, {from: 1, to: 4}, {from: 1, to: 5}, {from: 1, to: 6},
                {from: 2, to: 7}, {from: 2, to: 8}, {from: 2, to: 9}, {from: 2, to: 10},
                {from: 1, to: 11}, {from: 1, to: 12}
            ];

            generateGraphElements(positions, edges, edgesGroup, nodesGroup, '#8e44ad');
        }

        // 通用图形元素生成函数
        function generateGraphElements(positions, edges, edgesGroup, nodesGroup, edgeColor = '#3498db') {
            // 绘制边
            edges.forEach((edge, index) => {
                const fromPos = positions[edge.from];
                const toPos = positions[edge.to];
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('id', `edge-${index}`);
                path.setAttribute('class', 'graph-edge');
                path.setAttribute('d', `M${fromPos.x},${fromPos.y} L${toPos.x},${toPos.y}`);
                path.setAttribute('stroke', edgeColor);
                path.setAttribute('stroke-width', '2');
                path.setAttribute('opacity', '0.6');
                edgesGroup.appendChild(path);
            });

            // 绘制节点
            positions.forEach((pos, index) => {
                const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                g.setAttribute('id', `node-${index}`);
                g.setAttribute('class', 'graph-node');

                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', pos.x);
                circle.setAttribute('cy', pos.y);
                circle.setAttribute('r', pos.type === 'center' ? 12 : (pos.type === 'sender' || pos.type === 'receiver' ? 16 : 10));
                
                let fillColor = '#3498db';
                if (pos.type === 'center') fillColor = '#f39c12';
                else if (pos.type === 'phishing' || pos.type === 'malicious' || pos.type === 'blacklist') fillColor = '#e74c3c';
                else if (pos.type === 'vulnerable') fillColor = '#f39c12';
                else if (pos.type === 'victim') fillColor = '#9b59b6';
                else if (pos.type === 'sender' || pos.type === 'receiver') fillColor = '#3498db';
                
                circle.setAttribute('fill', fillColor);
                circle.setAttribute('stroke', 'white');
                circle.setAttribute('stroke-width', '2');
                
                if (pos.type === 'phishing' || pos.type === 'malicious' || pos.type === 'blacklist') {
                    circle.setAttribute('filter', 'drop-shadow(0 0 8px rgba(231, 76, 60, 0.8))');
                } else if (pos.type === 'vulnerable') {
                    circle.setAttribute('filter', 'drop-shadow(0 0 8px rgba(243, 156, 18, 0.8))');
                }

                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', pos.x);
                text.setAttribute('y', pos.y);
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('dominant-baseline', 'middle');
                text.setAttribute('fill', 'white');
                text.setAttribute('font-size', pos.type === 'sender' || pos.type === 'receiver' ? '7' : '8');
                text.setAttribute('font-weight', 'bold');
                text.textContent = pos.label;

                g.appendChild(circle);
                g.appendChild(text);
                nodesGroup.appendChild(g);
            });
        }

        // 生成风险检测项目HTML
        function generateRiskCheckItems(risks) {
            const riskTitles = ['钓鱼活动检测', '恶意合约检测', '黑名单地址检测', '资金安全检测', '合约漏洞检测'];
            const safeDescriptions = [
                '交易流向正常，未发现欺诈行为',
                '合约代码安全，无恶意逻辑', 
                '地址清洁，无风险记录',
                '资金来源合法，无盗窃迹象',
                '代码结构稳定，无已知漏洞'
            ];
            
            return riskTitles.map((title, index) => {
                // 检查是否有这种风险类型
                let hasThisRisk = false;
                
                switch(index) {
                    case 0: // 钓鱼活动检测
                        hasThisRisk = risks.some(risk => 
                            risk.includes('钓鱼攻击') || 
                            risk.includes('钓鱼活动') || 
                            risk === '钓鱼活动'
                        );
                        break;
                    case 1: // 恶意合约检测
                        hasThisRisk = risks.some(risk => 
                            risk.includes('恶意合约') || 
                            risk === '恶意合约交互'
                        );
                        break;
                    case 2: // 黑名单地址检测
                        hasThisRisk = risks.some(risk => 
                            risk.includes('黑名单') || 
                            risk === '黑名单地址相关'
                        );
                        break;
                    case 3: // 资金安全检测
                        hasThisRisk = risks.some(risk => 
                            risk.includes('盗窃') || 
                            risk.includes('资金盗窃') || 
                            risk === '资金盗窃活动'
                        );
                        break;
                    case 4: // 合约漏洞检测
                        hasThisRisk = risks.some(risk => 
                            risk.includes('漏洞') || 
                            risk.includes('智能合约漏洞') ||
                            risk === '智能合约漏洞'
                        );
                        break;
                }
                
                const iconClass = hasThisRisk ? 'bi-shield-exclamation' : 'bi-shield-check';
                const iconColor = hasThisRisk ? 'danger' : 'safe';
                const statusText = hasThisRisk ? '⚠ 检测到风险' : '✓ 通过检测';
                const statusColor = hasThisRisk ? '#ef4444' : '#22c55e';
                const description = hasThisRisk ? '发现安全风险，建议谨慎处理' : safeDescriptions[index];
                
                return `
                    <div class="risk-check-item ${hasThisRisk ? 'danger' : 'safe'}">
                        <div class="risk-icon-container">
                            <i class="bi ${iconClass} risk-icon ${iconColor}"></i>
                        </div>
                        <div class="risk-content">
                            <div class="risk-title">${title}</div>
                            <div class="risk-status" style="color: ${statusColor}">${statusText}</div>
                            <div class="risk-description">${description}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // 更新交易详细信息
        function updateTransactionDetails(info) {
            // 更新交易哈希显示
            const hashDisplay = document.getElementById('tx-hash-display');
            if (hashDisplay) {
                hashDisplay.textContent = document.getElementById('txHash').value;
            }
            
            // 更新状态徽章
            const statusBadge = document.getElementById('tx-status-badge');
            if (statusBadge) {
                statusBadge.className = `badge ${info.statusClass} ms-2`;
                statusBadge.textContent = info.status;
            }
            
            // 更新时间戳
            const timestamp = document.getElementById('tx-timestamp');
            if (timestamp) {
                timestamp.textContent = info.timestamp;
            }
            
            // 更新交易详细信息的其他字段
            const detailsSection = document.querySelector('.transaction-details-section');
            if (detailsSection) {
                // 更新区块号
                const blockSpan = detailsSection.querySelector('.col-md-6:first-child .mb-2:nth-child(3) span:first-of-type');
                if (blockSpan) {
                    blockSpan.textContent = info.blockNumber;
                }
                
                // 更新方法
                const methodBadge = detailsSection.querySelector('.badge.bg-info');
                if (methodBadge) {
                    methodBadge.textContent = info.method;
                }
                
                // 更新发送方
                const fromSpan = detailsSection.querySelector('.col-md-6:last-child .mb-2:first-child span');
                if (fromSpan) {
                    fromSpan.textContent = info.fromLabel;
                }
                
                // 更新接收方
                const toSpan = detailsSection.querySelector('.col-md-6:last-child .mb-2:nth-child(2) span');
                if (toSpan) {
                    toSpan.textContent = info.toLabel;
                }
                
                // 更新金额
                const valueSpan = detailsSection.querySelector('.col-md-6:last-child .mb-2:nth-child(3) span');
                if (valueSpan) {
                    valueSpan.textContent = info.value;
                }
                
                // 更新交易费
                const feeSpan = detailsSection.querySelector('.col-md-6:last-child .mb-2:nth-child(4) span');
                if (feeSpan) {
                    feeSpan.textContent = info.transactionFee;
                }
                
                // 更新Gas价格
                const gasPriceSpan = detailsSection.querySelector('.col-md-6:last-child .mb-2:nth-child(5) span');
                if (gasPriceSpan) {
                    gasPriceSpan.textContent = info.gasPrice;
                }
                
                // 更新网络信息
                const networkSpan = detailsSection.querySelector('.col-md-6:last-child > div:last-child span');
                if (networkSpan) {
                    networkSpan.textContent = info.network;
                }
            }
        }



        // 交易可视化图动画函数
        function animateTransactionGraph() {
            // 第一层(核心层)节点和边的显示
            setTimeout(() => {
                // 显示核心节点(交易双方)
                document.querySelectorAll('.graph-node.level-0').forEach(node => {
                    node.style.opacity = 1;
                    node.style.transition = 'opacity 0.5s ease-in-out';
                });
                
                // 显示核心边(主要交易路径)
                setTimeout(() => {
                    document.querySelectorAll('.graph-edge.level-0').forEach(edge => {
                        edge.style.opacity = 1;
                        edge.style.transition = 'opacity 0.5s ease-in-out';
                    });
                    
                    // 第二层节点和边的显示(与发送方相关的节点)
                    setTimeout(() => {
                        document.querySelectorAll('.graph-node.level-1').forEach(node => {
                            node.style.opacity = 1;
                            node.style.transition = 'opacity 0.5s ease-in-out';
                        });
                        
                        // 显示第二层边
                        setTimeout(() => {
                            document.querySelectorAll('.graph-edge.level-1').forEach(edge => {
                                edge.style.opacity = 1;
                                edge.style.transition = 'opacity 0.5s ease-in-out';
                            });
                            
                            // 第三层节点和边的显示(与接收方相关的节点)
                            setTimeout(() => {
                                document.querySelectorAll('.graph-node.level-2').forEach(node => {
                                    node.style.opacity = 1;
                                    node.style.transition = 'opacity 0.5s ease-in-out';
                                });
                                
                                // 显示第三层边
                                setTimeout(() => {
                                    document.querySelectorAll('.graph-edge.level-2').forEach(edge => {
                                        edge.style.opacity = 1;
                                        edge.style.transition = 'opacity 0.5s ease-in-out';
                                    });
                                }, 300);
                            }, 600);
                        }, 300);
                    }, 600);
                }, 300);
            }, 300);
        }
        
        // 重置可视化图动画的函数
        function resetTransactionGraph() {
            document.querySelectorAll('.graph-node, .graph-edge').forEach(item => {
                item.style.opacity = 0;
            });
        }
        
        // 地址关联图动画函数
        function animateAddressGraph() {
            // 重置所有元素为可见状态
            document.querySelectorAll('.address-node, .address-edge').forEach(element => {
                element.style.display = 'block';
                element.style.opacity = '1';
            });
            
            // 简单的淡入效果
            const svg = document.getElementById('address-graph');
            if (svg) {
                svg.style.opacity = '0';
                svg.style.transition = 'opacity 0.5s ease';
                setTimeout(() => {
                    svg.style.opacity = '1';
                }, 100);
            }
        }
        
        // 重置地址图动画
        function resetAddressGraph() {
            document.querySelectorAll('.address-node, .address-edge').forEach(item => {
                item.style.opacity = '1';
                item.style.display = 'block';
                // 移除所有风险节点标记
                item.classList.remove('risk-node');
                const circle = item.querySelector('circle');
                if (circle) {
                    // 重置为默认颜色
                    if (item.id === 'address-node-0') {
                        circle.setAttribute('fill', '#3498db');
                        circle.setAttribute('filter', 'drop-shadow(0 0 8px rgba(52, 152, 219, 0.6))');
                    } else if (item.classList.contains('level-0')) {
                        circle.setAttribute('fill', '#5dade2');
                        circle.setAttribute('filter', 'drop-shadow(0 0 4px rgba(93, 173, 226, 0.4))');
                    } else {
                        circle.setAttribute('fill', '#85c1e9');
                        circle.removeAttribute('filter');
                    }
                }
            });
        }

        // 显示交易分析结果
        function displayTransactionResult(data) {
            const resultDiv = document.getElementById('txResult');
            const riskPanel = document.querySelector('#txRisks');
            
            // 恢复面板透明度
            if (riskPanel) {
                riskPanel.style.opacity = '1';
            }
            
            // 标记风险节点
            if (data.riskNodes && data.riskNodes.length > 0) {
                data.riskNodes.forEach(nodeId => {
                    const node = document.getElementById(nodeId);
                    if (node) {
                        node.classList.add('risk-node');
                    }
                });
            } else {
                // 移除所有风险节点标记
                document.querySelectorAll('.risk-node').forEach(node => {
                    node.classList.remove('risk-node');
                });
            }
            
            // 更新风险分析结果
            const hasRisks = data.risks && data.risks.length > 0;
            const riskScore = hasRisks ? Math.max(20, 85 - (data.risks.length * 15)) : 85;
            
            // 更新概览面板
            updateRiskOverview(riskScore, hasRisks, data.risks?.length || 0);
            
            // 更新检测项目
            updateRiskDetectionItems(data.risks || []);
            
            // 更新建议
            updateRiskRecommendation(hasRisks, data.risks || []);
        }

        // 更新风险概览
        function updateRiskOverview(score, hasRisks, riskCount) {
            const scoreElement = document.getElementById('risk-score');
            const statusElement = document.getElementById('overall-status');
            const scoreCircle = document.querySelector('.score-circle');
            
            scoreElement.textContent = score;
            
            if (hasRisks) {
                statusElement.textContent = riskCount > 2 ? '高风险交易' : '中风险交易';
                statusElement.classList.add('danger');
                scoreCircle.classList.add('danger');
                
                // 更新进度圆圈
                const percentage = (score / 100) * 360;
                scoreCircle.style.background = `conic-gradient(from 0deg, #ef4444 0deg, #ef4444 ${percentage}deg, rgba(255, 255, 255, 0.08) ${percentage}deg, rgba(255, 255, 255, 0.08) 360deg)`;
            } else {
                statusElement.textContent = '低风险交易';
                statusElement.classList.remove('danger');
                scoreCircle.classList.remove('danger');
                
                // 更新进度圆圈
                const percentage = (score / 100) * 360;
                scoreCircle.style.background = `conic-gradient(from 0deg, #22c55e 0deg, #22c55e ${percentage}deg, rgba(255, 255, 255, 0.08) ${percentage}deg, rgba(255, 255, 255, 0.08) 360deg)`;
            }
        }

        // 更新检测项目
        function updateRiskDetectionItems(risks) {
            const riskTypes = ['phishing', 'malicious', 'blacklist', 'theft', 'vulnerability'];
            const riskTitles = ['钓鱼活动检测', '恶意合约检测', '黑名单地址检测', '资金安全检测', '合约漏洞检测'];
            const safeDescriptions = [
                '交易流向正常，未发现欺诈行为',
                '合约代码安全，无恶意逻辑',
                '地址清洁，无风险记录',
                '资金来源合法，无盗窃迹象',
                '代码结构稳定，无已知漏洞'
            ];
            
            riskTypes.forEach((type, index) => {
                const item = document.querySelector(`[data-risk-type="${type}"]`);
                if (!item) return;
                
                const icon = item.querySelector('.risk-icon');
                const title = item.querySelector('.risk-title');
                const status = item.querySelector('.risk-status');
                const description = item.querySelector('.risk-description');
                
                // 检查是否有对应的风险
                const hasThisRisk = risks.some(risk => 
                    risk.toLowerCase().includes(type === 'phishing' ? '钓鱼' : 
                    type === 'malicious' ? '恶意' : 
                    type === 'blacklist' ? '黑名单' : 
                    type === 'theft' ? '盗窃' : '漏洞')
                );
                
                if (hasThisRisk) {
                    item.classList.add('danger');
                    item.classList.remove('safe');
                    icon.className = 'bi bi-shield-exclamation risk-icon danger';
                    status.textContent = '⚠ 检测到风险';
                    status.style.color = '#ef4444';
                    description.textContent = '发现安全风险，建议谨慎处理';
                } else {
                    item.classList.remove('danger');
                    item.classList.add('safe');
                    icon.className = 'bi bi-shield-check risk-icon safe';
                    status.textContent = '✓ 通过检测';
                    status.style.color = '#22c55e';
                    description.textContent = safeDescriptions[index];
                }
            });
        }

        // 更新风险建议
        function updateRiskRecommendation(hasRisks, risks) {
            const recommendationContent = document.getElementById('risk-recommendation');
            
            if (hasRisks) {
                const riskCount = risks.length;
                let content = '<p>⚠️ 检测到安全风险，建议采取以下措施：</p>';
                
                if (riskCount > 2) {
                    content += '<p>🚨 高危交易，强烈建议停止执行</p>';
                    content += '<p>🔍 建议进行详细的人工审核</p>';
                } else {
                    content += '<p>⚡ 中等风险，建议谨慎处理</p>';
                    content += '<p>🔒 可考虑采用多重签名验证</p>';
                }
                
                content += '<p>📞 如有疑问，请联系安全团队</p>';
                recommendationContent.innerHTML = content;
            } else {
                recommendationContent.innerHTML = `
                    <p>✅ 该交易通过所有安全检测，可以放心执行</p>
                    <p>💡 建议持续关注交易对手的历史行为</p>
                `;
            }
        }



        // 验证以太坊地址格式
        function isValidEthereumAddress(address) {
            // 检查是否以0x开头且总长度为42字符
            if (!address || address.length !== 42) {
                return false;
            }
            
            // 检查是否以0x开头
            if (!address.startsWith('0x')) {
                return false;
            }
            
            // 检查后40位是否都是十六进制字符
            const hexPart = address.slice(2);
            const hexRegex = /^[0-9a-fA-F]{40}$/;
            return hexRegex.test(hexPart);
        }

        // 地址检测功能
        function analyzeAddress() {
            const address = document.getElementById('addressInput').value.trim();
            const button = document.getElementById('analyzeAddress');
            const resultDiv = document.getElementById('addressResult');
            
            if (!address) {
                alert('请输入有效的以太坊地址');
                return;
            }
            
            // 严格验证地址格式
            if (!isValidEthereumAddress(address)) {
                alert('输入地址格式有误！\n\n正确格式要求：\n• 以 0x 开头\n• 后跟40个十六进制字符 (0-9, a-f)\n• 总长度为42个字符\n\n请检查输入并重试。');
                return;
            }
            
            // 显示地址到结果页面
            document.getElementById('result-address-display').textContent = address;
            
            // 更新按钮状态并显示进度条
            button.disabled = true;
            showAddressProgress(button);
            
            // 设置初始状态
            document.getElementById('address-risk-badge').className = 'badge bg-secondary rounded-pill d-flex align-items-center';
            document.getElementById('address-risk-badge').innerHTML = '<i class="bi bi-hourglass-split me-1"></i> 分析中...';
            
            // 显示结果卡片但隐藏分析结果
            resultDiv.style.display = 'block';
            hideAddressAnalysisResults();
            
            // 分阶段显示分析过程
            setTimeout(() => {
                // 第一阶段：构建地址关联网络
                resetAddressGraph();
                updateAddressProgressButton(button, '构建地址关联网络...', 20);
                animateAddressGraph();
            }, 500);
            
            setTimeout(() => {
                // 第二阶段：黑名单检查
                updateAddressProgressButton(button, '执行黑名单检查...', 40);
            }, 1000);
            
            setTimeout(() => {
                // 第三阶段：历史交易分析
                updateAddressProgressButton(button, '分析历史交易模式...', 60);
            }, 1500);
            
            setTimeout(() => {
                // 第四阶段：风险评估
                updateAddressProgressButton(button, '执行风险评估...', 80);
            }, 2000);
            
            setTimeout(() => {
                // 第五阶段：生成报告
                updateAddressProgressButton(button, '生成风险报告...', 95);
                
                // 根据地址生成对应的风险数据
                const riskData = generateAddressRiskData(address);
                
                updateAddressProgressButton(button, '检测完成', 100);
                displayAddressResultWithAnimation(riskData, address);
                resetButton(button, '<i class="bi bi-search me-2"></i>评估地址风险');
            }, 3000);
        }

        // 显示地址检测进度
        function showAddressProgress(button) {
            const progressHtml = `
                <div class="d-flex align-items-center">
                    <div class="progress me-3" style="width: 120px; height: 6px;">
                        <div class="progress-bar bg-info" role="progressbar" style="width: 0%" id="address-progress-bar"></div>
                    </div>
                    <span id="address-progress-text">初始化检测...</span>
                </div>
            `;
            button.innerHTML = progressHtml;
        }

        // 更新地址检测进度按钮
        function updateAddressProgressButton(button, text, progress) {
            const progressBar = document.getElementById('address-progress-bar');
            const progressText = document.getElementById('address-progress-text');
            
            if (progressBar && progressText) {
                progressBar.style.width = progress + '%';
                progressText.textContent = text;
                
                // 进度条颜色变化
                if (progress < 25) {
                    progressBar.className = 'progress-bar bg-info';
                } else if (progress < 50) {
                    progressBar.className = 'progress-bar bg-primary';
                } else if (progress < 75) {
                    progressBar.className = 'progress-bar bg-warning';
                } else if (progress < 100) {
                    progressBar.className = 'progress-bar bg-danger';
                } else {
                    progressBar.className = 'progress-bar bg-success';
                }
            }
        }

        // 隐藏地址分析结果
        function hideAddressAnalysisResults() {
            const risksDiv = document.getElementById('addressRisks');
            if (risksDiv) {
                risksDiv.style.opacity = '0.3';
                risksDiv.innerHTML = `
                    <div class="text-center py-5">
                        <div class="spinner-border text-primary mb-3" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p style="color: #94a3b8;">正在检测地址风险...</p>
                        <p style="color: #64748b; font-size: 0.85rem;">正在查询黑名单数据库</p>
                    </div>
                `;
            }
        }

        // 带动画的显示地址检测结果
        function displayAddressResultWithAnimation(data, address) {
            const risksDiv = document.getElementById('addressRisks');
            if (!risksDiv) return;
            
            // 恢复面板透明度
            risksDiv.style.opacity = '1';
            
            // 根据图结构重新生成网络图
            generateDynamicGraph(data.graphStructure, data.riskNodes);
            
            // 标记风险节点
            if (data.riskNodes && data.riskNodes.length > 0) {
                setTimeout(() => {
                    data.riskNodes.forEach(nodeId => {
                        const node = document.getElementById(nodeId);
                        if (node) {
                            node.classList.add('risk-node');
                        }
                    });
                }, 500);
            } else {
                document.querySelectorAll('#address-graph .risk-node').forEach(node => {
                    node.classList.remove('risk-node');
                });
            }
            
            // 立即显示详细结果
            displayAddressResult(data, address);
        }

        // 显示地址检测结果
        function displayAddressResult(data, address) {
            const resultDiv = document.getElementById('addressResult');
            const risksDiv = document.getElementById('addressRisks');
            
            // 标记风险节点
            if (data.riskNodes && data.riskNodes.length > 0) {
                data.riskNodes.forEach(nodeId => {
                    const node = document.getElementById(nodeId);
                    if (node) {
                        node.classList.add('risk-node');
                    }
                });
            } else {
                // 移除所有风险节点标记
                document.querySelectorAll('#address-graph .risk-node').forEach(node => {
                    node.classList.remove('risk-node');
                });
            }
            
            const isRisky = data.risks && data.risks.length > 0;
            const riskCount = isRisky ? data.risks.length : 0;
            
            // 更新地址信息
            if (data.addressInfo) {
                // 余额显示颜色根据风险状态调整
                const balanceColor = isRisky ? '#f39c12' : 'var(--safe-green)';
                document.getElementById('eth-balance').textContent = data.addressInfo.ethBalance;
                document.getElementById('eth-balance').style.color = balanceColor;
                document.getElementById('eth-value').textContent = data.addressInfo.ethValue;
                document.getElementById('eth-value').style.color = balanceColor;
                
                // 交易哈希显示
                const txnColor = isRisky ? '#ff6b6b' : '#4a90e2';
                document.getElementById('last-txn').innerHTML = `${data.addressInfo.lastTxn}<br><span style="color: rgba(255, 255, 255, 0.6);">(from ${data.addressInfo.lastTxnAge})</span>`;
                document.getElementById('last-txn').style.color = txnColor;
                document.getElementById('first-txn').innerHTML = `${data.addressInfo.firstTxn}<br><span style="color: rgba(255, 255, 255, 0.6);">(from ${data.addressInfo.firstTxnAge})</span>`;
                document.getElementById('first-txn').style.color = txnColor;
                
                // 更新私有标签
                const privateTagElement = document.querySelector('[data-field="private-tag"]');
                if (privateTagElement) {
                    if (isRisky) {
                        privateTagElement.style.color = 'var(--danger-red)';
                    } else {
                        privateTagElement.style.color = data.riskColor === 'info' ? 'var(--safe-green)' : 'rgba(255, 255, 255, 0.6)';
                    }
                    privateTagElement.textContent = data.addressInfo.privateTag;
                }
            }
            
            // 更新地址风险徽章
            if (isRisky) {
                document.getElementById('address-risk-badge').className = `badge bg-${data.riskColor} rounded-pill d-flex align-items-center`;
                document.getElementById('address-risk-badge').innerHTML = `<i class="bi bi-exclamation-triangle me-1"></i> 风险项 ${riskCount}`;
                document.getElementById('address-risk-badge').style.fontSize = '0.85rem';
                document.getElementById('address-risk-badge').style.padding = '0.5rem 1rem';
                
                // 显示紧凑的风险分析结果
                risksDiv.innerHTML = `
                    <div class="alert alert-danger" style="background: rgba(255, 0, 77, 0.1); border: 1px solid rgba(255, 0, 77, 0.3); color: var(--danger-red); font-weight: 500; margin-bottom: 0.8rem; padding: 0.6rem; font-size: 0.85rem;">
                        <i class="bi bi-exclamation-triangle-fill me-2"></i>
                        检测到 ${riskCount} 项安全风险
                    </div>
                    
                    <!-- 风险概览 -->
                    <div style="background: rgba(255, 0, 77, 0.05); border: 1px solid rgba(255, 0, 77, 0.2); border-radius: 6px; padding: 0.6rem; margin-bottom: 0.8rem;">
                        <div class="d-flex align-items-center">
                            <div class="rounded-circle bg-danger d-flex justify-content-center align-items-center me-2" style="width: 28px; height: 28px;">
                                <i class="bi bi-exclamation-triangle-fill text-white" style="font-size: 0.7rem;"></i>
                            </div>
                            <div>
                                <div style="color: #ff6b6b; font-weight: 600; font-size: 0.9rem;">高风险地址</div>
                                <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.75rem;">建议避免与此地址交互</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 风险详情列表 -->
                    <div>
                        <h6 style="color: var(--danger-red); margin-bottom: 0.5rem; font-weight: 600; font-size: 0.85rem;">
                            <i class="bi bi-shield-exclamation me-1"></i>检测到的风险类型
                        </h6>
                        <div>
                            ${data.risks.map((risk, index) => `
                                <div class="risk-item-container mb-2" style="background: rgba(255, 0, 77, 0.05); border: 1px solid rgba(255, 0, 77, 0.15); border-radius: 4px; overflow: hidden;">
                                    <div class="d-flex align-items-start" style="padding: 0.5rem; cursor: pointer;" onclick="toggleRiskDetails('risk-${index}')">
                                    <div class="rounded-circle bg-danger d-flex justify-content-center align-items-center me-2" style="width: 18px; height: 18px; flex-shrink: 0;">
                                        <i class="bi bi-exclamation text-white" style="font-size: 0.6rem;"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <div style="color: #ff6b6b; font-weight: 500; margin-bottom: 0.2rem; font-size: 0.8rem;">${risk}</div>
                                        <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.7rem; line-height: 1.3;">
                                            ${getRiskDescription(risk)}
                                            </div>
                                        </div>
                                        <div class="risk-expand-btn" style="margin-left: 0.5rem; opacity: 0.7; transition: all 0.3s ease;">
                                            <i class="bi bi-chevron-down" style="font-size: 0.7rem; color: rgba(255, 255, 255, 0.6);"></i>
                                        </div>
                                    </div>
                                    <div id="risk-${index}" class="risk-details" style="display: none; padding: 0 0.5rem 0.5rem 0.5rem; border-top: 1px solid rgba(255, 0, 77, 0.2); background: rgba(255, 0, 77, 0.03);">
                                        <div class="risk-detail-content" style="padding: 0.5rem; font-size: 0.75rem;">
                                            ${getRiskDetailHTML(risk)}
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            } else {
                document.getElementById('address-risk-badge').className = `badge bg-${data.riskColor} rounded-pill d-flex align-items-center`;
                document.getElementById('address-risk-badge').innerHTML = '<i class="bi bi-shield-check me-1"></i> 风险项 0';
                document.getElementById('address-risk-badge').style.fontSize = '0.85rem';
                document.getElementById('address-risk-badge').style.padding = '0.5rem 1rem';
                
                // 显示无风险状态
                risksDiv.innerHTML = `
                    <div class="alert alert-info" style="background: rgba(0, 212, 170, 0.1); border: 1px solid rgba(0, 212, 170, 0.3); color: var(--safe-green); font-weight: 500; margin-bottom: 0.8rem; padding: 0.6rem; font-size: 0.85rem;">
                        <i class="bi bi-shield-check-fill me-2"></i>
                        地址安全检测通过
                    </div>
                    
                    <!-- 安全概览 -->
                    <div style="background: rgba(0, 212, 170, 0.05); border: 1px solid rgba(0, 212, 170, 0.2); border-radius: 6px; padding: 0.6rem; margin-bottom: 0.8rem;">
                        <div class="d-flex align-items-center">
                            <div class="rounded-circle d-flex justify-content-center align-items-center me-2" style="width: 28px; height: 28px; background: var(--safe-green);">
                                <i class="bi bi-shield-check-fill text-white" style="font-size: 0.7rem;"></i>
                            </div>
                            <div>
                                <div style="color: var(--safe-green); font-weight: 600; font-size: 0.9rem;">${data.riskLevel}地址</div>
                                <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.75rem;">未检测到已知风险行为</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 安全检测项目 -->
                    <div>
                        <h6 style="color: var(--safe-green); margin-bottom: 0.5rem; font-weight: 600; font-size: 0.85rem;">
                            <i class="bi bi-shield-check me-1"></i>安全检测项目
                        </h6>
                        <div>
                            ${['钓鱼活动检测', '恶意合约检测', '黑名单检测', '窃取攻击检测', '蜜罐检测'].map(item => `
                                <div class="d-flex align-items-start mb-2" style="background: rgba(0, 212, 170, 0.05); border: 1px solid rgba(0, 212, 170, 0.15); border-radius: 4px; padding: 0.5rem;">
                                    <div class="rounded-circle d-flex justify-content-center align-items-center me-2" style="width: 18px; height: 18px; flex-shrink: 0; background: var(--safe-green);">
                                        <i class="bi bi-check text-white" style="font-size: 0.6rem;"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <div style="color: var(--safe-green); font-weight: 500; margin-bottom: 0.2rem; font-size: 0.8rem;">${item}</div>
                                        <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.7rem; line-height: 1.3;">
                                            通过检测，未发现风险
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
        }

        // 代码生成功能
        function generateCode() {
            const contractAddress = document.getElementById('codeInput').value.trim();
            const button = document.getElementById('generateCode');
            const resultDiv = document.getElementById('codeResult');
            
            // 检查是否输入了合约地址
            if (!contractAddress) {
                alert('请输入有效的合约地址');
                return;
            }
            
            // 显示输入的合约地址
            document.getElementById('contract-address-display').textContent = contractAddress;
            
            button.disabled = true;
            button.innerHTML = '<div class="loading-spinner me-2"></div>生成中...';
            
            setTimeout(() => {
                // 调用后端API
                fetch('/api/generate_code', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ contractAddress: contractAddress })
                })
                .then(response => response.json())
                .then(data => {
                    // 使用API返回的数据或默认数据
                    displayCodeResult(data);
                })
                .catch(error => {
                    console.error('API调用失败:', error);
                    // 根据输入的地址选择对应的示例数据
                    const exampleData = getExampleDataByAddress(contractAddress);
                    displayCodeResult(exampleData);
                })
                .finally(() => {
                    button.disabled = false;
                    button.innerHTML = '<i class="bi bi-gear me-2"></i>生成函数名';
                });
            }, 1500);
        }

        // 根据合约地址获取对应的示例数据
        function getExampleDataByAddress(contractAddress) {
            const addressUpper = contractAddress.toUpperCase();
            
            // 示例一：钓鱼合约 - 0x85BC81fc84892cf1b391510f8e3784fTc9d1f9297
            if (addressUpper === '0X85BC81FC84892CF1B391510F8E3784FTC9D1F9297') {
                return {
                    title: "示例一：解析一个复杂的钓鱼合约",
                    description: "这个例子演示了如何通过函数名恢复技术，识别出一个使用混淆函数名的钓鱼合约。",
                        original_data: {
                            'is_contract': true,
                            'goplus': 'stealing attack',
                        'code': {
                            '_dispatcher': 'function _dispatcher',
                            '_fallback': 'function _fallback payable view pure',
                            'withdraw()': 'function withdraw()',
                            '0x5b1e3b51': 'function 0x5b1e3b51 payable view',
                            '0x5fe2e4d1': 'function 0x5fe2e4d1 payable view',
                            'withdraw(address,uint256)': 'function withdraw(address,uint256) view'
                        }
                        },
                        processed_data: {
                            'is_contract': true,
                            'goplus': 'stealing attack',
                        'code': {
                            '_dispatcher': 'function _dispatcher',
                            '_fallback': 'function _fallback payable view pure',
                            'withdraw()': 'function withdraw()',
                            'approveTransaction()': 'function approveTransaction() payable view',
                            'finalizePayment()': 'function finalizePayment() payable view',
                            'withdraw(address,uint256)': 'function withdraw(address,uint256) view'
                        }
                    }
                };
            }
            
            // 示例二：批量空投工具合约 - 0x24aD4536605b4bC9B0753D3256d3372AddaCE29D
            if (addressUpper === '0X24AD4536605B4BC9B0753D3256D3372ADDACE29D') {
                return {
                    title: "示例三：解析一个没有明显恶意行为的、未验证源码的工具类合约",
                    description: "这个例子模拟了对一个功能正常、但代码不透明的'灰盒'合约的分析，考验模型在非黑即白之外的推理能力。",
                    original_data: {
                        'is_contract': true,
                        'goplus': 'safe',
                        'code': {
                            '0xb5b89a88': 'function 0xb5b89a88 payable',
                            '0x0d3c5220': 'function 0x0d3c5220 payable',
                            'owner()': 'function owner() view returns (address)'
                        }
                    },
                    processed_data: {
                        'is_contract': true,
                        'goplus': 'safe',
                        'code': {
                            'multisendToken()': 'function multisendToken() payable',
                            'depositTokens()': 'function depositTokens() payable',
                            'owner()': 'function owner() view returns (address)'
                        }
                    }
                };
            }
            
            // 默认示例（原有的钓鱼合约示例）
            return {
                title: "示例一：解析一个复杂的钓鱼合约",
                description: "这个例子演示了如何通过函数名恢复技术，识别出一个使用混淆函数名的钓鱼合约。",
                original_data: {
                    'is_contract': true,
                    'goplus': 'stealing attack',
                    'code': {
                        '_dispatcher': 'function _dispatcher',
                        '_fallback': 'function _fallback payable view pure',
                        'withdraw()': 'function withdraw()',
                        '0x5b1e3b51': 'function 0x5b1e3b51 payable view',
                        '0x5fe2e4d1': 'function 0x5fe2e4d1 payable view',
                        'withdraw(address,uint256)': 'function withdraw(address,uint256) view'
                    }
                },
                processed_data: {
                    'is_contract': true,
                    'goplus': 'stealing attack',
                    'code': {
                        '_dispatcher': 'function _dispatcher',
                        '_fallback': 'function _fallback payable view pure',
                        'withdraw()': 'function withdraw()',
                        'approveTransaction()': 'function approveTransaction() payable view',
                        'finalizePayment()': 'function finalizePayment() payable view',
                        'withdraw(address,uint256)': 'function withdraw(address,uint256) view'
                    }
                }
            };
        }

        // 显示代码生成结果
        function displayCodeResult(data) {
            const resultDiv = document.getElementById('codeResult');
            
            // 更新显示的数据
            updateCodeResultDisplay(data);
            
            // 显示结果区域
            resultDiv.style.display = 'block';
        }

        // 更新代码结果显示
        function updateCodeResultDisplay(data) {
            const originalDataDiv = document.getElementById('originalData');
            const generatedDataDiv = document.getElementById('generatedData');
            
            if (originalDataDiv && generatedDataDiv) {
                // 格式化原始数据
                const originalFormatted = formatCodeData(data.original_data, 'original');
                originalDataDiv.innerHTML = `<pre style="color: var(--text-secondary); margin: 0; white-space: pre-wrap; font-family: 'Orbitron', monospace; line-height: 1.4;">${originalFormatted}</pre>`;
                
                // 格式化生成数据
                const generatedFormatted = formatCodeData(data.processed_data, 'generated');
                generatedDataDiv.innerHTML = `<pre style="color: var(--text-secondary); margin: 0; white-space: pre-wrap; font-family: 'Orbitron', monospace; line-height: 1.4;">${generatedFormatted}</pre>`;
            }
        }

        // 格式化代码数据显示
        function formatCodeData(data, type) {
            let formatted = '{\n';
            formatted += `  "is_contract": ${data.is_contract},\n`;
            formatted += `  "goplus": "${data.goplus}",\n`;
            formatted += '  "code": {\n';
            
            const codeEntries = Object.entries(data.code);
            codeEntries.forEach(([key, value], index) => {
                const isLast = index === codeEntries.length - 1;
                
                if (type === 'original') {
                    // 原始数据中高亮混淆的函数名
                    if (key.startsWith('0x')) {
                        formatted += `     "<span style="color: #ff6b6b; font-weight: bold; background: rgba(255, 107, 107, 0.1); padding: 2px 4px; border-radius: 3px;">${key}</span>": "${value.replace(key, `<span style="color: #ff6b6b; font-weight: bold; background: rgba(255, 107, 107, 0.1); padding: 2px 4px; border-radius: 3px;">${key}</span>`)}"${isLast ? '' : ','}\n`;
                    } else {
                        formatted += `     "${key}": "${value}"${isLast ? '' : ','}\n`;
                    }
                } else {
                    // 生成数据中高亮恢复的函数名
                    if (key.includes('()') && !key.startsWith('_') && key !== 'owner()' && key !== 'withdraw()') {
                        formatted += `     "<span style="color: #00ffcc; font-weight: bold; background: rgba(0, 255, 204, 0.1); padding: 2px 4px; border-radius: 3px; text-shadow: 0 0 8px rgba(0, 255, 204, 0.3);">${key}</span>": "${value.replace(key, `<span style="color: #00ffcc; font-weight: bold; background: rgba(0, 255, 204, 0.1); padding: 2px 4px; border-radius: 3px; text-shadow: 0 0 8px rgba(0, 255, 204, 0.3);">${key}</span>`)}"${isLast ? '' : ','}\n`;
                    } else {
                        formatted += `     "${key}": "${value}"${isLast ? '' : ','}\n`;
                    }
                }
            });
            
            formatted += '   }\n}';
            return formatted;
        }

        // 全局变量用于区块链状态管理
        let currentBlockNumber = 22409812; // 起始区块号
        let blockUpdateInterval = null;
        let updateCountdownInterval = null;
        let nextUpdateSeconds = 60;
        let isRealTimeActive = false;

        // 获取实时数据
        function getRealTimeData() {
            const button = document.getElementById('getRealTimeData');
            const updateButton = document.getElementById('updateData');
            const resultDiv = document.getElementById('dataResult');
            
            button.disabled = true;
            button.innerHTML = '<div class="loading-spinner me-2"></div>获取中...';
            
            setTimeout(() => {
                // 初始化当前区块（模拟获取最新区块）
                currentBlockNumber = 22409812 + Math.floor(Math.random() * 1000);
                isRealTimeActive = true;
                
                // 调用后端API获取数据
                fetch('/api/get_realtime_data', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({})
                })
                .then(response => response.json())
                .then(data => {
                    generateBlockTransactionData(currentBlockNumber);
                })
                .catch(error => {
                    console.error('API调用失败:', error);
                    generateBlockTransactionData(currentBlockNumber); // 使用模拟数据
                })
                .finally(() => {
                    resultDiv.style.display = 'block';
                    updateButton.style.display = 'inline-block';
                    
                    // 显示停止按钮
                    const stopButton = document.getElementById('stopAutoUpdate');
                    if (stopButton) {
                        stopButton.style.display = 'inline-block';
                    }
                    
                    // 隐藏获取数据按钮（避免重复启动）
                    button.style.display = 'none';
                    
                    // 显示统计信息栏
                    const statsDiv = document.getElementById('dataStats');
                    if (statsDiv) {
                        statsDiv.style.display = 'block';
                    }
                    
                    button.disabled = false;
                    button.innerHTML = '<i class="bi bi-download me-2"></i>获取实时数据';
                    
                    // 启动自动更新机制
                    startBlockAutoUpdate();
                });
            }, 2000);
        }

        // 启动区块自动更新机制
        function startBlockAutoUpdate() {
            // 清除之前的定时器
            if (blockUpdateInterval) clearInterval(blockUpdateInterval);
            if (updateCountdownInterval) clearInterval(updateCountdownInterval);
            
            // 更新状态显示
            updateBlockchainStatus('运行中', '#22c55e');
            
            // 启动区块更新定时器（每60秒更新一次区块）
            blockUpdateInterval = setInterval(() => {
                if (isRealTimeActive) {
                    // 区块号递增（模拟新区块产生）
                    currentBlockNumber += 1;
                    console.log(`新区块产生: ${currentBlockNumber}`);
                    
                    // 生成新区块的交易数据
                    generateBlockTransactionData(currentBlockNumber);
                    
                    // 重置倒计时
                    nextUpdateSeconds = 60;
                }
            }, 60000); // 60秒
            
            // 启动倒计时定时器
            nextUpdateSeconds = 60;
            startUpdateCountdown();
        }
        
        // 启动更新倒计时
        function startUpdateCountdown() {
            updateCountdownInterval = setInterval(() => {
                if (isRealTimeActive && nextUpdateSeconds > 0) {
                    nextUpdateSeconds--;
                    updateNextUpdateTime(nextUpdateSeconds);
                    
                    if (nextUpdateSeconds === 0) {
                        nextUpdateSeconds = 60;
                    }
                }
            }, 1000);
        }
        
        // 停止自动更新
        function stopBlockAutoUpdate() {
            isRealTimeActive = false;
            if (blockUpdateInterval) {
                clearInterval(blockUpdateInterval);
                blockUpdateInterval = null;
            }
            if (updateCountdownInterval) {
                clearInterval(updateCountdownInterval);
                updateCountdownInterval = null;
            }
            updateBlockchainStatus('已停止', '#ef4444');
        }

        // 更新实时数据
        function updateRealTimeData() {
            const button = document.getElementById('updateData');
            
            button.disabled = true;
            button.innerHTML = '<div class="loading-spinner me-2"></div>更新中...';
            
            setTimeout(() => {
                // 手动触发新区块数据获取
                currentBlockNumber += 1;
                generateBlockTransactionData(currentBlockNumber);
                
                // 重置倒计时
                nextUpdateSeconds = 60;
                
                button.disabled = false;
                button.innerHTML = '<i class="bi bi-arrow-clockwise me-2"></i>更新数据';
            }, 1000);
        }

        // 更新区块信息显示
        function updateBlockchainInfo(blockNumber, timestamp) {
            const blockElement = document.getElementById('currentBlock');
            const timestampElement = document.getElementById('blockTimestamp');
            
            if (blockElement) {
                // 添加更新动画
                blockElement.style.transform = 'scale(1.1)';
                blockElement.style.transition = 'all 0.3s ease';
                
                setTimeout(() => {
                    blockElement.textContent = blockNumber.toLocaleString();
                    blockElement.style.transform = 'scale(1)';
                }, 150);
            }
            
            if (timestampElement) {
                timestampElement.textContent = timestamp;
            }
        }
        
        // 更新区块链状态显示
        function updateBlockchainStatus(status, color) {
            const statusElement = document.getElementById('updateStatus');
            if (statusElement) {
                const icon = status === '运行中' ? 'bi-play-circle' : 'bi-stop-circle';
                statusElement.innerHTML = `<i class="bi ${icon} me-1"></i>${status}`;
                statusElement.style.color = color;
            }
        }
        
        // 更新下次更新时间显示
        function updateNextUpdateTime(seconds) {
            const timeElement = document.getElementById('nextUpdateTime');
            if (timeElement) {
                timeElement.textContent = `${seconds}秒后`;
            }
        }

        // 基于区块号生成交易数据
        function generateBlockTransactionData(blockNumber) {
            const tableBody = document.getElementById('dataTableBody');
            tableBody.innerHTML = '';
            
            // 更新区块信息显示
            const now = new Date();
            const timestamp = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            updateBlockchainInfo(blockNumber, timestamp);
            
            const chars = 'abcdef0123456789';
            
            // 根据区块号生成确定性的交易数量（5-15笔）
            const seed = blockNumber * 17 + 42; // 使用区块号作为种子
            Math.seedrandom = function(s) {
                var seed = s;
                return function() {
                    seed = (seed * 9301 + 49297) % 233280;
                    return seed / 233280;
                };
            };
            const rng = Math.seedrandom(seed);
            
            const recordCount = Math.floor(rng() * 11) + 5; // 5到15笔交易
            
            // 动态生成风险数量（根据区块号确定性生成）
            const riskProbability = 0.1 + (blockNumber % 10) * 0.02; // 10%-30%的风险率
            const riskCount = Math.floor(recordCount * riskProbability);
            const safeCount = recordCount - riskCount;
            
            // 创建交易数据数组
            const transactionData = [];
            
            // 添加风险记录
            for (let i = 0; i < riskCount; i++) {
                transactionData.push({ risk: true, type: '风险' });
            }
            
            // 添加安全记录
            for (let i = 0; i < safeCount; i++) {
                transactionData.push({ risk: false, type: '安全' });
            }
            
            // 基于区块号打乱数组顺序（确定性随机）
            for (let i = transactionData.length - 1; i > 0; i--) {
                const j = Math.floor(rng() * (i + 1));
                [transactionData[i], transactionData[j]] = [transactionData[j], transactionData[i]];
            }
            
            // 生成表格行
            for (let i = 0; i < recordCount; i++) {
                // 基于区块号和交易索引生成确定性哈希
                const txSeed = blockNumber * 1000 + i;
                const txRng = Math.seedrandom(txSeed);
                
                let hash = '0x';
                let from = '0x';
                let to = '0x';
                
                // 生成基于种子的哈希值
                for (let j = 0; j < 16; j++) {
                    hash += chars.charAt(Math.floor(txRng() * chars.length));
                    from += chars.charAt(Math.floor(txRng() * chars.length));
                    to += chars.charAt(Math.floor(txRng() * chars.length));
                }
                
                hash += '...';
                from += '...';
                to += '...';
                
                const isRisk = transactionData[i].risk;
                const badgeClass = isRisk ? 'bg-danger' : 'bg-success';
                const statusText = isRisk ? '风险' : '安全';
                const badgeIcon = isRisk ? '<i class="bi bi-exclamation-triangle me-1"></i>' : '<i class="bi bi-shield-check me-1"></i>';
                
                const row = `<tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                    <td style="max-width: 180px; padding: 0.6rem; color: #4a90e2;" class="text-truncate">${hash}</td>
                    <td style="max-width: 140px; padding: 0.6rem; color: #4a90e2;" class="text-truncate">${from}</td>
                    <td style="max-width: 140px; padding: 0.6rem; color: #4a90e2;" class="text-truncate">${to}</td>
                    <td style="padding: 0.6rem;"><span class="badge ${badgeClass} d-flex align-items-center justify-content-center" style="font-size: 0.75rem; padding: 0.4rem 0.8rem;">${badgeIcon}${statusText}</span></td>
                </tr>`;
                
                tableBody.innerHTML += row;
            }
            
            // 更新统计信息显示
            updateDataStatistics(recordCount, safeCount, riskCount);
            
            // 在控制台显示统计信息（用于调试）
            console.log(`区块 ${blockNumber}: 总共${recordCount}笔交易，其中${safeCount}笔安全，${riskCount}笔风险 (风险率: ${(riskCount/recordCount * 100).toFixed(1)}%)`);
        }
        
        // 更新数据统计信息
        function updateDataStatistics(total, safe, risk) {
            const totalElement = document.getElementById('totalCount');
            const safeElement = document.getElementById('safeCount');
            const riskElement = document.getElementById('riskCount');
            
            if (totalElement && safeElement && riskElement) {
                // 添加更新动画效果
                [totalElement, safeElement, riskElement].forEach(element => {
                    element.style.transform = 'scale(1.1)';
                    element.style.transition = 'all 0.3s ease';
                });
                
                setTimeout(() => {
                    totalElement.textContent = total;
                    safeElement.textContent = safe;
                    riskElement.textContent = risk;
                    
                    [totalElement, safeElement, riskElement].forEach(element => {
                        element.style.transform = 'scale(1)';
                    });
                }, 150);
            }
        }

        // 格式化时间戳
        function formatTimestamp(date) {
            return date.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
        }

        // 扩展的地址风险数据生成器 - 基于phishing_label.csv数据
        function generateAddressRiskData(address) {
            const addressUpper = address.toUpperCase();
            
            // 扩展的地址数据库 - 基于真实的phishing_label.csv数据
            const knownAddresses = {
                // Bancor黑客地址
                '0XBCEAA0040764009FDCFF407E82AD1F06465FD2C4': {
                    risks: ['黑客攻击活动', '资金窃取', '交易所攻击'],
                    riskLevel: '极度危险',
                    riskColor: 'danger',
                    graphStructure: 'star',
                    riskNodes: ['address-node-0', 'address-node-1', 'address-node-2', 'address-node-3', 'address-node-4'],
                    addressInfo: {
                        ethBalance: '0 Ether',
                        ethValue: '$0.00 (@ $3,892.64/ETH)',
                        privateTag: 'Bancor Hacker - CRITICAL THREAT',
                        lastTxn: '0x4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b',
                        lastTxnAge: '2487天前',
                        firstTxn: '0x1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b',
                        firstTxnAge: '2487天前'
                    }
                },
                
                // 浏览器扩展攻击
                '0X03B70DC31ABF9CF6C1CF80BFEEB322E8D3DDB4CA': {
                    risks: ['浏览器扩展攻击', '恶意软件植入', '用户数据窃取'],
                    riskLevel: '危险',
                    riskColor: 'danger',
                    graphStructure: 'complex',
                    riskNodes: ['address-node-0', 'address-node-2', 'address-node-5', 'address-node-7'],
                    addressInfo: {
                        ethBalance: '0 Ether',
                        ethValue: '$0.00 (@ $3,892.64/ETH)',
                        privateTag: 'Browser Extension Hack - HIGH RISK',
                        lastTxn: '0x7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c',
                        lastTxnAge: '1876天前',
                        firstTxn: '0x2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d',
                        firstTxnAge: '2045天前'
                    }
                },
                
                // Coinrail交易所黑客
                '0XF6884686A999F5AE6C1AF03DB92BAB9C6D7DC8DE': {
                    risks: ['交易所攻击', '大额资金窃取', '高级持续威胁'],
                    riskLevel: '极度危险',
                    riskColor: 'danger',
                    graphStructure: 'hub',
                    riskNodes: ['address-node-0', 'address-node-1', 'address-node-3', 'address-node-4', 'address-node-6', 'address-node-8'],
                    addressInfo: {
                        ethBalance: '7,446.13401077 Ether',
                        ethValue: '$28,985,432.17 (@ $3,892.64/ETH)',
                        privateTag: 'Coinrail Hacker - MAJOR THEFT',
                        lastTxn: '0x8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d',
                        lastTxnAge: '2398天前',
                        firstTxn: '0x3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e',
                        firstTxnAge: '2403天前'
                    }
                },
                
                // 钓鱼活动地址
                '0X379CE20C018FB6301C1872C429EC7270FFA4DC5B': {
                    risks: ['钓鱼活动', '身份冒充', '诱导转账'],
                    riskLevel: '高危',
                    riskColor: 'danger',
                    graphStructure: 'chain',
                    riskNodes: ['address-node-0', 'address-node-2', 'address-node-4'],
                    addressInfo: {
                        ethBalance: '0.00225906 Ether',
                        ethValue: '$8.79 (@ $3,892.64/ETH)',
                        privateTag: 'Fake_Phishing - PHISHING SITE',
                        lastTxn: '0x9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e',
                        lastTxnAge: '1654天前',
                        firstTxn: '0x4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f',
                        firstTxnAge: '1662天前'
                    }
                },
                
                // 虚假代币销售
                '0X8F95D25BD5EC1973B8CBCD9572A7287F03420CA7': {
                    risks: ['虚假ICO', '代币诈骗', '投资欺诈'],
                    riskLevel: '高危',
                    riskColor: 'danger',
                    graphStructure: 'tree',
                    riskNodes: ['address-node-0', 'address-node-1', 'address-node-5'],
                    addressInfo: {
                        ethBalance: '0 Ether',
                        ethValue: '$0.00 (@ $3,892.64/ETH)',
                        privateTag: 'Fake: Dfinity Token Sale - SCAM',
                        lastTxn: '0x0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f',
                        lastTxnAge: '2156天前',
                        firstTxn: '0x5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a',
                        firstTxnAge: '2387天前'
                    }
                },
                
                // Uniswap V2 Router (合法地址)
                '0X7A250D5630B4CF539739DF2C5DACB4C659F2488D': {
                    risks: [],
                    riskLevel: '信任',
                    riskColor: 'success',
                    graphStructure: 'uniswap-hub',
                    riskNodes: [],
                    addressInfo: {
                        ethBalance: '0.0000 ETH',
                        ethValue: '$0.00 (@ $3,892.64/ETH)',
                        privateTag: 'Uniswap V2: Router 2 - VERIFIED',
                        lastTxn: '0x8f2a9c4e6b1d3f7a0e5c8b2f4d9a6c3e1f8b5d0a9c6e3f1a4d7b0e5c8f2a9c4e',
                        lastTxnAge: '3分钟前',
                        firstTxn: '0x3c7f1a8e2b5d9c0f6a3e7b1d4f8c2a5e9b6f0c3a7e1d4b8f2c5a9e6b3f0d7c1a',
                        firstTxnAge: '1247天前'
                    }
                },
                
                // USDT合约 (合法地址)
                '0XDAC17F958D2EE523A2206206994597C13D831EC7': {
                    risks: [],
                    riskLevel: '信任',
                    riskColor: 'success',
                    graphStructure: 'usdt-stable',
                    riskNodes: [],
                    addressInfo: {
                        ethBalance: '0.0000 ETH',
                        ethValue: '$0.00 (@ $3,892.64/ETH)',
                        privateTag: 'Tether: USDT Stablecoin - VERIFIED',
                        lastTxn: '0xa4e7b2c9f6d0a3e8b1f4c7a0e9d2b5f8c1a6e3b0f7d4a9c2e5b8f1c4a7e0b3d6',
                        lastTxnAge: '30秒前',
                        firstTxn: '0x9b5d2f8c1a6e3b7f0c4a9d2e5b8f1c6a3e0b7d4f9c2a5e8b1f4c7a0e3b6d9f2c',
                        firstTxnAge: '2234天前'
                    }
                },
                
                // 蜜罐合约
                '0X944A3F5641D6FAF7A6ABDE4EC31E40D0929955ED': {
                    risks: ['蜜罐活动', '合约陷阱', '资金锁定'],
                    riskLevel: '中危',
                    riskColor: 'warning',
                    graphStructure: 'isolated',
                    riskNodes: ['address-node-0', 'address-node-3'],
                    addressInfo: {
                        ethBalance: '0.00026476 Ether',
                        ethValue: '$1.03 (@ $3,892.64/ETH)',
                        privateTag: 'FAKE: DaoCasino - HONEYPOT',
                        lastTxn: '0x3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c',
                        lastTxnAge: '2298天前',
                        firstTxn: '0x8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d',
                        firstTxnAge: '2317天前'
                    }
                },
                
                // 示例钓鱼地址
                '0X85BC81FC84892CF1B391510F8E3784FTC9D1F9297': {
                    risks: ['钓鱼活动', '恶意合约创建活动', '黑名单疑点'],
                    riskLevel: '危险',
                    riskColor: 'danger',
                    graphStructure: 'complex',
                    riskNodes: ['address-node-0', 'address-node-1', 'address-node-2', 'address-node-4', 'address-node-6'],
                    addressInfo: {
                        ethBalance: '2.347 ETH',
                        ethValue: '$9,127.42 (@ $3,892.64/ETH)',
                        privateTag: 'Phishing Address - BLACKLISTED',
                        lastTxn: '0x4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d',
                        lastTxnAge: '12天前',
                        firstTxn: '0x9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e',
                        firstTxnAge: '847天前'
                    }
                },
            
                // 高风险钓鱼地址
                '0X7951C7231C191316EA185751834A5145302ACFFE': {
                    risks: ['钓鱼活动', '恶意合约创建活动', '身份冒充', '诱导转账'],
                    riskLevel: '极度危险',
                    riskColor: 'danger',
                    graphStructure: 'phishing-complex',
                    riskNodes: ['address-node-0', 'address-node-2', 'address-node-4'],
                    addressInfo: {
                        ethBalance: '3.2467 ETH',
                        ethValue: '$12,639.87 (@ $3,892.64/ETH)',
                        privateTag: 'PHISHING ALERT - EXTREME DANGER',
                        lastTxn: '0xa7f9e2b1c8d4f5a6b7c8d9e0f1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0',
                        lastTxnAge: '6小时前',
                        firstTxn: '0x2c8f1a5b9e3d7f0c6a4e8b2f5d1a9c7e0b6f3a8d5c2e9f1b4a7c0e3f6d9b2a5',
                        firstTxnAge: '127天前'
                    }
                },
                
                // Gas盗窃地址
                '0X4838B106FCE9647BDF1E7877BF73CE8B0BAD5F97': {
                    risks: ['窃取攻击活动', 'Gas费用盗窃', '黑名单疑点'],
                    riskLevel: '危险',
                    riskColor: 'danger',
                    graphStructure: 'gas-theft',
                    riskNodes: ['address-node-0', 'address-node-3'],
                    addressInfo: {
                        ethBalance: '0.0847 ETH',
                        ethValue: '$329.71 (@ $3,892.64/ETH)',
                        privateTag: 'Gas Theft Attack - HIGH RISK',
                        lastTxn: '0x5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e',
                        lastTxnAge: '3天前',
                        firstTxn: '0x0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f',
                        firstTxnAge: '234天前'
                    }
            }
            };
            
            // 检查是否为已知地址
            if (knownAddresses[addressUpper]) {
                const data = knownAddresses[addressUpper];
                return {
                    ...data,
                    address: address
                };
            }
            
            // 对于未知地址，使用智能算法生成合理的风险数据
            return generateDynamicRiskData(address);
        }
        
        // 动态生成风险数据的高级算法
        function generateDynamicRiskData(address) {
            // 使用地址的哈希特征生成一致的随机数据
            const addressHash = simpleHash(address);
            const riskSeed = addressHash % 1000;
            
            // 风险类型池
            const riskTypes = [
                '钓鱼活动', '恶意合约创建活动', '黑名单疑点', '窃取攻击活动',
                'Gas费用盗窃', '蜜罐活动', '虚假代币销售', '身份冒充',
                '洗钱活动', '暗网交易', '混币服务', '庞氏骗局'
            ];
            
            // 图结构类型
            const graphTypes = ['normal', 'simple', 'complex', 'hub', 'chain', 'star', 'tree', 'isolated', 'minimal'];
            
            // 风险等级和颜色
            const riskLevels = [
                { level: '安全', color: 'success', threshold: 80 },
                { level: '低危', color: 'info', threshold: 60 },
                { level: '中危', color: 'warning', threshold: 40 },
                { level: '高危', color: 'danger', threshold: 20 },
                { level: '极度危险', color: 'danger', threshold: 0 }
            ];
            
            // 根据风险种子确定风险等级
            const riskLevel = riskLevels.find(level => riskSeed >= level.threshold * 10) || riskLevels[0];
            
            // 生成风险项
            let risks = [];
            let riskNodes = [];
            
            if (riskSeed < 250) { // 25%概率为风险地址
                const riskCount = Math.min((riskSeed % 4) + 1, 3); // 1-3个风险项
                const selectedRisks = [];
                
                for (let i = 0; i < riskCount; i++) {
                    const riskIndex = (addressHash * (i + 1)) % riskTypes.length;
                    const riskType = riskTypes[riskIndex];
                    if (!selectedRisks.includes(riskType)) {
                        selectedRisks.push(riskType);
                    }
                }
                
                risks = selectedRisks;
                
                // 根据风险数量生成风险节点
                const nodeCount = Math.min(risks.length + 1, 6);
                for (let i = 0; i < nodeCount; i++) {
                    riskNodes.push(`address-node-${i}`);
                }
            }
            
            // 生成地址信息
            const balanceVariations = [
                '0 Ether', '0.0012 Ether', '0.0847 Ether', '1.2345 Ether', 
                '15.678 Ether', '0.000034 Ether', '87.321 Ether',
                '234.789 Ether', '0.000156 Ether', '543.012 Ether',
                '2.5678 Ether', '45.987 Ether', '0.00789 Ether', '678.234 Ether'
            ];
            
            const tagVariations = risks.length > 0 ? [
                'High Risk Address - CAUTION',
                'Suspicious Activity Detected',
                'Security Alert - VERIFY BEFORE USE',
                'Potential Threat - MONITOR',
                'Risk Assessment Required',
                'Blacklisted Address - DANGER',
                'Fraudulent Activity Detected'
            ] : [
                'Regular User Wallet',
                'DeFi Protocol Participant',
                'Token Holder',
                'Smart Contract User',
                'Not Available',
                'Verified Contract',
                'Institutional Wallet'
            ];
            
            // 使用更复杂的算法生成余额索引
            const balanceIndex = Math.abs((addressHash * 1049 + 2017) % balanceVariations.length);
            const balance = balanceVariations[balanceIndex];
            const ethValue = parseFloat(balance.split(' ')[0].replace(',', '')) * 3892.64;
            
            // 使用更复杂的算法生成其他索引
            const graphTypeIndex = Math.abs((addressHash * 2311 + 3571) % graphTypes.length);
            const tagIndex = Math.abs((addressHash * 4787 + 6143) % tagVariations.length);
            
            return {
                risks: risks,
                riskLevel: riskLevel.level,
                riskColor: riskLevel.color,
                address: address,
                riskNodes: riskNodes,
                graphStructure: graphTypes[graphTypeIndex],
                addressInfo: {
                    ethBalance: balance,
                    ethValue: `$${ethValue.toFixed(2)} (@ $3,892.64/ETH)`,
                    privateTag: tagVariations[tagIndex],
                    lastTxn: generateRandomTxHash(addressHash * 1231),
                    lastTxnAge: generateRandomTimeAgo(addressHash * 1789, 'recent'),
                    firstTxn: generateRandomTxHash(addressHash * 2647),
                    firstTxnAge: generateRandomTimeAgo(addressHash * 3571, 'old')
                }
            };
        }
        
        // 辅助函数：生成简单哈希
        function simpleHash(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return Math.abs(hash);
        }
        
        // 辅助函数：生成随机交易哈希
        function generateRandomTxHash(seed) {
            const chars = '0123456789abcdef';
            let hash = '0x';
            
            // 增强随机性，避免明显规律
            for (let i = 0; i < 64; i++) {
                // 使用多种随机因子来增加随机性
                const randomFactor = (seed * 7919 + i * 2521 + Math.sin(i) * 10000) % chars.length;
                const charIndex = Math.abs(Math.floor(randomFactor)) % chars.length;
                hash += chars[charIndex];
            }
            return hash;
        }
        
        // 辅助函数：生成随机时间
        function generateRandomTimeAgo(seed, type) {
            const recentTimeUnits = [
                { unit: '分钟前', max: 59, min: 1 },
                { unit: '小时前', max: 23, min: 1 },
                { unit: '天前', max: 30, min: 1 }
            ];
            
            const oldTimeUnits = [
                { unit: '天前', max: 365, min: 31 },
                { unit: '天前', max: 1500, min: 366 },
                { unit: '天前', max: 2500, min: 1501 }
            ];
            
            const timeUnits = type === 'recent' ? recentTimeUnits : oldTimeUnits;
            
            // 使用更复杂的随机算法
            const unitIndex = Math.abs((seed * 3137 + 5231) % timeUnits.length);
            const selectedUnit = timeUnits[unitIndex];
            
            // 在最小值和最大值之间生成随机数
            const range = selectedUnit.max - selectedUnit.min + 1;
            const value = selectedUnit.min + Math.abs((seed * 7841 + 9973) % range);
            
            return `${value}${selectedUnit.unit}`;
        }

        // 获取风险描述
        function getRiskDescription(riskType) {
            const descriptions = {
                '钓鱼活动': '参与钓鱼诈骗，诱导用户泄露私钥或助记词',
                '恶意合约创建活动': '创建或部署恶意智能合约',
                '黑名单疑点': '被多个安全机构列入黑名单',
                '窃取攻击活动': '参与资金窃取或盗币攻击',
                'Gas费用盗窃': '通过恶意合约盗取用户Gas费用',
                '蜜罐活动': '创建蜜罐合约诱骗用户投资',
                '黑客攻击活动': '参与针对交易所或协议的黑客攻击',
                '资金窃取': '直接窃取用户或平台资金',
                '交易所攻击': '针对中心化交易所的攻击活动',
                '浏览器扩展攻击': '通过恶意浏览器扩展窃取用户信息',
                '恶意软件植入': '在用户设备中植入恶意软件',
                '用户数据窃取': '非法获取用户敏感数据',
                '大额资金窃取': '涉及大额资金的盗窃活动',
                '高级持续威胁': '长期、复杂的网络攻击活动',
                '身份冒充': '冒充知名项目或人员进行诈骗',
                '诱导转账': '通过欺骗手段诱导用户转账',
                '虚假ICO': '发起虚假的首次代币发行',
                '代币诈骗': '通过虚假代币进行诈骗',
                '投资欺诈': '以虚假投资机会进行欺诈',
                '合约陷阱': '在智能合约中设置陷阱',
                '资金锁定': '恶意锁定用户资金',
                '洗钱活动': '通过区块链进行资金洗白',
                '暗网交易': '参与暗网的非法交易',
                '混币服务': '提供资金混淆服务以掩盖来源',
                '庞氏骗局': '运营庞氏骗局项目'
            };
            return descriptions[riskType] || '存在潜在安全风险';
        }

        // 获取风险详细信息HTML
        function getRiskDetailHTML(riskType) {
            const riskDetails = {
                '钓鱼活动': {
                    severity: '高',
                    description: '该地址被检测到与钓鱼网站或钓鱼邮件活动相关。这类攻击通常试图欺骗用户透露敏感信息，如私钥或助记词。',
                    recommendations: [
                        '不要向此地址发送任何资金',
                        '不要与此地址关联的任何智能合约交互',
                        '将此地址加入您的个人黑名单'
                    ]
                },
                '黑名单疑点': {
                    severity: '高',
                    description: '该地址出现在一个或多个知名区块链安全组织的黑名单中，可能与欺诈、盗窃或其他恶意活动有关。',
                    recommendations: [
                        '避免与此地址进行任何交易',
                        '如果您已经与此地址交互，请密切监控您的资金',
                        '考虑将您的资金转移到一个新的、安全的钱包地址'
                    ]
                },
                '恶意合约创建活动': {
                    severity: '严重',
                    description: '该地址部署或与已知的恶意智能合约交互。这类合约可能包含后门、漏洞或其他可利用的安全缺陷。',
                    recommendations: [
                        '不要调用此地址部署的任何智能合约函数',
                        '撤销对此地址或其合约的任何授权',
                        '使用多签名钱包或硬件钱包来增强安全性'
                    ]
                },
                '窃取攻击活动': {
                    severity: '严重',
                    description: '该地址与盗窃用户资金的活动相关。可能通过漏洞利用、钓鱼或其他欺诈手段获取用户资产。',
                    recommendations: [
                        '立即撤销对此地址的任何授权',
                        '确保您的钱包安全，考虑更换新钱包',
                        '向相关执法机构或安全组织报告此地址'
                    ]
                },
                'Gas费用盗窃': {
                    severity: '中',
                    description: '该地址被检测到与Gas费用盗窃相关的可疑活动。',
                    recommendations: [
                        '谨慎与此地址交互',
                        '在进行大额交易前进行额外验证',
                        '监控与此地址相关的交易'
                    ]
                },
                '蜜罐活动': {
                    severity: '中',
                    description: '该地址被检测到与蜜罐活动相关的可疑行为。',
                    recommendations: [
                        '谨慎与此地址交互',
                        '在进行大额交易前进行额外验证',
                        '监控与此地址相关的交易'
                    ]
                },
                '黑客攻击活动': {
                    severity: '严重',
                    description: '该地址参与了针对交易所、DeFi协议或其他区块链项目的黑客攻击活动。',
                    recommendations: [
                        '立即停止与此地址的所有交互',
                        '撤销对此地址的任何授权',
                        '向安全机构报告此地址'
                    ]
                },
                '浏览器扩展攻击': {
                    severity: '高',
                    description: '该地址与恶意浏览器扩展攻击相关，可能窃取用户的钱包信息或私钥。',
                    recommendations: [
                        '检查并移除可疑的浏览器扩展',
                        '更换钱包地址和私钥',
                        '使用硬件钱包进行重要交易'
                    ]
                },
                '虚假ICO': {
                    severity: '高',
                    description: '该地址参与了虚假的首次代币发行项目，目的是欺骗投资者。',
                    recommendations: [
                        '避免参与此地址相关的任何代币销售',
                        '如已投资，立即联系相关部门',
                        '验证项目的真实性和团队背景'
                    ]
                },
                '混币服务': {
                    severity: '中',
                    description: '该地址提供混币服务，用于掩盖资金来源，可能涉及洗钱活动。',
                    recommendations: [
                        '避免使用此地址的服务',
                        '了解当地关于混币服务的法律规定',
                        '使用合规的隐私保护工具'
                    ]
                },
                '庞氏骗局': {
                    severity: '高',
                    description: '该地址运营庞氏骗局项目，通过新投资者的资金支付早期投资者回报。',
                    recommendations: [
                        '立即停止投资并尝试提取资金',
                        '警告其他投资者',
                        '向监管机构举报此项目'
                    ]
                },
                '身份冒充': {
                    severity: '高',
                    description: '该地址冒充知名项目、交易所或公众人物进行诈骗活动。',
                    recommendations: [
                        '通过官方渠道验证身份真实性',
                        '不要向此地址转账',
                        '在社交媒体上警告其他用户'
                    ]
                },
                '洗钱活动': {
                    severity: '中',
                    description: '该地址参与洗钱活动，通过区块链转移和清洗非法资金。',
                    recommendations: [
                        '避免与此地址有任何交易',
                        '如误触交易，保留证据并联系执法部门',
                        '监控与此地址相关的交易'
                    ]
                }
            };

            const detail = riskDetails[riskType] || {
                severity: '未知',
                description: '未能找到此风险类型的详细描述。',
                recommendations: ['建议谨慎处理']
            };

            const severityColor = {
                '严重': '#e74c3c',
                '高': '#f39c12',
                '中': '#f1c40f',
                '低': '#2ecc71',
                '未知': '#95a5a6'
            }[detail.severity] || '#95a5a6';

            return `
                <div style="margin-bottom: 0.8rem;">
                    <div class="d-flex align-items-center mb-2">
                        <span style="color: rgba(255, 255, 255, 0.9); font-weight: 600; margin-right: 0.5rem;">风险等级:</span>
                        <span class="badge" style="background: ${severityColor}; color: white; font-size: 0.65rem; padding: 0.2rem 0.5rem;">${detail.severity}</span>
                    </div>
                    <div style="margin-bottom: 0.8rem;">
                        <div style="color: rgba(255, 255, 255, 0.9); font-weight: 600; margin-bottom: 0.3rem;">风险描述:</div>
                        <div style="color: rgba(255, 255, 255, 0.8); line-height: 1.4;">${detail.description}</div>
                    </div>
                    <div>
                        <div style="color: rgba(255, 255, 255, 0.9); font-weight: 600; margin-bottom: 0.3rem;">安全建议:</div>
                        <ul style="margin: 0; padding-left: 1rem; color: rgba(255, 255, 255, 0.8);">
                            ${detail.recommendations.map(rec => `<li style="margin-bottom: 0.2rem;">${rec}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `;
        }

        // 切换风险详情显示
        function toggleRiskDetails(riskId) {
            const detailsDiv = document.getElementById(riskId);
            const expandBtn = document.querySelector(`[onclick="toggleRiskDetails('${riskId}')"] .risk-expand-btn i`);
            
            if (detailsDiv && expandBtn) {
                if (detailsDiv.style.display === 'none') {
                    detailsDiv.style.display = 'block';
                    expandBtn.classList.remove('bi-chevron-down');
                    expandBtn.classList.add('bi-chevron-up');
                    // 添加展开动画
                    detailsDiv.style.maxHeight = '0px';
                    detailsDiv.style.transition = 'max-height 0.3s ease';
                    setTimeout(() => {
                        detailsDiv.style.maxHeight = '500px';
                    }, 10);
                } else {
                    expandBtn.classList.remove('bi-chevron-up');
                    expandBtn.classList.add('bi-chevron-down');
                    detailsDiv.style.maxHeight = '0px';
                    setTimeout(() => {
                        detailsDiv.style.display = 'none';
                    }, 300);
                }
            }
        }

        // 动态生成网络图结构
        function generateDynamicGraph(structure, riskNodes) {
            const svg = document.getElementById('address-graph');
            const edgesGroup = document.getElementById('address-graph-edges');
            const nodesGroup = document.getElementById('address-graph-nodes');
            
            // 首先隐藏所有元素
            svg.querySelectorAll('.address-node, .address-edge').forEach(el => {
                el.style.opacity = '0';
                el.style.display = 'none';
            });
            
            // 根据不同结构显示不同的节点和边 - 确保边和节点一致性
            setTimeout(() => {
                if (structure === 'phishing-complex') {
                    // 钓鱼复杂结构：从核心开始扩散（12个节点）
                    // 第一层：核心连接5个节点
                    showGraphElements(['address-edge-0', 'address-edge-1', 'address-edge-2', 'address-edge-3', 'address-edge-4']);
                    showGraphElements(['address-node-0', 'address-node-1', 'address-node-2', 'address-node-3', 'address-node-4', 'address-node-5']);
                    // 第二层：从第一层节点继续扩散
                    setTimeout(() => {
                        showGraphElements(['address-edge-5', 'address-edge-6', 'address-edge-7', 'address-edge-8', 'address-edge-10', 'address-edge-11']);
                        showGraphElements(['address-node-6', 'address-node-7', 'address-node-8', 'address-node-9', 'address-node-11', 'address-node-12']);
                    }, 200);
                } else if (structure === 'gas-theft') {
                    // Gas盗窃结构：从核心开始有限扩散（9个节点）
                    // 第一层：核心连接3个主要节点
                    showGraphElements(['address-edge-0', 'address-edge-2', 'address-edge-4']);
                    showGraphElements(['address-node-0', 'address-node-1', 'address-node-3', 'address-node-5']);
                    // 第二层：从主要节点扩散
                    setTimeout(() => {
                        showGraphElements(['address-edge-5', 'address-edge-8', 'address-edge-11', 'address-edge-12']);
                        showGraphElements(['address-node-6', 'address-node-9', 'address-node-12', 'address-node-13']);
                    }, 200);
                    // 添加一个间接连接
                    setTimeout(() => {
                        showGraphElements(['address-edge-16']);
                        showGraphElements(['address-node-17']);
                    }, 400);
                } else if (structure === 'uniswap-hub') {
                    // Uniswap中心结构：高频交易模式（10个节点）
                    // 第一层：核心连接4个主要节点
                    showGraphElements(['address-edge-0', 'address-edge-1', 'address-edge-2', 'address-edge-3']);
                    showGraphElements(['address-node-0', 'address-node-1', 'address-node-2', 'address-node-3', 'address-node-4']);
                    // 第二层：从主要节点扩散
                    setTimeout(() => {
                        showGraphElements(['address-edge-5', 'address-edge-7', 'address-edge-8', 'address-edge-10']);
                        showGraphElements(['address-node-6', 'address-node-8', 'address-node-9', 'address-node-11']);
                    }, 200);
                    // 第三层：添加一个远程连接
                    setTimeout(() => {
                        showGraphElements(['address-edge-14']);
                        showGraphElements(['address-node-15']);
                    }, 400);
                } else if (structure === 'usdt-stable') {
                    // USDT稳定币结构：稳定交易模式（8个节点）
                    // 第一层：核心连接3个节点
                    showGraphElements(['address-edge-0', 'address-edge-1', 'address-edge-4']);
                    showGraphElements(['address-node-0', 'address-node-1', 'address-node-2', 'address-node-5']);
                    // 第二层：少量扩散
                    setTimeout(() => {
                        showGraphElements(['address-edge-6', 'address-edge-7', 'address-edge-12']);
                        showGraphElements(['address-node-7', 'address-node-8', 'address-node-13']);
                    }, 200);
                    // 第三层：一个远程连接
                    setTimeout(() => {
                        showGraphElements(['address-edge-13']);
                        showGraphElements(['address-node-14']);
                    }, 400);
                } else if (structure === 'complex') {
                    // 复杂结构：从核心开始全面扩散（15个节点）
                    showGraphElements(['address-edge-0', 'address-edge-1', 'address-edge-2', 'address-edge-3', 'address-edge-4']);
                    showGraphElements(['address-node-0', 'address-node-1', 'address-node-2', 'address-node-3', 'address-node-4', 'address-node-5']);
                    setTimeout(() => {
                        showGraphElements(['address-edge-5', 'address-edge-6', 'address-edge-7', 'address-edge-8', 'address-edge-9', 'address-edge-10', 'address-edge-11', 'address-edge-12']);
                        showGraphElements(['address-node-6', 'address-node-7', 'address-node-8', 'address-node-9', 'address-node-10', 'address-node-11', 'address-node-12', 'address-node-13']);
                    }, 200);
                    setTimeout(() => {
                        showGraphElements(['address-edge-13', 'address-edge-14']);
                        showGraphElements(['address-node-14', 'address-node-15']);
                    }, 400);
                } else if (structure === 'simple') {
                    // 简单结构：从核心开始少量扩散（7个节点）
                    showGraphElements(['address-edge-0', 'address-edge-2']);
                    showGraphElements(['address-node-0', 'address-node-1', 'address-node-3']);
                    setTimeout(() => {
                        showGraphElements(['address-edge-5', 'address-edge-8']);
                        showGraphElements(['address-node-6', 'address-node-9']);
                    }, 200);
                    setTimeout(() => {
                        showGraphElements(['address-edge-16', 'address-edge-14']);
                        showGraphElements(['address-node-17', 'address-node-15']);
                    }, 400);
                } else if (structure === 'hub') {
                    // 中心结构：从核心向外辐射（8个节点）
                    showGraphElements(['address-edge-0', 'address-edge-1', 'address-edge-2', 'address-edge-3']);
                    showGraphElements(['address-node-0', 'address-node-1', 'address-node-2', 'address-node-3', 'address-node-4']);
                    setTimeout(() => {
                        showGraphElements(['address-edge-8', 'address-edge-10']);
                        showGraphElements(['address-node-9', 'address-node-11']);
                    }, 200);
                    setTimeout(() => {
                        showGraphElements(['address-edge-14']);
                        showGraphElements(['address-node-15']);
                    }, 400);
                } else if (structure === 'minimal') {
                    // 最小结构：从核心开始极简扩散（7个节点）
                    showGraphElements(['address-edge-0', 'address-edge-4']);
                    showGraphElements(['address-node-0', 'address-node-1', 'address-node-5']);
                    setTimeout(() => {
                        showGraphElements(['address-edge-5', 'address-edge-12']);
                        showGraphElements(['address-node-6', 'address-node-13']);
                    }, 200);
                    setTimeout(() => {
                        showGraphElements(['address-edge-16', 'address-edge-13']);
                        showGraphElements(['address-node-17', 'address-node-14']);
                    }, 400);
                } else {
                    // 正常结构：从核心开始标准扩散（9个节点）
                    showGraphElements(['address-edge-0', 'address-edge-1', 'address-edge-3']);
                    showGraphElements(['address-node-0', 'address-node-1', 'address-node-2', 'address-node-4']);
                    setTimeout(() => {
                        showGraphElements(['address-edge-5', 'address-edge-7', 'address-edge-10']);
                        showGraphElements(['address-node-6', 'address-node-8', 'address-node-11']);
                    }, 200);
                    setTimeout(() => {
                        showGraphElements(['address-edge-16', 'address-edge-13']);
                        showGraphElements(['address-node-17', 'address-node-14']);
                    }, 400);
                }
                
                // 标记风险节点
                if (riskNodes && riskNodes.length > 0) {
                    setTimeout(() => {
                        riskNodes.forEach(nodeId => {
                            const node = document.getElementById(nodeId);
                            if (node && node.style.display !== 'none') {
                                const circle = node.querySelector('circle');
                                if (circle) {
                                    circle.setAttribute('fill', '#e74c3c');
                                    circle.setAttribute('filter', 'drop-shadow(0 0 8px rgba(231, 76, 60, 0.8))');
                                }
                                node.classList.add('risk-node');
                            }
                        });
                    }, 800);
                }
            }, 100);
        }
        
        // 显示图形元素
        function showGraphElements(elementIds) {
            elementIds.forEach((id, index) => {
                setTimeout(() => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.style.display = 'block';
                        element.style.opacity = '1';
                        element.style.transition = 'opacity 0.3s ease';
                    }
                }, index * 100);
            });
        }
        
        // 图形缩放变量
        let graphScale = 1;
        let graphTranslateX = 0;
        let graphTranslateY = 0;
        let isPanning = false;
        let startX, startY;
        
        // 缩放功能
        function zoomGraph(factor) {
            graphScale *= factor;
            graphScale = Math.max(0.5, Math.min(3, graphScale)); // 限制缩放范围
            updateGraphTransform();
        }
        
        // 重置缩放
        function resetGraphZoom() {
            graphScale = 1;
            graphTranslateX = 0;
            graphTranslateY = 0;
            updateGraphTransform();
        }
        
        // 更新图形变换
        function updateGraphTransform() {
            const svg = document.getElementById('address-graph');
            const edgesGroup = document.getElementById('address-graph-edges');
            const nodesGroup = document.getElementById('address-graph-nodes');
            
            // 计算居中偏移
            const svgRect = svg.getBoundingClientRect();
            const centerX = svgRect.width / 2;
            const centerY = svgRect.height / 2;
            
            // 应用变换，确保缩放以中心为原点
            const transform = `translate(${centerX + graphTranslateX}, ${centerY + graphTranslateY}) scale(${graphScale}) translate(${-centerX}, ${-centerY})`;
            
            if (edgesGroup) edgesGroup.style.transform = transform;
            if (nodesGroup) nodesGroup.style.transform = transform;
        }
        
        // 鼠标拖拽功能
        function startPan(event) {
            isPanning = true;
            startX = event.clientX - graphTranslateX;
            startY = event.clientY - graphTranslateY;
            document.getElementById('address-graph').style.cursor = 'grabbing';
        }
        
        function doPan(event) {
            if (!isPanning) return;
            
            graphTranslateX = event.clientX - startX;
            graphTranslateY = event.clientY - startY;
            updateGraphTransform();
        }
        
        function endPan() {
            isPanning = false;
            document.getElementById('address-graph').style.cursor = 'grab';
        }
        
        // 鼠标滚轮缩放
        function handleWheel(event) {
            event.preventDefault();
            const factor = event.deltaY > 0 ? 0.9 : 1.1;
            zoomGraph(factor);
        }

        // 复制到剪贴板功能
        function copyToClipboard(selector) {
            const element = document.querySelector(selector);
            if (element) {
                const text = element.textContent;
                navigator.clipboard.writeText(text).then(() => {
                    // 可以添加一个提示消息
                    console.log('已复制到剪贴板:', text);
                }).catch(err => {
                    console.error('复制失败:', err);
                });
            }
        }

        // 导航栏增强功能
        (function() {
            // 移动端菜单切换
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const navMenu = document.getElementById('navMenu');
            const navbar = document.getElementById('mainNavbar');

            if (mobileMenuToggle && navMenu) {
                mobileMenuToggle.addEventListener('click', function() {
                    navMenu.classList.toggle('active');
                    const icon = this.querySelector('i');
                    icon.classList.toggle('bi-list');
                    icon.classList.toggle('bi-x');
                });
            }

            // 点击外部关闭移动端菜单
            document.addEventListener('click', function(e) {
                if (navMenu && !e.target.closest('.nav-menu') && !e.target.closest('.mobile-menu-toggle')) {
                    navMenu.classList.remove('active');
                    const icon = mobileMenuToggle?.querySelector('i');
                    if (icon) {
                        icon.classList.add('bi-list');
                        icon.classList.remove('bi-x');
                    }
                }
            });

            // 滚动效果
            let lastScrollTop = 0;
            window.addEventListener('scroll', function() {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                if (navbar) {
                    if (scrollTop > 100) {
                        navbar.classList.add('scrolled');
                    } else {
                        navbar.classList.remove('scrolled');
                    }

                    // 隐藏/显示导航栏（向下滚动隐藏，向上滚动显示）
                    if (scrollTop > lastScrollTop && scrollTop > 200) {
                        navbar.style.transform = 'translateY(-100%)';
                    } else {
                        navbar.style.transform = 'translateY(0)';
                    }
                }
                
                lastScrollTop = scrollTop;
            });

            // 平滑滚动
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
        })();
    </script>

    <!-- 背景动效脚本 -->
    <script>
        function createParticles() {
            const particlesContainer = document.getElementById('particlesBg');
            const particleCount = 50;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.width = Math.random() * 4 + 2 + 'px';
                particle.style.height = particle.style.width;
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 15) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // 区块链数据流
        function createDataStreams() {
            const streamsContainer = document.getElementById('blockchainStreams');
            const streamCount = 20;

            for (let i = 0; i < streamCount; i++) {
                const stream = document.createElement('div');
                stream.className = 'data-stream';
                stream.style.left = Math.random() * 100 + '%';
                stream.style.animationDelay = Math.random() * 8 + 's';
                stream.style.animationDuration = (Math.random() * 4 + 6) + 's';
                streamsContainer.appendChild(stream);
            }
        }

        // 计算系统状态数据
        function calculateSystemStats() {
            // 基准时间：2025年5月20日
            const baseDate = new Date('2025-05-20T00:00:00Z');
            const currentDate = new Date();
            
            // 计算从基准时间到现在的天数
            const daysDiff = Math.floor((currentDate - baseDate) / (1000 * 60 * 60 * 24));
            
            // 如果当前时间早于基准时间，使用默认最小值
            if (daysDiff < 0) {
                return {
                    totalScans: 1250,
                    threatsBlocked: 23,
                    activeMonitors: 8,
                    systemUptime: 99.1,
                    scansTrend: 1.2,
                    threatsTrend: 0.8,
                    uptimeDays: 1
                };
            }
            
            // 基础数据（基准时间的初始值）
            const baseScans = 1250;
            const baseThreats = 23;
            const baseMonitors = 8;
            const baseUptime = 99.1;
            
            // 每日增长计算
            // 总扫描次数：每天增长 120-180 次，周末略少
            const dailyScanIncrease = 150 + Math.sin(daysDiff * 0.1) * 30 + (daysDiff % 7 >= 5 ? -20 : 0);
            const totalScans = Math.floor(baseScans + (dailyScanIncrease * daysDiff) + (daysDiff * daysDiff * 0.5));
            
            // 威胁阻止数：每天增长 3-8 个，与扫描数成正比
            const dailyThreatIncrease = 3 + Math.floor(totalScans / 5000);
            const threatsBlocked = Math.floor(baseThreats + (dailyThreatIncrease * daysDiff * 0.7));
            
            // 活跃监控：8-15个之间波动，偶尔有维护
            const activeMonitors = Math.max(8, Math.min(15, 
                baseMonitors + Math.floor(daysDiff / 30) + Math.floor(Math.sin(daysDiff * 0.2) * 2)
            ));
            
            // 系统运行时间：99.1% 起步，随时间稳步提升，但有偶发波动
            const uptimeVariation = Math.sin(daysDiff * 0.05) * 0.3 + Math.random() * 0.2 - 0.1;
            const systemUptime = Math.min(99.9, 
                Math.max(98.5, baseUptime + (daysDiff * 0.002) + uptimeVariation)
            );
            
            // 计算趋势百分比（模拟近期增长）
            const recentGrowthFactor = 1 + (daysDiff % 30) * 0.001;
            const scansTrend = (2.1 + Math.sin(daysDiff * 0.3) * 1.2) * recentGrowthFactor;
            const threatsTrend = (1.8 + Math.sin(daysDiff * 0.2) * 0.8) * recentGrowthFactor;
            
            return {
                totalScans: totalScans,
                threatsBlocked: threatsBlocked,
                activeMonitors: activeMonitors,
                systemUptime: systemUptime,
                scansTrend: scansTrend,
                threatsTrend: threatsTrend,
                uptimeDays: daysDiff + 1
            };
        }

        // 更新系统状态显示
        function updateSystemStats() {
            const stats = calculateSystemStats();
            
            // 格式化数字显示
            document.getElementById('totalScans').textContent = stats.totalScans.toLocaleString();
            document.getElementById('threatsBlocked').textContent = stats.threatsBlocked.toLocaleString();
            document.getElementById('activeMonitors').textContent = stats.activeMonitors;
            document.getElementById('systemUptime').textContent = stats.systemUptime.toFixed(1) + '%';
            
            // 更新趋势显示
            document.getElementById('scansTrend').textContent = `+${stats.scansTrend.toFixed(1)}%`;
            document.getElementById('threatsTrend').textContent = `+${stats.threatsTrend.toFixed(1)}%`;
            document.getElementById('uptimeDays').textContent = `${stats.uptimeDays}天`;
            
            // 动态更新监控状态
            const monitorStatuses = ['稳定运行', '高效运作', '实时监控', '全面防护'];
            const statusIndex = stats.activeMonitors % monitorStatuses.length;
            document.getElementById('monitorStatus').textContent = monitorStatuses[statusIndex];
        }

        // 初始化背景效果
        document.addEventListener('DOMContentLoaded', function() {
            // 计算并更新系统状态
            updateSystemStats();
            
            createParticles();
            createDataStreams();
            
            // 初始化图形居中
            setTimeout(() => {
                resetGraphZoom();
            }, 1000);
        });
    </script>

    <!-- 主要功能脚本 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 增强粒子背景动画系统
        function initAdvancedParticleSystem() {
            const canvas = document.createElement('canvas');
            canvas.style.position = 'fixed';
            canvas.style.top = '0';
            canvas.style.left = '0';
            canvas.style.width = '100%';
            canvas.style.height = '100%';
            canvas.style.zIndex = '-1';
            canvas.style.pointerEvents = 'none';
            document.body.appendChild(canvas);

            const ctx = canvas.getContext('2d');
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;

            const particles = [];
            const particleCount = 80;
            const connections = [];

            // 粒子类
            class Particle {
                constructor() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.vx = (Math.random() - 0.5) * 1.5;
                    this.vy = (Math.random() - 0.5) * 1.5;
                    this.radius = Math.random() * 3 + 1;
                    this.alpha = Math.random() * 0.6 + 0.3;
                    this.type = Math.random() < 0.7 ? 'normal' : 'blockchain'; // 70%普通粒子，30%区块链节点
                    this.pulse = Math.random() * Math.PI * 2;
                    this.connections = [];
                }

                update() {
                    this.x += this.vx;
                    this.y += this.vy;
                    this.pulse += 0.02;

                    // 边界反弹
                    if (this.x < 0 || this.x > canvas.width) {
                        this.vx *= -1;
                        this.x = Math.max(0, Math.min(canvas.width, this.x));
                    }
                    if (this.y < 0 || this.y > canvas.height) {
                        this.vy *= -1;
                        this.y = Math.max(0, Math.min(canvas.height, this.y));
                    }
                }

                draw() {
                    ctx.save();
                    
                    if (this.type === 'blockchain') {
                        // 区块链节点样式
                        const pulseSize = this.radius + Math.sin(this.pulse) * 1;
                        
                        // 外圈光晕
                        const gradient = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, pulseSize * 3);
                        gradient.addColorStop(0, `rgba(0, 255, 204, ${this.alpha * 0.3})`);
                        gradient.addColorStop(0.5, `rgba(0, 212, 255, ${this.alpha * 0.1})`);
                        gradient.addColorStop(1, 'rgba(0, 255, 204, 0)');
                        
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, pulseSize * 3, 0, Math.PI * 2);
                        ctx.fillStyle = gradient;
                        ctx.fill();
                        
                        // 核心节点
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, pulseSize, 0, Math.PI * 2);
                        ctx.fillStyle = `rgba(0, 255, 204, ${this.alpha})`;
                        ctx.fill();
                        
                        // 内部小点
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, pulseSize * 0.3, 0, Math.PI * 2);
                        ctx.fillStyle = `rgba(255, 255, 255, ${this.alpha * 0.8})`;
                        ctx.fill();
                    } else {
                        // 普通粒子
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                        const colors = [
                            `rgba(0, 255, 204, ${this.alpha})`,
                            `rgba(0, 212, 255, ${this.alpha})`,
                            `rgba(57, 255, 20, ${this.alpha})`
                        ];
                        ctx.fillStyle = colors[Math.floor(Math.random() * colors.length)];
                        ctx.fill();
                    }
                    
                    ctx.restore();
                }
            }

            // 初始化粒子
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle());
            }

            // 绘制连接线
            function drawConnections() {
                for (let i = 0; i < particles.length; i++) {
                    for (let j = i + 1; j < particles.length; j++) {
                        const dx = particles[i].x - particles[j].x;
                        const dy = particles[i].y - particles[j].y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        
                        if (distance < 120) {
                            const opacity = (120 - distance) / 120 * 0.3;
                            
                            ctx.beginPath();
                            ctx.moveTo(particles[i].x, particles[i].y);
                            ctx.lineTo(particles[j].x, particles[j].y);
                            ctx.strokeStyle = `rgba(0, 255, 204, ${opacity})`;
                            ctx.lineWidth = 1;
                            ctx.stroke();
                        }
                    }
                }
            }

            // 添加区块链数据流动效果
            function drawDataFlow() {
                const time = Date.now() * 0.001;
                
                for (let i = 0; i < 5; i++) {
                    const x = (time * 50 + i * 200) % (canvas.width + 100) - 50;
                    const y = 50 + i * (canvas.height / 6);
                    
                    // 数据包
                    ctx.save();
                    ctx.fillStyle = `rgba(0, 255, 204, 0.6)`;
                    ctx.fillRect(x, y, 30, 8);
                    
                    // 数据尾迹
                    const gradient = ctx.createLinearGradient(x - 50, y, x, y);
                    gradient.addColorStop(0, 'rgba(0, 255, 204, 0)');
                    gradient.addColorStop(1, 'rgba(0, 255, 204, 0.3)');
                    ctx.fillStyle = gradient;
                    ctx.fillRect(x - 50, y, 50, 8);
                    ctx.restore();
                }
            }

            // 动画循环
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // 更新和绘制粒子
                particles.forEach(particle => {
                    particle.update();
                    particle.draw();
                });
                
                // 绘制连接线
                drawConnections();
                
                // 绘制数据流
                drawDataFlow();
                
                requestAnimationFrame(animate);
            }
            
            animate();
            
            // 响应窗口大小变化
            window.addEventListener('resize', () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });
        }

        // 鼠标交互效果
        function initMouseInteraction() {
            let mouseX = 0;
            let mouseY = 0;
            
            document.addEventListener('mousemove', (e) => {
                mouseX = e.clientX;
                mouseY = e.clientY;
                
                // 创建鼠标轨迹粒子
                if (Math.random() < 0.1) {
                    createTrailParticle(mouseX, mouseY);
                }
            });
        }

        function createTrailParticle(x, y) {
            const trail = document.createElement('div');
            trail.style.position = 'fixed';
            trail.style.left = x + 'px';
            trail.style.top = y + 'px';
            trail.style.width = '4px';
            trail.style.height = '4px';
            trail.style.backgroundColor = 'rgba(0, 255, 204, 0.6)';
            trail.style.borderRadius = '50%';
            trail.style.pointerEvents = 'none';
            trail.style.zIndex = '1000';
            trail.style.transition = 'all 0.5s ease-out';
            document.body.appendChild(trail);
            
            setTimeout(() => {
                trail.style.opacity = '0';
                trail.style.transform = 'scale(0)';
                setTimeout(() => {
                    if (trail.parentNode) {
                        trail.parentNode.removeChild(trail);
                    }
                }, 500);
            }, 10);
        }
    </script>
</body>
</html>